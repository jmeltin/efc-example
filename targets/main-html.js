/** Cooked with Flambe, https://getflambe.com */
'use strict';(function(){function r(a,b){function c(){}c.prototype=a;var d=new c,e;for(e in b)d[e]=b[e];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function Zf(a){return a instanceof Array?function(){return Ha.iter(a)}:"function"==typeof a.iterator?E(a,a.iterator):a.iterator}function E(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=pg++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,
arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var n=function(){return u.__string_rec(this,"")},Ac=function(a,b){b=b.split("u").join("");this.r=RegExp(a,b)};Ac.__name__=!0;Ac.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},__class__:Ac};var Ha=function(){};Ha.__name__=!0;Ha.cca=function(a,b){var c=a.charCodeAt(b);return c!=c?void 0:c};Ha.substr=function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==
b)c=a.length+c;else return"";return a.substr(b,c)};Ha.remove=function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0};Ha.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var Qd=function(){};Qd.__name__=!0;Qd.array=function(a){for(var b=[],a=Zf(a)();a.hasNext();){var c=a.next();b.push(c)}return b};Qd.count=function(a,b){var c=0;if(null==b)for(var d=Zf(a)();d.hasNext();)d.next(),c++;else for(d=Zf(a)();d.hasNext();){var e=
d.next();b(e)&&c++}return c};Math.__name__=!0;var nc=function(){};nc.__name__=!0;nc.field=function(a,b){try{return a[b]}catch(c){return c instanceof j&&(c=c.val),null}};var $=function(){};$.__name__=!0;$.is=function(a,b){return u.__instanceof(a,b)};$.instance=function(a,b){return a instanceof b?a:null};$.string=function(a){return u.__string_rec(a,"")};var Le=function(){};Le.__name__=!0;Le.startsWith=function(a,b){return a.length>=b.length&&Ha.substr(a,0,b.length)==b};var Pb=function(){};Pb.__name__=
!0;Pb.prototype={__class__:Pb};var H=function(){this._flags=0;this.owner=this.next=null};H.__name__=!0;H.__interfaces__=[Pb];H.prototype={onAdded:function(){},onRemoved:function(){},onStart:function(){},onStop:function(){},onUpdate:function(){},dispose:function(){null!=this.owner&&this.owner.remove(this)},get_name:function(){return null},__class__:H};var Rc=function(){H.call(this);this._bodyContainer=J.root._compMap.BodyContainer_11;this.body=new Bc};Rc.__name__=!0;Rc.__super__=H;Rc.prototype=r(H.prototype,
{get_name:function(){return"Body_8"},onUpdate:function(){this.body.get_isSleeping()||(this._sprite.rotation.set__(180*this.body.zpp_inner.rot/3.141592653589793),this._sprite.x.set__(this.body.get_position().get_x()),this._sprite.y.set__(this.body.get_position().get_y()))},onStart:function(){this._sprite=this.owner._compMap.Sprite_1;this.body.zpp_inner.wrap_shapes.add(new Cc(Cc.rect(0,0,this._sprite.getNaturalWidth(),this._sprite.getNaturalHeight())));this.body.align();this.body.set_position(K.get(this._sprite.x._value,
this._sprite.y._value,!0));this.body.set_rotation(this._sprite.rotation._value);this._bodyContainer.addBody(this.body)},__class__:Rc});var Rd=function(){H.call(this);this._space=new Me(new K(0,1300))};Rd.__name__=!0;Rd.__super__=H;Rd.prototype=r(H.prototype,{get_name:function(){return"BodyContainer_11"},onStart:function(){},onUpdate:function(a){this._space.step(a)},addBody:function(a){a.set_space(this._space)},__class__:Rd});var w=function(){};w.__name__=!0;w.traceTexture=function(a,b){var c=a.readPixels(0,
0,a.get_width(),a.get_height()),c=w.populateArray(c,a.get_width(),a.get_height()),d=w.getStartingPixel(b,c,a.get_width(),a.get_height());return w.marchingSquares(d,c,b,a.get_width(),a.get_height())};w.populateArray=function(a,b,c){var d,e=[];for(d=0;d<b;)d++,e.push(function(){for(var a=[],b=0;b<c;)b++,a.push(0);return a}(this));for(var f=0,h=a.length;f<h;){var m=f++;if(0!=(d=a.b[m])&&0==(m+1)%4)e[Math.floor(Math.floor(m/4)/b)][Math.floor(m/4)%b]=d}return e};w.getStartingPixel=function(a,b,c,d){for(var e=
0;e<c;)for(var f=e++,h=0;h<d;){var m=h++;if(b[f][m]>a)return new K(f,m)}return null};w.getSquareValue=function(a,b,c){var d=0,e;if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();e=a.zpp_inner.x;if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();a=a.zpp_inner.y;0!=e&&0!=a&&c[e-1][a-1]>b&&(d|=1);0!=a&&c[e][a-1]>b&&(d|=2);0!=e&&c[e-1][a]>b&&(d|=4);c[e][a]>b&&(d|=8);return d};w.marchingSquares=
function(a,b,c){var d=[],e;if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();e=a.zpp_inner.x;if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();var f=new K(e,a.zpp_inner.y),h;for(e=!1;!e;){switch(w.getSquareValue(f,c,b)){case 1:h=w.stepUp(f);break;case 2:h=w.stepRight(f);break;case 3:h=w.stepRight(f);break;case 4:h=w.stepLeft(f);break;case 5:h=w.stepUp(f);break;case 6:h=w.handleCase6(h,
f);break;case 7:h=w.stepRight(f);break;case 8:h=w.stepDown(f);break;case 9:h=w.handleCase9(h,f);break;case 10:h=w.stepDown(f);break;case 11:h=w.stepDown(f);break;case 12:h=w.stepLeft(f);break;case 13:h=w.stepUp(f);break;case 14:h=w.stepLeft(f)}d.push(new K(function(){if(null!=f&&f.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");f.zpp_inner.validate();return f.zpp_inner.y}(this),function(){if(null!=f&&f.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");
f.zpp_inner.validate();return f.zpp_inner.x}(this)));var m;if(null!=f&&f.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");f.zpp_inner.validate();m=f.zpp_inner.x;if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();if(m=m==a.zpp_inner.x){if(null!=f&&f.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");f.zpp_inner.validate();m=f.zpp_inner.y;if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();m=m==a.zpp_inner.y}m&&(e=!0)}a.dispose();return d};w.stepLeft=function(a){a.set_x(function(){if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)-1);return ea.LEFT};w.stepUp=function(a){a.set_y(function(){if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)-1);return ea.UP};w.stepRight=function(a){a.set_x(function(){if(null!=
a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)+1);return ea.RIGHT};w.stepDown=function(a){a.set_y(function(){if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)+1);return ea.DOWN};w.handleCase6=function(a,b){return a==ea.UP?w.stepLeft(b):w.stepRight(b)};w.handleCase9=function(a,b){return a==ea.RIGHT?w.stepUp(b):w.stepDown(b)};w.__super__=
H;w.prototype=r(H.prototype,{get_name:function(){return"BodyTracer_13"},__class__:w});var ea={__ename__:!0,__constructs__:["UP","DOWN","LEFT","RIGHT"],UP:["UP",0]};ea.UP.toString=n;ea.UP.__enum__=ea;ea.DOWN=["DOWN",1];ea.DOWN.toString=n;ea.DOWN.__enum__=ea;ea.LEFT=["LEFT",2];ea.LEFT.toString=n;ea.LEFT.__enum__=ea;ea.RIGHT=["RIGHT",3];ea.RIGHT.toString=n;ea.RIGHT.__enum__=ea;var oc=function(){H.call(this);this._bodyContainer=J.root._compMap.BodyContainer_11;var a=Bc;null==i.BodyType_KINEMATIC&&(i.internal=
!0,i.BodyType_KINEMATIC=new ab,i.internal=!1);this.body=new a(i.BodyType_KINEMATIC)};oc.__name__=!0;oc.__super__=H;oc.prototype=r(H.prototype,{get_name:function(){return"MovieBody_7"},onUpdate:function(){var a=this._sprite.getLocalMatrix();Math.atan2(-a.m01,a.m00);this.body.set_position(K.get(a.m02+this._offsetX,a.m12+this._offsetY,!0))},onStart:function(){this._sprite=$.instance(this.owner._compMap.Sprite_1,Dc);var a=(new Qb(w.traceTexture(this._sprite.texture,2))).simplify(4).convexDecomposition();
a.zpp_inner.valmod();for(a=ua.get(a);a.hasNext();){var b;a.zpp_critical=!1;b=a.zpp_inner.at(a.zpp_i++);this.body.zpp_inner.wrap_shapes.add(new Cc(b))}a=this._sprite.getViewMatrix();b=this._sprite.getLocalMatrix();this._offsetX=a.m02-b.m02;this._offsetY=a.m12-b.m12;this._bodyContainer.addBody(this.body)},__class__:oc});var Sd=function(a,b){this._isLeft=this._isRight=this._isUp=this._isDown=this._isSpace=!1;H.call(this);this._min=a;this._max=b;this.init()};Sd.__name__=!0;Sd.__super__=H;Sd.prototype=
r(H.prototype,{get_name:function(){return"Controller_9"},onUpdate:function(){var a;a=this._speed>this._max?0.4*Math.pow(this._max,3)+1.3*Math.pow(this._max,3):0.4*Math.pow(this._speed,3)+1.3*Math.pow(this._speed,3);this._isLeft&&null!=this.fnLeft&&this.fnLeft(a);this._isRight&&null!=this.fnRight&&this.fnRight(a);this._isUp&&null!=this.fnUp&&this.fnUp(a);this._speed+=0.05},onStart:function(){this.owner.addChild(this._container)},init:function(){this._speed=this._min;this._container=(new ob).add(new Td);
this._container._compMap.Disposer_10.connect1(J._platform.getKeyboard().down,E(this,this.onKeyDown));this._container._compMap.Disposer_10.connect1(J._platform.getKeyboard().up,E(this,this.onKeyUp))},onKeyDown:function(a){switch(a.key[1]){case 0:this._isLeft=!0;this._isSpace=this._isDown=this._isRight=!1;break;case 3:this._isLeft=!1;this._isRight=!0;this._isSpace=this._isDown=!1;break;case 22:this._isUp=!0,this._isSpace=this._isDown=!1}},onKeyUp:function(a){switch(a.key[1]){case 0:this._isLeft=!1;
break;case 3:this._isRight=!1;break;case 22:this._isUp=!1}},__class__:Sd});var Td=function(){H.call(this);this._disposables=[]};Td.__name__=!0;Td.__super__=H;Td.prototype=r(H.prototype,{get_name:function(){return"Disposer_10"},add:function(a){this._disposables.push(a);return this},connect1:function(a,b){this.add(a.connect(b));return this},onRemoved:function(){this.freeDisposables()},dispose:function(){H.prototype.dispose.call(this);this.freeDisposables()},freeDisposables:function(){var a=this._disposables;
this._disposables=[];for(var b=0;b<a.length;){var c=a[b];++b;c.dispose()}},__class__:Td});var ob=function(){this.parent=this.firstChild=this.next=this.firstComponent=null;this._compMap={}};ob.__name__=!0;ob.__interfaces__=[Pb];ob.prototype={add:function(a){null!=a.owner&&a.owner.remove(a);var b=a.get_name(),c=this._compMap[b];null!=c&&this.remove(c);this._compMap[b]=a;b=null;for(c=this.firstComponent;null!=c;)b=c,c=c.next;null!=b?b.next=a:this.firstComponent=a;a.owner=this;a.next=null;a.onAdded();
return this},remove:function(a){for(var b=null,c=this.firstComponent;null!=c;){var d=c.next;if(c==a)return null==b?this.firstComponent=d:(b.owner=this,b.next=d),delete this._compMap[c.get_name()],0!=(c._flags&1)&&(c.onStop(),c._flags&=-2),c.onRemoved(),c.owner=null,c.next=null,!0;b=c;c=d}return!1},getComponent:function(a){return this._compMap[a]},addChild:function(a,b){null==b&&(b=!0);null!=a.parent&&a.parent.removeChild(a);a.parent=this;if(b){for(var c=null,d=this.firstChild;null!=d;)c=d,d=d.next;
null!=c?c.next=a:this.firstChild=a}else a.next=this.firstChild,this.firstChild=a;return this},removeChild:function(a){for(var b=null,c=this.firstChild;null!=c;){var d=c.next;if(c==a){null==b?this.firstChild=d:b.next=d;c.parent=null;c.next=null;break}b=c;c=d}},disposeChildren:function(){for(;null!=this.firstChild;)this.firstChild.dispose()},dispose:function(){for(null!=this.parent&&this.parent.removeChild(this);null!=this.firstComponent;)this.firstComponent.dispose();this.disposeChildren()},__class__:ob};
var $f=function(){};$f.__name__=!0;var Ne=function(){};Ne.__name__=!0;Ne.prototype={__class__:Ne};var Ec=function(){};Ec.__name__=!0;Ec.__interfaces__=[Ne];Ec.prototype={init:function(){var a=this;C.fixAndroidMath();var b=null;try{b=window.flambe.canvas}catch(c){c instanceof j&&(c=c.val)}b.setAttribute("tabindex","0");b.style.outlineStyle="none";b.style.webkitTapHighlightColor="transparent";b.setAttribute("moz-opaque","true");this._stage=new ed(b);this._pointer=new Sa;this._mouse=new fd(this._pointer,
b);this._renderer=this.createRenderer(b);this.mainLoop=new gd;this.musicPlaying=!1;this._canvas=b;this._container=b.parentElement;this._container.style.overflow="hidden";this._container.style.position="relative";this._container.style.msTouchAction="none";var d=0,e=function(c){if(!(1E3>c.timeStamp-d)){var e=b.getBoundingClientRect(),f=a.getX(c,e),e=a.getY(c,e);switch(c.type){case "mousedown":c.target==b&&(c.preventDefault(),a._mouse.submitDown(f,e,c.button),b.focus());break;case "mousemove":a._mouse.submitMove(f,
e);break;case "mouseup":a._mouse.submitUp(f,e,c.button);break;case "mousewheel":case "DOMMouseScroll":a._mouse.submitScroll(f,e,"mousewheel"==c.type?c.wheelDelta/40:-c.detail)&&c.preventDefault()}}};window.addEventListener("mousedown",e,!1);window.addEventListener("mousemove",e,!1);window.addEventListener("mouseup",e,!1);b.addEventListener("mousewheel",e,!1);b.addEventListener("DOMMouseScroll",e,!1);b.addEventListener("contextmenu",function(a){a.preventDefault()},!1);var f="undefined"!=typeof window.ontouchstart,
e="msMaxTouchPoints"in window.navigator&&1<window.navigator.msMaxTouchPoints;if(f||e){var h=new hd(this._pointer,f?4:window.navigator.msMaxTouchPoints);this._touch=h;e=function(b){var c;c=f?b.changedTouches:[b];var e=b.target.getBoundingClientRect();d=b.timeStamp;switch(b.type){case "touchstart":case "MSPointerDown":case "pointerdown":b.preventDefault();C.SHOULD_HIDE_MOBILE_BROWSER&&C.hideMobileBrowser();for(b=0;b<c.length;){var m=c[b];++b;var l=a.getX(m,e),i=a.getY(m,e);h.submitDown((f?m.identifier:
m.pointerId)|0,l,i)}break;case "touchmove":case "MSPointerMove":case "pointermove":b.preventDefault();for(b=0;b<c.length;)m=c[b],++b,l=a.getX(m,e),i=a.getY(m,e),h.submitMove((f?m.identifier:m.pointerId)|0,l,i);break;case "touchend":case "touchcancel":case "MSPointerUp":case "pointerup":for(b=0;b<c.length;)m=c[b],++b,l=a.getX(m,e),i=a.getY(m,e),h.submitUp((f?m.identifier:m.pointerId)|0,l,i)}};f?(b.addEventListener("touchstart",e,!1),b.addEventListener("touchmove",e,!1),b.addEventListener("touchend",
e,!1),b.addEventListener("touchcancel",e,!1)):(b.addEventListener("MSPointerDown",e,!1),b.addEventListener("MSPointerMove",e,!1),b.addEventListener("MSPointerUp",e,!1))}else this._touch=new Ud;var m=window.onerror;window.onerror=function(a,b,c){J.uncaughtError.emit(a);return null!=m?m(a,b,c):!1};var l=C.loadExtension("hidden",window.document);null!=l.value?(e=function(){J.hidden.set__(nc.field(window.document,l.field))},e(null),window.document.addEventListener(l.prefix+"visibilitychange",e,!1)):(e=
function(a){J.hidden.set__("pagehide"==a.type)},window.addEventListener("pageshow",e,!1),window.addEventListener("pagehide",e,!1));J.hidden.get_changed().connect(function(b){b||(a._skipFrame=!0)});this._skipFrame=!1;this._lastUpdate=Date.now();var i=C.loadExtension("requestAnimationFrame").value;if(null!=i){var g=window.performance,k=null!=g&&C.polyfill("now",g);k?this._lastUpdate=g.now():null;var q=null,q=function(c){a.update(k?g.now():c);i(q,b)};i(q,b)}else window.setInterval(function(){a.update(Date.now())},
16);id.info("Initialized HTML platform",["renderer",this._renderer.get_type()])},loadAssetPack:function(a){return(new I(this,a)).promise},getStage:function(){return this._stage},update:function(a){var b=(a-this._lastUpdate)/1E3;this._lastUpdate=a;J.hidden._value||(this._skipFrame?this._skipFrame=!1:(this.mainLoop.update(b),this.mainLoop.render(this._renderer)))},getPointer:function(){return this._pointer},getKeyboard:function(){var a=this;if(null==this._keyboard){this._keyboard=new bb;var b=function(b){switch(b.type){case "keydown":a._keyboard.submitDown(b.keyCode)&&
b.preventDefault();break;case "keyup":a._keyboard.submitUp(b.keyCode)}};this._canvas.addEventListener("keydown",b,!1);this._canvas.addEventListener("keyup",b,!1)}return this._keyboard},getRenderer:function(){return this._renderer},getX:function(a,b){return(a.clientX-b.left)*this._stage.get_width()/b.width},getY:function(a,b){return(a.clientY-b.top)*this._stage.get_height()/b.height},createRenderer:function(a){try{var b=ag.getContextWebGL(a,{alpha:!1,depth:!1,failIfMajorPerformanceCaveat:!0});if(null!=
b)if(C.detectSlowDriver(b))null;else return new Vd(this._stage,b)}catch(c){c instanceof j&&(c=c.val)}return new Sc(a)},__class__:Ec};var Ia=function(a,b){this._value=a;this._changed=null!=b?new jd(b):null};Ia.__name__=!0;Ia.prototype={watch:function(a){a(this._value,this._value);return this.get_changed().connect(a)},set__:function(a){var b=this._value;a!=b&&(this._value=a,null!=this._changed&&this._changed.emit(a,b));return a},get_changed:function(){null==this._changed&&(this._changed=new jd);return this._changed},
__class__:Ia};var Tc=function(a,b){this._next=null;this._signal=a;this._listener=b;this.stayInList=!0};Tc.__name__=!0;Tc.__interfaces__=[Pb];Tc.prototype={once:function(){this.stayInList=!1;return this},dispose:function(){null!=this._signal&&(this._signal.disconnect(this),this._signal=null)},__class__:Tc};var U=function(a){this._head=null!=a?new Tc(this,a):null;this._deferredTasks=null};U.__name__=!0;U.prototype={connectImpl:function(a,b){var c=this,d=new Tc(this,a);this._head==U.DISPATCHING_SENTINEL?
this.defer(function(){c.listAdd(d,b)}):this.listAdd(d,b);return d},disconnect:function(a){var b=this;this._head==U.DISPATCHING_SENTINEL?this.defer(function(){b.listRemove(a)}):this.listRemove(a)},defer:function(a){for(var b=null,c=this._deferredTasks;null!=c;)b=c,c=c.next;a=new Oe(a);null!=b?b.next=a:this._deferredTasks=a},willEmit:function(){var a=this._head;this._head=U.DISPATCHING_SENTINEL;return a},didEmit:function(a){this._head=a;a=this._deferredTasks;for(this._deferredTasks=null;null!=a;)a.fn(),
a=a.next},listAdd:function(a,b){if(b)a._next=this._head,this._head=a;else{for(var c=null,d=this._head;null!=d;)c=d,d=d._next;null!=c?c._next=a:this._head=a}},listRemove:function(a){for(var b=null,c=this._head;null!=c;){if(c==a){a=c._next;null==b?this._head=a:b._next=a;break}b=c;c=c._next}},__class__:U};var jd=function(a){U.call(this,a)};jd.__name__=!0;jd.__super__=U;jd.prototype=r(U.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(a,b){var c=this;this._head==
U.DISPATCHING_SENTINEL?this.defer(function(){c.emitImpl(a,b)}):this.emitImpl(a,b)},emitImpl:function(a,b){for(var c=this.willEmit(),d=c;null!=d;)d._listener(a,b),d.stayInList||d.dispose(),d=d._next;this.didEmit(c)},__class__:jd});var Q=function(a){U.call(this,a)};Q.__name__=!0;Q.__super__=U;Q.prototype=r(U.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(a){var b=this;this._head==U.DISPATCHING_SENTINEL?this.defer(function(){b.emitImpl(a)}):this.emitImpl(a)},
emitImpl:function(a){for(var b=this.willEmit(),c=b;null!=c;)c._listener(a),c.stayInList||c.dispose(),c=c._next;this.didEmit(b)},__class__:Q});var ia=function(a,b){this._behavior=null;Ia.call(this,a,b)};ia.__name__=!0;ia.__super__=Ia;ia.prototype=r(Ia.prototype,{set__:function(a){this._behavior=null;return Ia.prototype.set__.call(this,a)},update:function(a){null!=this._behavior&&(Ia.prototype.set__.call(this,this._behavior.update(a)),this._behavior.isComplete()&&(this._behavior=null))},__class__:ia});
var J=function(){};J.__name__=!0;J.init=function(){J._calledInit||(J._platform.init(),J._calledInit=!0)};var id=function(){};id.__name__=!0;id.info=function(){null};id.__super__=$f;id.prototype=r($f.prototype,{__class__:id});var Pe=function(){this._realDt=0};Pe.__name__=!0;Pe.__super__=H;Pe.prototype=r(H.prototype,{get_name:function(){return"SpeedAdjuster_3"},onUpdate:function(a){0<this._realDt&&(a=this._realDt,this._realDt=0);this.scale.update(a)},__class__:Pe});var Uc=function(){};Uc.__name__=!0;
Uc.__interfaces__=[Pb];Uc.prototype={__class__:Uc};var o={__ename__:!0,__constructs__:"WEBP,JXR,PNG,JPG,GIF,DDS,PVR,PKM,MP3,M4A,OPUS,OGG,WAV,Data".split(","),WEBP:["WEBP",0]};o.WEBP.toString=n;o.WEBP.__enum__=o;o.JXR=["JXR",1];o.JXR.toString=n;o.JXR.__enum__=o;o.PNG=["PNG",2];o.PNG.toString=n;o.PNG.__enum__=o;o.JPG=["JPG",3];o.JPG.toString=n;o.JPG.__enum__=o;o.GIF=["GIF",4];o.GIF.toString=n;o.GIF.__enum__=o;o.DDS=["DDS",5];o.DDS.toString=n;o.DDS.__enum__=o;o.PVR=["PVR",6];o.PVR.toString=n;o.PVR.__enum__=
o;o.PKM=["PKM",7];o.PKM.toString=n;o.PKM.__enum__=o;o.MP3=["MP3",8];o.MP3.toString=n;o.MP3.__enum__=o;o.M4A=["M4A",9];o.M4A.toString=n;o.M4A.__enum__=o;o.OPUS=["OPUS",10];o.OPUS.toString=n;o.OPUS.__enum__=o;o.OGG=["OGG",11];o.OGG.toString=n;o.OGG.__enum__=o;o.WAV=["WAV",12];o.WAV.toString=n;o.WAV.__enum__=o;o.Data=["Data",13];o.Data.toString=n;o.Data.__enum__=o;var Qe=function(a,b,c,d){this.name=a;this.url=b;this.format=c;this.bytes=d};Qe.__name__=!0;Qe.prototype={__class__:Qe};var Wd=function(){};
Wd.__name__=!0;Wd.__interfaces__=[Pb];Wd.prototype={__class__:Wd};var me=function(){};me.__name__=!0;me.__interfaces__=[Uc];me.prototype={__class__:me};var Da=function(){this._localBase=this._remoteBase=null;this._entries=[]};Da.__name__=!0;Da.fromAssets=function(a,b){null==b&&(b=!0);var c=nc.field(Cd.getType(Da).assets[0],a);if(null==c){if(b)throw new j(na.withFields("Missing asset pack",["name",a]));return null}var d=new Da;d.set_localBase("assets");for(var e=0;e<c.length;){var f=c[e];++e;var h=
f.name,m=a+"/"+h+"?v="+$.string(f.md5),l=Da.inferFormat(h);l!=o.Data&&(h=na.removeFileExtension(h));d.add(h,m,f.bytes,l)}return d};Da.inferFormat=function(a){a=na.getUrlExtension(a);if(null!=a)switch(a.toLowerCase()){case "gif":return o.GIF;case "jpg":case "jpeg":return o.JPG;case "jxr":case "wdp":return o.JXR;case "png":return o.PNG;case "webp":return o.WEBP;case "dds":return o.DDS;case "pvr":return o.PVR;case "pkm":return o.PKM;case "m4a":return o.M4A;case "mp3":return o.MP3;case "ogg":return o.OGG;
case "opus":return o.OPUS;case "wav":return o.WAV}else null;return o.Data};Da.prototype={add:function(a,b,c,d){null==c&&(c=0);null==d&&(d=Da.inferFormat(b));a=new Qe(a,b,d,c);this._entries.push(a);return a},iterator:function(){return Ha.iter(this._entries)},getFullURL:function(a){var b;b=null!=this.get_remoteBase()&&Da._supportsCrossOrigin?this.get_remoteBase():this.get_localBase();return null!=b?na.joinPath(b,a.url):a.url},get_localBase:function(){return this._localBase},set_localBase:function(a){null!=
a&&bg.that(!Le.startsWith(a,"http://")&&!Le.startsWith(a,"https://"),"localBase must be a path on the same domain, NOT starting with http(s)://",null);return this._localBase=a},get_remoteBase:function(){return this._remoteBase},__class__:Da};var ca={__ename__:!0,__constructs__:"Normal,Add,Multiply,Screen,Mask,Copy".split(","),Normal:["Normal",0]};ca.Normal.toString=n;ca.Normal.__enum__=ca;ca.Add=["Add",1];ca.Add.toString=n;ca.Add.__enum__=ca;ca.Multiply=["Multiply",2];ca.Multiply.toString=n;ca.Multiply.__enum__=
ca;ca.Screen=["Screen",3];ca.Screen.toString=n;ca.Screen.__enum__=ca;ca.Mask=["Mask",4];ca.Mask.toString=n;ca.Mask.__enum__=ca;ca.Copy=["Copy",5];ca.Copy.toString=n;ca.Copy.__enum__=ca;var Re=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};Re.__name__=!0;Re.prototype={__class__:Re};var B=function(){this._viewMatrixUpdateCount=this._parentViewMatrixUpdateCount=this._sinCache=this._cosCache=0;this.blendMode=this.scissor=this._viewMatrix=null;var a=this;H.call(this);this._flags|=182;this._localMatrix=
new va;var b=function(){a._flags|=24};this.x=new ia(0,b);this.y=new ia(0,b);this.rotation=new ia(0,function(){a._flags|=152});this.scaleX=new ia(1,b);this.scaleY=new ia(1,b);this.anchorX=new ia(0,b);this.anchorY=new ia(0,b);this.alpha=new ia(1)};B.__name__=!0;B.hitTest=function(a,b,c){var d=a._compMap.Sprite_1;if(null!=d){if(6!=(d._flags&6))return null;d.getLocalMatrix().inverseTransform(b,c,B._scratchPoint)&&(b=B._scratchPoint.x,c=B._scratchPoint.y);var e=d.scissor;if(null!=e&&!e.contains(b,c))return null}a=
B.hitTestBackwards(a.firstChild,b,c);return null!=a?a:null!=d&&d.containsLocal(b,c)?d:null};B.render=function(a,b){var c=a._compMap.Sprite_1;if(null!=c){var d=c.alpha._value;if(0==(c._flags&2)||0>=d)return;b.save();1>d&&b.multiplyAlpha(d);null!=c.blendMode&&b.setBlendMode(c.blendMode);var d=c.getLocalMatrix(),e=d.m02,f=d.m12;0!=(c._flags&32)&&(e=Math.round(e),f=Math.round(f));b.transform(d.m00,d.m10,d.m01,d.m11,e,f);d=c.scissor;null!=d&&b.applyScissor(d.x,d.y,d.width,d.height);c.draw(b)}d=a._compMap.Director_2;
if(null!=d){d=d.occludedScenes;for(e=0;e<d.length;)f=d[e],++e,B.render(f,b)}for(d=a.firstChild;null!=d;)e=d.next,B.render(d,b),d=e;null!=c&&b.restore()};B.hitTestBackwards=function(a,b,c){if(null!=a){var d=B.hitTestBackwards(a.next,b,c);return null!=d?d:B.hitTest(a,b,c)}return null};B.__super__=H;B.prototype=r(H.prototype,{get_name:function(){return"Sprite_1"},getNaturalWidth:function(){return 0},getNaturalHeight:function(){return 0},containsLocal:function(a,b){return 0<=a&&a<this.getNaturalWidth()&&
0<=b&&b<this.getNaturalHeight()},getLocalMatrix:function(){if(0!=(this._flags&8)){this._flags&=-9;if(0!=(this._flags&128)){this._flags&=-129;var a=3.141592653589793*this.rotation._value/180;this._sinCache=Math.sin(a);this._cosCache=Math.cos(a)}var a=this.scaleX._value,b=this.scaleY._value;this._localMatrix.set(this._cosCache*a,this._sinCache*a,-this._sinCache*b,this._cosCache*b,this.x._value,this.y._value);this._localMatrix.translate(-this.anchorX._value,-this.anchorY._value)}return this._localMatrix},
getViewMatrix:function(){if(this.isViewMatrixDirty()){var a=this.getParentSprite();this._viewMatrix=null!=a?va.multiply(a.getViewMatrix(),this.getLocalMatrix(),this._viewMatrix):this.getLocalMatrix().clone(this._viewMatrix);this._flags&=-17;null!=a&&(this._parentViewMatrixUpdateCount=a._viewMatrixUpdateCount);++this._viewMatrixUpdateCount}return this._viewMatrix},setAnchor:function(a,b){this.anchorX.set__(a);this.anchorY.set__(b);return this},centerAnchor:function(){this.anchorX.set__(this.getNaturalWidth()/
2);this.anchorY.set__(this.getNaturalHeight()/2);return this},setXY:function(a,b){this.x.set__(a);this.y.set__(b);return this},disablePixelSnapping:function(){this.set_pixelSnapping(!1);return this},onAdded:function(){0!=(this._flags&64)&&this.connectHover()},onRemoved:function(){null!=this._hoverConnection&&(this._hoverConnection.dispose(),this._hoverConnection=null)},onUpdate:function(a){this.x.update(a);this.y.update(a);this.rotation.update(a);this.scaleX.update(a);this.scaleY.update(a);this.alpha.update(a);
this.anchorX.update(a);this.anchorY.update(a)},draw:function(){},isViewMatrixDirty:function(){if(0!=(this._flags&16))return!0;var a=this.getParentSprite();return null==a?!1:this._parentViewMatrixUpdateCount!=a._viewMatrixUpdateCount||a.isViewMatrixDirty()},getParentSprite:function(){if(null==this.owner)return null;for(var a=this.owner.parent;null!=a;){var b=a._compMap.Sprite_1;if(null!=b)return b;a=a.parent}return null},connectHover:function(){var a=this;null==this._hoverConnection&&(this._hoverConnection=
J._platform.getPointer().move.connect(function(b){for(var c=b.hit;null!=c;){if(c==a)return;c=c.getParentSprite()}null!=a._pointerOut&&0!=(a._flags&64)&&a._pointerOut.emit(b);a._flags&=-65;null!=a._hoverConnection&&(a._hoverConnection.dispose(),a._hoverConnection=null)}))},set_visible:function(a){this._flags=Se.set(this._flags,2,a);return a},set_pixelSnapping:function(a){this._flags=Se.set(this._flags,32,a);return a},onPointerDown:function(a){this.onHover(a);null!=this._pointerDown&&this._pointerDown.emit(a)},
onPointerMove:function(a){this.onHover(a);null!=this._pointerMove&&this._pointerMove.emit(a)},onHover:function(a){if(0==(this._flags&64)&&(this._flags|=64,null!=this._pointerIn||null!=this._pointerOut))null!=this._pointerIn&&this._pointerIn.emit(a),this.connectHover()},onPointerUp:function(a){switch(a.source[1]){case 1:null!=this._pointerOut&&0!=(this._flags&64)&&this._pointerOut.emit(a),this._flags&=-65,null!=this._hoverConnection&&(this._hoverConnection.dispose(),this._hoverConnection=null)}null!=
this._pointerUp&&this._pointerUp.emit(a)},__class__:B});var Xd=function(a,b,c){B.call(this);this.color=a;this.width=new ia(b);this.height=new ia(c)};Xd.__name__=!0;Xd.__super__=B;Xd.prototype=r(B.prototype,{draw:function(a){a.fillRect(this.color,0,0,this.width._value,this.height._value)},getNaturalWidth:function(){return this.width._value},getNaturalHeight:function(){return this.height._value},onUpdate:function(a){B.prototype.onUpdate.call(this,a);this.width.update(a);this.height.update(a)},__class__:Xd});
var Te=function(){};Te.__name__=!0;Te.prototype={__class__:Te};var Dc=function(a){B.call(this);this.texture=a};Dc.__name__=!0;Dc.__super__=B;Dc.prototype=r(B.prototype,{draw:function(a){null!=this.texture&&a.drawTexture(this.texture,0,0)},getNaturalWidth:function(){return null!=this.texture?this.texture.get_width():0},getNaturalHeight:function(){return null!=this.texture?this.texture.get_height():0},__class__:Dc});var Fc={__ename__:!0,__constructs__:["Portrait","Landscape"],Portrait:["Portrait",0]};
Fc.Portrait.toString=n;Fc.Portrait.__enum__=Fc;Fc.Landscape=["Landscape",1];Fc.Landscape.toString=n;Fc.Landscape.__enum__=Fc;var Yd=function(){};Yd.__name__=!0;Yd.__interfaces__=[Uc];Yd.prototype={__class__:Yd};var cg=function(){};cg.__name__=!0;cg.__interfaces__=[Yd];var g={__ename__:!0,__constructs__:"A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,Number0,Number1,Number2,Number3,Number4,Number5,Number6,Number7,Number8,Number9,Numpad0,Numpad1,Numpad2,Numpad3,Numpad4,Numpad5,Numpad6,Numpad7,Numpad8,Numpad9,NumpadAdd,NumpadDecimal,NumpadDivide,NumpadEnter,NumpadMultiply,NumpadSubtract,F1,F2,F3,F4,F5,F6,F7,F8,F9,F10,F11,F12,F13,F14,F15,Left,Up,Right,Down,Alt,Backquote,Backslash,Backspace,CapsLock,Comma,Command,Control,Delete,End,Enter,Equals,Escape,Home,Insert,LeftBracket,Minus,PageDown,PageUp,Period,Quote,RightBracket,Semicolon,Shift,Slash,Space,Tab,Menu,Search,Unknown".split(","),
A:["A",0]};g.A.toString=n;g.A.__enum__=g;g.B=["B",1];g.B.toString=n;g.B.__enum__=g;g.C=["C",2];g.C.toString=n;g.C.__enum__=g;g.D=["D",3];g.D.toString=n;g.D.__enum__=g;g.E=["E",4];g.E.toString=n;g.E.__enum__=g;g.F=["F",5];g.F.toString=n;g.F.__enum__=g;g.G=["G",6];g.G.toString=n;g.G.__enum__=g;g.H=["H",7];g.H.toString=n;g.H.__enum__=g;g.I=["I",8];g.I.toString=n;g.I.__enum__=g;g.J=["J",9];g.J.toString=n;g.J.__enum__=g;g.K=["K",10];g.K.toString=n;g.K.__enum__=g;g.L=["L",11];g.L.toString=n;g.L.__enum__=
g;g.M=["M",12];g.M.toString=n;g.M.__enum__=g;g.N=["N",13];g.N.toString=n;g.N.__enum__=g;g.O=["O",14];g.O.toString=n;g.O.__enum__=g;g.P=["P",15];g.P.toString=n;g.P.__enum__=g;g.Q=["Q",16];g.Q.toString=n;g.Q.__enum__=g;g.R=["R",17];g.R.toString=n;g.R.__enum__=g;g.S=["S",18];g.S.toString=n;g.S.__enum__=g;g.T=["T",19];g.T.toString=n;g.T.__enum__=g;g.U=["U",20];g.U.toString=n;g.U.__enum__=g;g.V=["V",21];g.V.toString=n;g.V.__enum__=g;g.W=["W",22];g.W.toString=n;g.W.__enum__=g;g.X=["X",23];g.X.toString=
n;g.X.__enum__=g;g.Y=["Y",24];g.Y.toString=n;g.Y.__enum__=g;g.Z=["Z",25];g.Z.toString=n;g.Z.__enum__=g;g.Number0=["Number0",26];g.Number0.toString=n;g.Number0.__enum__=g;g.Number1=["Number1",27];g.Number1.toString=n;g.Number1.__enum__=g;g.Number2=["Number2",28];g.Number2.toString=n;g.Number2.__enum__=g;g.Number3=["Number3",29];g.Number3.toString=n;g.Number3.__enum__=g;g.Number4=["Number4",30];g.Number4.toString=n;g.Number4.__enum__=g;g.Number5=["Number5",31];g.Number5.toString=n;g.Number5.__enum__=
g;g.Number6=["Number6",32];g.Number6.toString=n;g.Number6.__enum__=g;g.Number7=["Number7",33];g.Number7.toString=n;g.Number7.__enum__=g;g.Number8=["Number8",34];g.Number8.toString=n;g.Number8.__enum__=g;g.Number9=["Number9",35];g.Number9.toString=n;g.Number9.__enum__=g;g.Numpad0=["Numpad0",36];g.Numpad0.toString=n;g.Numpad0.__enum__=g;g.Numpad1=["Numpad1",37];g.Numpad1.toString=n;g.Numpad1.__enum__=g;g.Numpad2=["Numpad2",38];g.Numpad2.toString=n;g.Numpad2.__enum__=g;g.Numpad3=["Numpad3",39];g.Numpad3.toString=
n;g.Numpad3.__enum__=g;g.Numpad4=["Numpad4",40];g.Numpad4.toString=n;g.Numpad4.__enum__=g;g.Numpad5=["Numpad5",41];g.Numpad5.toString=n;g.Numpad5.__enum__=g;g.Numpad6=["Numpad6",42];g.Numpad6.toString=n;g.Numpad6.__enum__=g;g.Numpad7=["Numpad7",43];g.Numpad7.toString=n;g.Numpad7.__enum__=g;g.Numpad8=["Numpad8",44];g.Numpad8.toString=n;g.Numpad8.__enum__=g;g.Numpad9=["Numpad9",45];g.Numpad9.toString=n;g.Numpad9.__enum__=g;g.NumpadAdd=["NumpadAdd",46];g.NumpadAdd.toString=n;g.NumpadAdd.__enum__=g;g.NumpadDecimal=
["NumpadDecimal",47];g.NumpadDecimal.toString=n;g.NumpadDecimal.__enum__=g;g.NumpadDivide=["NumpadDivide",48];g.NumpadDivide.toString=n;g.NumpadDivide.__enum__=g;g.NumpadEnter=["NumpadEnter",49];g.NumpadEnter.toString=n;g.NumpadEnter.__enum__=g;g.NumpadMultiply=["NumpadMultiply",50];g.NumpadMultiply.toString=n;g.NumpadMultiply.__enum__=g;g.NumpadSubtract=["NumpadSubtract",51];g.NumpadSubtract.toString=n;g.NumpadSubtract.__enum__=g;g.F1=["F1",52];g.F1.toString=n;g.F1.__enum__=g;g.F2=["F2",53];g.F2.toString=
n;g.F2.__enum__=g;g.F3=["F3",54];g.F3.toString=n;g.F3.__enum__=g;g.F4=["F4",55];g.F4.toString=n;g.F4.__enum__=g;g.F5=["F5",56];g.F5.toString=n;g.F5.__enum__=g;g.F6=["F6",57];g.F6.toString=n;g.F6.__enum__=g;g.F7=["F7",58];g.F7.toString=n;g.F7.__enum__=g;g.F8=["F8",59];g.F8.toString=n;g.F8.__enum__=g;g.F9=["F9",60];g.F9.toString=n;g.F9.__enum__=g;g.F10=["F10",61];g.F10.toString=n;g.F10.__enum__=g;g.F11=["F11",62];g.F11.toString=n;g.F11.__enum__=g;g.F12=["F12",63];g.F12.toString=n;g.F12.__enum__=g;g.F13=
["F13",64];g.F13.toString=n;g.F13.__enum__=g;g.F14=["F14",65];g.F14.toString=n;g.F14.__enum__=g;g.F15=["F15",66];g.F15.toString=n;g.F15.__enum__=g;g.Left=["Left",67];g.Left.toString=n;g.Left.__enum__=g;g.Up=["Up",68];g.Up.toString=n;g.Up.__enum__=g;g.Right=["Right",69];g.Right.toString=n;g.Right.__enum__=g;g.Down=["Down",70];g.Down.toString=n;g.Down.__enum__=g;g.Alt=["Alt",71];g.Alt.toString=n;g.Alt.__enum__=g;g.Backquote=["Backquote",72];g.Backquote.toString=n;g.Backquote.__enum__=g;g.Backslash=
["Backslash",73];g.Backslash.toString=n;g.Backslash.__enum__=g;g.Backspace=["Backspace",74];g.Backspace.toString=n;g.Backspace.__enum__=g;g.CapsLock=["CapsLock",75];g.CapsLock.toString=n;g.CapsLock.__enum__=g;g.Comma=["Comma",76];g.Comma.toString=n;g.Comma.__enum__=g;g.Command=["Command",77];g.Command.toString=n;g.Command.__enum__=g;g.Control=["Control",78];g.Control.toString=n;g.Control.__enum__=g;g.Delete=["Delete",79];g.Delete.toString=n;g.Delete.__enum__=g;g.End=["End",80];g.End.toString=n;g.End.__enum__=
g;g.Enter=["Enter",81];g.Enter.toString=n;g.Enter.__enum__=g;g.Equals=["Equals",82];g.Equals.toString=n;g.Equals.__enum__=g;g.Escape=["Escape",83];g.Escape.toString=n;g.Escape.__enum__=g;g.Home=["Home",84];g.Home.toString=n;g.Home.__enum__=g;g.Insert=["Insert",85];g.Insert.toString=n;g.Insert.__enum__=g;g.LeftBracket=["LeftBracket",86];g.LeftBracket.toString=n;g.LeftBracket.__enum__=g;g.Minus=["Minus",87];g.Minus.toString=n;g.Minus.__enum__=g;g.PageDown=["PageDown",88];g.PageDown.toString=n;g.PageDown.__enum__=
g;g.PageUp=["PageUp",89];g.PageUp.toString=n;g.PageUp.__enum__=g;g.Period=["Period",90];g.Period.toString=n;g.Period.__enum__=g;g.Quote=["Quote",91];g.Quote.toString=n;g.Quote.__enum__=g;g.RightBracket=["RightBracket",92];g.RightBracket.toString=n;g.RightBracket.__enum__=g;g.Semicolon=["Semicolon",93];g.Semicolon.toString=n;g.Semicolon.__enum__=g;g.Shift=["Shift",94];g.Shift.toString=n;g.Shift.__enum__=g;g.Slash=["Slash",95];g.Slash.toString=n;g.Slash.__enum__=g;g.Space=["Space",96];g.Space.toString=
n;g.Space.__enum__=g;g.Tab=["Tab",97];g.Tab.toString=n;g.Tab.__enum__=g;g.Menu=["Menu",98];g.Menu.toString=n;g.Menu.__enum__=g;g.Search=["Search",99];g.Search.toString=n;g.Search.__enum__=g;g.Unknown=function(a){a=["Unknown",100,a];a.__enum__=g;a.toString=n;return a};var Ue=function(){this.init(0,null)};Ue.__name__=!0;Ue.prototype={init:function(a,b){this.id=a;this.key=b},__class__:Ue};var ja={__ename__:!0,__constructs__:["Left","Middle","Right","Unknown"],Left:["Left",0]};ja.Left.toString=n;ja.Left.__enum__=
ja;ja.Middle=["Middle",1];ja.Middle.toString=n;ja.Middle.__enum__=ja;ja.Right=["Right",2];ja.Right.toString=n;ja.Right.__enum__=ja;ja.Unknown=function(a){a=["Unknown",3,a];a.__enum__=ja;a.toString=n;return a};var Ta={__ename__:!0,__constructs__:["Default","Button","None"],Default:["Default",0]};Ta.Default.toString=n;Ta.Default.__enum__=Ta;Ta.Button=["Button",1];Ta.Button.toString=n;Ta.Button.__enum__=Ta;Ta.None=["None",2];Ta.None.toString=n;Ta.None.__enum__=Ta;var Ve=function(){this.init(0,0,0,null)};
Ve.__name__=!0;Ve.prototype={init:function(a,b,c,d){this.id=a;this.viewX=b;this.viewY=c;this.button=d},__class__:Ve};var Dd={__ename__:!0,__constructs__:["Mouse","Touch"]};Dd.Mouse=function(a){a=["Mouse",0,a];a.__enum__=Dd;a.toString=n;return a};Dd.Touch=function(a){a=["Touch",1,a];a.__enum__=Dd;a.toString=n;return a};var We=function(){this.init(0,0,0,null,null)};We.__name__=!0;We.prototype={init:function(a,b,c,d,e){this.id=a;this.viewX=b;this.viewY=c;this.hit=d;this.source=e;this._stopped=!1},__class__:We};
var Xe=function(a){this.id=a;this._source=Dd.Touch(this)};Xe.__name__=!0;Xe.prototype={init:function(a,b){this.viewX=a;this.viewY=b},__class__:Xe};var Rb=function(){};Rb.__name__=!0;Rb.max=function(a,b){return a>b?a:b};Rb.min=function(a,b){return a<b?a:b};Rb.clamp=function(a,b,c){return a<b?b:a>c?c:a};var va=function(){this.identity()};va.__name__=!0;va.multiply=function(a,b,c){null==c&&(c=new va);var d=a.m00*b.m00+a.m01*b.m10,e=a.m00*b.m01+a.m01*b.m11,f=a.m00*b.m02+a.m01*b.m12+a.m02;c.m00=d;c.m01=
e;c.m02=f;d=a.m10*b.m00+a.m11*b.m10;e=a.m10*b.m01+a.m11*b.m11;f=a.m10*b.m02+a.m11*b.m12+a.m12;c.m10=d;c.m11=e;c.m12=f;return c};va.prototype={set:function(a,b,c,d,e,f){this.m00=a;this.m01=c;this.m02=e;this.m10=b;this.m11=d;this.m12=f},identity:function(){this.set(1,0,0,1,0,0)},translate:function(a,b){this.m02+=this.m00*a+this.m01*b;this.m12+=this.m11*b+this.m10*a},invert:function(){var a=this.determinant();if(0==a)return!1;this.set(this.m11/a,-this.m01/a,-this.m10/a,this.m00/a,(this.m01*this.m12-
this.m11*this.m02)/a,(this.m10*this.m02-this.m00*this.m12)/a);return!0},transformArray:function(a,b,c){for(var d=0;d<b;){var e=a[d],f=a[d+1];c[d++]=e*this.m00+f*this.m01+this.m02;c[d++]=e*this.m10+f*this.m11+this.m12}},determinant:function(){return this.m00*this.m11-this.m01*this.m10},inverseTransform:function(a,b,c){var d=this.determinant();if(0==d)return!1;a-=this.m02;b-=this.m12;c.x=(a*this.m11-b*this.m01)/d;c.y=(b*this.m00-a*this.m10)/d;return!0},clone:function(a){null==a&&(a=new va);a.set(this.m00,
this.m10,this.m01,this.m11,this.m02,this.m12);return a},__class__:va};var kd=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.set(a,b,c,d)};kd.__name__=!0;kd.prototype={set:function(a,b,c,d){this.x=a;this.y=b;this.width=c;this.height=d},contains:function(a,b){a-=this.x;if(0<=this.width){if(0>a||a>this.width)return!1}else if(0<a||a<this.width)return!1;b-=this.y;if(0<=this.height){if(0>b||b>this.height)return!1}else if(0<b||b<this.height)return!1;return!0},clone:function(a){null==
a&&(a=new kd);a.set(this.x,this.y,this.width,this.height);return a},equals:function(a){return this.x==a.x&&this.y==a.y&&this.width==a.width&&this.height==a.height},__class__:kd};var X=function(){this._disposed=!1};X.__name__=!0;X.__interfaces__=[Uc];X.prototype={dispose:function(){this._disposed||(this._disposed=!0,this.onDisposed())},onDisposed:function(){null},__class__:X};var Wc=function(a,b){var c=this;this.manifest=b;this._platform=a;this.promise=new Vc;this._bytesLoaded=new bc;this._pack=new Zd(b,
this);var d=Qd.array(b);if(0==d.length)this.handleSuccess();else{for(var e=new bc,f=0;f<d.length;){var h=d[f];++f;var m=e.get(h.name);null==m&&(m=[],e.set(h.name,m));m.push(h)}this._assetsRemaining=Qd.count(e);for(d=new $d(e,e.arrayKeys());d.hasNext();)e=[d.next()],this.pickBestEntry(e[0],function(a){return function(d){if(null!=d){var e=b.getFullURL(d);try{c.loadEntry(e,d)}catch(f){f instanceof j&&(f=f.val),c.handleError(d,"Unexpected error: "+$.string(f))}e=c.promise;e.set_total(e._total+d.bytes)}else d=
a[0][0],Wc.isAudio(d.format)?c.handleLoad(d,wa.getInstance()):c.handleError(d,"Could not find a supported format to load")}}(e))}};Wc.__name__=!0;Wc.isAudio=function(a){switch(a[1]){case 8:case 9:case 10:case 11:case 12:return!0;default:return!1}};Wc.prototype={onDisposed:function(){},pickBestEntry:function(a,b){this.getAssetFormats(function(c){for(var d=0;d<c.length;){var e=c[d];++d;for(var f=0;f<a.length;){var h=a[f];++f;if(h.format==e){b(h);return}}}b(null)})},loadEntry:function(){null},getAssetFormats:function(){null},
handleLoad:function(a,b){if(!this._pack.disposed){this.handleProgress(a,a.bytes);var c;switch(a.format[1]){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c=this._pack.textures;break;case 8:case 9:case 10:case 11:case 12:c=this._pack.sounds;break;case 13:c=this._pack.files}c.set(a.name,b);this._assetsRemaining-=1;0==this._assetsRemaining&&this.handleSuccess()}},handleProgress:function(a,b){this._bytesLoaded.set(a.name,b);for(var c=0,d=this._bytesLoaded.iterator();d.hasNext();)var e=d.next(),
c=c+e;this.promise.set_progress(c)},handleSuccess:function(){this.promise.set_result(this._pack)},handleError:function(a,b){this.promise.error.emit(na.withFields(b,["url",a.url]))},handleTextureError:function(a){this.handleError(a,"Failed to create texture. Is the GPU context unavailable?")},__class__:Wc};var Zd=function(a,b){this.disposed=!1;this._manifest=a;this.loader=b;this.textures=new bc;this.sounds=new bc;this.files=new bc};Zd.__name__=!0;Zd.__interfaces__=[Wd];Zd.prototype={getTexture:function(a,
b){null==b&&(b=!0);var c=this.textures.get(a);if(null==c&&b)throw new j(na.withFields("Missing texture",["name",a]));return c},getFile:function(a,b){null==b&&(b=!0);var c=this.files.get(a);if(null==c&&b)throw new j(na.withFields("Missing file",["name",a]));return c},dispose:function(){if(!this.disposed){this.disposed=!0;for(var a=this.textures.iterator();a.hasNext();)a.next().dispose();this.textures=null;for(a=this.sounds.iterator();a.hasNext();)a.next().dispose();this.sounds=null;for(a=this.files.iterator();a.hasNext();)a.next().dispose();
this.files=null;this.loader.onDisposed()}},__class__:Zd};var Ed=function(a){this._disposed=!1;this._content=a};Ed.__name__=!0;Ed.__interfaces__=[me];Ed.__super__=X;Ed.prototype=r(X.prototype,{toString:function(){return this._content},onDisposed:function(){this._content=null},__class__:Ed});var Ye=function(){};Ye.__name__=!0;Ye.prototype={__class__:Ye};var bb=function(){this.down=new Q;this.up=new Q;this.backButton=new ld;this._keyStates=new Xc};bb.__name__=!0;bb.__interfaces__=[Ye];bb.prototype={submitDown:function(a){if(16777238==
a)return null!=this.backButton._head?(this.backButton.emit(),!0):!1;this._keyStates.h.hasOwnProperty(a)||(this._keyStates.h[a]=!0,bb._sharedEvent.init(bb._sharedEvent.id+1,Ze.toKey(a)),this.down.emit(bb._sharedEvent));return!0},submitUp:function(a){this._keyStates.h.hasOwnProperty(a)&&(this._keyStates.remove(a),bb._sharedEvent.init(bb._sharedEvent.id+1,Ze.toKey(a)),this.up.emit(bb._sharedEvent))},__class__:bb};var $e=function(){};$e.__name__=!0;$e.prototype={__class__:$e};var xa=function(a){this._pointer=
a;this._source=Dd.Mouse(xa._sharedEvent);this.down=new Q;this.move=new Q;this.up=new Q;this.scroll=new Q;this._y=this._x=0;this._cursor=Ta.Default;this._buttonStates=new Xc};xa.__name__=!0;xa.__interfaces__=[$e];xa.prototype={submitDown:function(a,b,c){this._buttonStates.h.hasOwnProperty(c)||(this._buttonStates.h[c]=!0,this.prepare(a,b,af.toButton(c)),this._pointer.submitDown(a,b,this._source),this.down.emit(xa._sharedEvent))},submitMove:function(a,b){this.prepare(a,b,null);this._pointer.submitMove(a,
b,this._source);this.move.emit(xa._sharedEvent)},submitUp:function(a,b,c){this._buttonStates.h.hasOwnProperty(c)&&(this._buttonStates.remove(c),this.prepare(a,b,af.toButton(c)),this._pointer.submitUp(a,b,this._source),this.up.emit(xa._sharedEvent))},submitScroll:function(a,b,c){this._x=a;this._y=b;if(null==this.scroll._head)return!1;this.scroll.emit(c);return!0},prepare:function(a,b,c){this._x=a;this._y=b;xa._sharedEvent.init(xa._sharedEvent.id+1,a,b,c)},__class__:xa};var bf=function(){};bf.__name__=
!0;bf.prototype={__class__:bf};var Sa=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);null==a&&(a=0);this.down=new Q;this.move=new Q;this.up=new Q;this._x=a;this._y=b;this._isDown=c};Sa.__name__=!0;Sa.__interfaces__=[bf];Sa.prototype={submitDown:function(a,b,c){if(!this._isDown){this.submitMove(a,b,c);this._isDown=!0;var d=[],e=B.hitTest(J.root,a,b);if(null!=e){var f=e.owner;do{var h=f._compMap.Sprite_1;null!=h&&d.push(h);f=f.parent}while(null!=f)}this.prepare(a,b,e,c);for(a=0;a<d.length;)if(b=d[a],
++a,b.onPointerDown(Sa._sharedEvent),Sa._sharedEvent._stopped)return;this.down.emit(Sa._sharedEvent)}},submitMove:function(a,b,c){if(!(a==this._x&&b==this._y)){var d=[],e=B.hitTest(J.root,a,b);if(null!=e){var f=e.owner;do{var h=f._compMap.Sprite_1;null!=h&&d.push(h);f=f.parent}while(null!=f)}this.prepare(a,b,e,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerMove(Sa._sharedEvent),Sa._sharedEvent._stopped)return;this.move.emit(Sa._sharedEvent)}},submitUp:function(a,b,c){if(this._isDown){this.submitMove(a,
b,c);this._isDown=!1;var d=[],e=B.hitTest(J.root,a,b);if(null!=e){var f=e.owner;do{var h=f._compMap.Sprite_1;null!=h&&d.push(h);f=f.parent}while(null!=f)}this.prepare(a,b,e,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerUp(Sa._sharedEvent),Sa._sharedEvent._stopped)return;this.up.emit(Sa._sharedEvent)}},prepare:function(a,b,c,d){this._x=a;this._y=b;Sa._sharedEvent.init(Sa._sharedEvent.id+1,a,b,c,d)},__class__:Sa};var ka=function(a,b,c){this._x=this._y=0;this._parent=null;this.rootX=this.rootY=0;this._disposed=
!1;this.root=a;this._width=b;this._height=c};ka.__name__=!0;ka.__interfaces__=[cg];ka.__super__=X;ka.prototype=r(X.prototype,{readPixels:function(a,b,c,d){return this.root.readPixels(this.rootX+a,this.rootY+b,c,d)},subTexture:function(a,b,c,d){c=this.root.createTexture(c,d);c._parent=this;c._x=a;c._y=b;c.rootX=this.rootX+a;c.rootY=this.rootY+b;return c},onDisposed:function(){null==this._parent&&this.root.dispose()},get_width:function(){return this._width},get_height:function(){return this._height},
__class__:ka});var dg=function(){};dg.__name__=!0;var hd=function(a,b){null==b&&(b=4);this._pointer=a;this._maxPoints=b;this._pointMap=new Xc;this._points=[];this.down=new Q;this.move=new Q;this.up=new Q};hd.__name__=!0;hd.__interfaces__=[dg];hd.prototype={submitDown:function(a,b,c){if(!this._pointMap.h.hasOwnProperty(a)){var d=new Xe(a);d.init(b,c);this._pointMap.h[a]=d;this._points.push(d);null==this._pointerTouch&&(this._pointerTouch=d,this._pointer.submitDown(b,c,d._source));this.down.emit(d)}},
submitMove:function(a,b,c){a=this._pointMap.h[a];null!=a&&(a.init(b,c),this._pointerTouch==a&&this._pointer.submitMove(b,c,a._source),this.move.emit(a))},submitUp:function(a,b,c){var d=this._pointMap.h[a];null!=d&&(d.init(b,c),this._pointMap.remove(a),Ha.remove(this._points,d),this._pointerTouch==d&&(this._pointerTouch=null,this._pointer.submitUp(b,c,d._source)),this.up.emit(d))},__class__:hd};var ae=function(){};ae.__name__=!0;ae.__interfaces__=[Uc];var wa=function(){this._disposed=!1;this._playback=
new be(this)};wa.__name__=!0;wa.__interfaces__=[ae];wa.getInstance=function(){null==wa._instance&&(wa._instance=new wa);return wa._instance};wa.__super__=X;wa.prototype=r(X.prototype,{onDisposed:function(){},__class__:wa});var md=function(){};md.__name__=!0;md.__interfaces__=[Pb];md.prototype={__class__:md};var be=function(a){this._sound=a;this.volume=new ia(0);this._complete=new Ia(!0)};be.__name__=!0;be.__interfaces__=[md];be.prototype={dispose:function(){},__class__:be};var Ud=function(){this.down=
new Q;this.move=new Q;this.up=new Q};Ud.__name__=!0;Ud.__interfaces__=[dg];Ud.prototype={__class__:Ud};var Fd=function(){this._entries=[]};Fd.__name__=!0;Fd.__interfaces__=[Pb];Fd.prototype={addListener:function(a,b,c){a.addEventListener(b,c,!1);this._entries.push(new cf(a,b,c))},addDisposingListener:function(a,b,c){var d=this;this.addListener(a,b,function(a){d.dispose();c(a)})},dispose:function(){for(var a=0,b=this._entries;a<b.length;){var c=b[a];++a;c.dispatcher.removeEventListener(c.type,c.listener,
!1)}this._entries=[]},__class__:Fd};var cf=function(a,b,c){this.dispatcher=a;this.type=b;this.listener=c};cf.__name__=!0;cf.prototype={__class__:cf};var Gd=function(){};Gd.__name__=!0;Gd.__interfaces__=[Te];Gd.prototype={__class__:Gd};var df=function(){};df.__name__=!0;df.prototype={__class__:df};var Hd=function(){};Hd.__name__=!0;Hd.__interfaces__=[df];Hd.prototype={__class__:Hd};var Ze=function(){};Ze.__name__=!0;Ze.toKey=function(a){switch(a){case 65:return g.A;case 66:return g.B;case 67:return g.C;
case 68:return g.D;case 69:return g.E;case 70:return g.F;case 71:return g.G;case 72:return g.H;case 73:return g.I;case 74:return g.J;case 75:return g.K;case 76:return g.L;case 77:return g.M;case 78:return g.N;case 79:return g.O;case 80:return g.P;case 81:return g.Q;case 82:return g.R;case 83:return g.S;case 84:return g.T;case 85:return g.U;case 86:return g.V;case 87:return g.W;case 88:return g.X;case 89:return g.Y;case 90:return g.Z;case 48:return g.Number0;case 49:return g.Number1;case 50:return g.Number2;
case 51:return g.Number3;case 52:return g.Number4;case 53:return g.Number5;case 54:return g.Number6;case 55:return g.Number7;case 56:return g.Number8;case 57:return g.Number9;case 96:return g.Numpad0;case 97:return g.Numpad1;case 98:return g.Numpad2;case 99:return g.Numpad3;case 100:return g.Numpad4;case 101:return g.Numpad5;case 102:return g.Numpad6;case 103:return g.Numpad7;case 104:return g.Numpad8;case 105:return g.Numpad9;case 107:return g.NumpadAdd;case 110:return g.NumpadDecimal;case 111:return g.NumpadDivide;
case 108:return g.NumpadEnter;case 106:return g.NumpadMultiply;case 109:return g.NumpadSubtract;case 112:return g.F1;case 113:return g.F2;case 114:return g.F3;case 115:return g.F4;case 116:return g.F5;case 117:return g.F6;case 118:return g.F7;case 119:return g.F8;case 120:return g.F9;case 121:return g.F10;case 122:return g.F11;case 123:return g.F12;case 37:return g.Left;case 38:return g.Up;case 39:return g.Right;case 40:return g.Down;case 18:return g.Alt;case 192:return g.Backquote;case 220:return g.Backslash;
case 8:return g.Backspace;case 20:return g.CapsLock;case 188:return g.Comma;case 15:return g.Command;case 17:return g.Control;case 46:return g.Delete;case 35:return g.End;case 13:return g.Enter;case 187:return g.Equals;case 27:return g.Escape;case 36:return g.Home;case 45:return g.Insert;case 219:return g.LeftBracket;case 189:return g.Minus;case 34:return g.PageDown;case 33:return g.PageUp;case 190:return g.Period;case 222:return g.Quote;case 221:return g.RightBracket;case 186:return g.Semicolon;
case 16:return g.Shift;case 191:return g.Slash;case 32:return g.Space;case 9:return g.Tab;case 16777234:return g.Menu;case 16777247:return g.Search}return g.Unknown(a)};var gd=function(){this._tickables=[]};gd.__name__=!0;gd.updateEntity=function(a,b){var c=a._compMap.SpeedAdjuster_3;if(null!=c&&(c._realDt=b,b*=c.scale._value,0>=b)){c.onUpdate(b);return}for(c=a.firstComponent;null!=c;){var d=c.next;0==(c._flags&1)&&(c._flags|=1,c.onStart());c.onUpdate(b);c=d}for(c=a.firstChild;null!=c;)d=c.next,gd.updateEntity(c,
b),c=d};gd.prototype={update:function(a){if(!(0>=a)){1<a&&(a=1);for(var b=0;b<this._tickables.length;){var c=this._tickables[b];null==c||c.update(a)?this._tickables.splice(b,1):++b}J.volume.update(a);gd.updateEntity(J.root,a)}},render:function(a){var b=a.graphics;null!=b&&(a.willRender(),B.render(J.root,b),a.didRender())},__class__:gd};var ef=function(){};ef.__name__=!0;ef.nextPowerOfTwo=function(a){for(var b=1;b<a;)b<<=1;return b};var af=function(){};af.__name__=!0;af.toButton=function(a){switch(a){case 0:return ja.Left;
case 1:return ja.Middle;case 2:return ja.Right}return ja.Unknown(a)};var nd=function(){};nd.__name__=!0;nd.prototype={__class__:nd};var ce=function(a,b){this._firstDraw=!1;this._canvasCtx=a.getContext("2d",{alpha:b})};ce.__name__=!0;ce.__interfaces__=[Gd];ce.prototype={save:function(){this._canvasCtx.save()},transform:function(a,b,c,d,e,f){this._canvasCtx.transform(a,b,c,d,e,f)},restore:function(){this._canvasCtx.restore()},drawTexture:function(a,b,c){this.drawSubTexture(a,b,c,0,0,a.get_width(),a.get_height())},
drawSubTexture:function(a,b,c,d,e,f,h){this._firstDraw?(this._firstDraw=!1,this._canvasCtx.globalCompositeOperation="copy",this.drawSubTexture(a,b,c,d,e,f,h),this._canvasCtx.globalCompositeOperation="source-over"):this._canvasCtx.drawImage(a.root.image,a.rootX+d|0,a.rootY+e|0,f|0,h|0,b|0,c|0,f|0,h|0)},fillRect:function(a,b,c,d,e){if(this._firstDraw)this._firstDraw=!1,this._canvasCtx.globalCompositeOperation="copy",this.fillRect(a,b,c,d,e),this._canvasCtx.globalCompositeOperation="source-over";else{for(a=
(16777215&a).toString(16);6>a.length;)a="0"+$.string(a);this._canvasCtx.fillStyle="#"+$.string(a);this._canvasCtx.fillRect(b|0,c|0,d|0,e|0)}},multiplyAlpha:function(a){this._canvasCtx.globalAlpha*=a},setBlendMode:function(a){var b;switch(a[1]){case 0:b="source-over";break;case 1:b="lighter";break;case 2:b="multiply";break;case 3:b="screen";break;case 4:b="destination-in";break;case 5:b="copy"}this._canvasCtx.globalCompositeOperation=b},applyScissor:function(a,b,c,d){this._canvasCtx.beginPath();this._canvasCtx.rect(a|
0,b|0,c|0,d|0);this._canvasCtx.clip()},willRender:function(){this._firstDraw=!0},didRender:function(){},onResize:function(){},__class__:ce};var Sc=function(a){this.graphics=new ce(a,!1);this._hasGPU=new Ia(!0)};Sc.__name__=!0;Sc.__interfaces__=[Hd];Sc.prototype={get_type:function(){return Bb.Canvas},createTextureFromImage:function(a){a=new Id(Sc.CANVAS_TEXTURES?C.createCanvas(a):a);return a.createTexture(a.width,a.height)},getCompressedTextureFormats:function(){return[]},createCompressedTexture:function(){return null},
willRender:function(){this.graphics.willRender()},didRender:function(){this.graphics.didRender()},__class__:Sc};var Jd=function(a,b,c){ka.call(this,a,b,c)};Jd.__name__=!0;Jd.__super__=ka;Jd.prototype=r(ka.prototype,{__class__:Jd});var Id=function(a){this._graphics=null;this._disposed=!1;this.image=a;this.width=a.width;this.height=a.height};Id.__name__=!0;Id.__interfaces__=[nd];Id.__super__=X;Id.prototype=r(X.prototype,{createTexture:function(a,b){return new Jd(this,a,b)},readPixels:function(a,b,c,
d){return od.ofData(this.getContext2d().getImageData(a,b,c,d).data)},getContext2d:function(){u.__instanceof(this.image,HTMLCanvasElement)||(this.image=C.createCanvas(this.image));return this.image.getContext("2d",null)},onDisposed:function(){this._graphics=this.image=null},__class__:Id});var I=function(a,b){Wc.call(this,a,b)};I.__name__=!0;I.detectImageFormats=function(a){var b=[o.PNG,o.JPG,o.GIF],c=2,d;d=window.document.createElement("img");d.onload=d.onerror=function(){1==d.width&&b.unshift(o.WEBP);
--c;0==c&&a(b)};d.src="data:image/webp;base64,UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==";var e;e=window.document.createElement("img");e.onload=e.onerror=function(){1==e.width&&b.unshift(o.JXR);--c;0==c&&a(b)};e.src="data:image/vnd.ms-photo;base64,SUm8AQgAAAAFAAG8AQAQAAAASgAAAIC8BAABAAAAAQAAAIG8BAABAAAAAQAAAMC8BAABAAAAWgAAAMG8BAABAAAAHwAAAAAAAAAkw91vA07+S7GFPXd2jckNV01QSE9UTwAZAYBxAAAAABP/gAAEb/8AAQAAAQAAAA=="};I.detectAudioFormats=function(){var a;a=window.document.createElement("audio");if(null==
a||null==E(a,a.canPlayType))return[];var b=new Ac("\\b(iPhone|iPod|iPad|Android|Windows Phone)\\b",""),c=window.navigator.userAgent;if(!S.get_supported()&&b.match(c))return[];for(var b=[{format:o.M4A,mimeType:"audio/mp4; codecs=mp4a"},{format:o.MP3,mimeType:"audio/mpeg"},{format:o.OPUS,mimeType:"audio/ogg; codecs=opus"},{format:o.OGG,mimeType:"audio/ogg; codecs=vorbis"},{format:o.WAV,mimeType:"audio/wav"}],c=[],d=0;d<b.length;){var e=b[d];++d;var f="";try{f=a.canPlayType(e.mimeType)}catch(h){h instanceof
j&&(h=h.val)}""!=f&&c.push(e.format)}return c};I.supportsBlob=function(){if(I._detectBlobSupport){I._detectBlobSupport=!1;if((new Ac("\\bSilk\\b","")).match(window.navigator.userAgent)||null==window.Blob)return!1;var a=new XMLHttpRequest;a.open("GET",".",!0);if(""!=a.responseType)return!1;a.responseType="blob";if("blob"!=a.responseType)return!1;I._URL=C.loadExtension("URL").value}return null!=I._URL&&null!=I._URL.createObjectURL};I.__super__=Wc;I.prototype=r(Wc.prototype,{loadEntry:function(a,b){var c=
this;switch(b.format[1]){case 0:case 1:case 2:case 3:case 4:var d;d=window.document.createElement("img");var e=new Fd;e.addDisposingListener(d,"load",function(){I.supportsBlob()&&I._URL.revokeObjectURL(d.src);var a=c._platform.getRenderer().createTextureFromImage(d);null!=a?c.handleLoad(b,a):c.handleTextureError(b)});e.addDisposingListener(d,"error",function(){c.handleError(b,"Failed to load image")});I.supportsBlob()?this.download(a,b,"blob",function(a){d.src=I._URL.createObjectURL(a)}):d.src=a;
break;case 5:case 6:case 7:this.download(a,b,"arraybuffer",function(){var a=c._platform.getRenderer().createCompressedTexture(b.format,null);null!=a?c.handleLoad(b,a):c.handleTextureError(b)});break;case 8:case 9:case 10:case 11:case 12:if(S.get_supported())this.download(a,b,"arraybuffer",function(a){S.ctx.decodeAudioData(a,function(a){c.handleLoad(b,new S(a))},function(){c.handleLoad(b,wa.getInstance())})});else{var f;f=window.document.createElement("audio");f.preload="auto";var h=++I._mediaRefCount;
null==I._mediaElements&&(I._mediaElements=new Xc);I._mediaElements.h[h]=f;e=new Fd;e.addDisposingListener(f,"canplaythrough",function(){I._mediaElements.remove(h);c.handleLoad(b,new Yc(f))});e.addDisposingListener(f,"error",function(){I._mediaElements.remove(h);var a=f.error.code;3==a||4==a?c.handleLoad(b,wa.getInstance()):c.handleError(b,"Failed to load audio: "+f.error.code)});e.addListener(f,"progress",function(){if(0<f.buffered.length&&0<f.duration){var a=f.buffered.end(0)/f.duration;c.handleProgress(b,
a*b.bytes|0)}});f.src=a;f.load()}break;case 13:this.download(a,b,"text",function(a){c.handleLoad(b,new Ed(a))})}},getAssetFormats:function(a){var b=this;null==I._supportedFormats&&(I._supportedFormats=new Vc,I.detectImageFormats(function(a){I._supportedFormats.set_result(b._platform.getRenderer().getCompressedTextureFormats().concat(a).concat(I.detectAudioFormats()).concat([o.Data]))}));I._supportedFormats.get(a)},download:function(a,b,c,d){var e=this,f=null,h=null,m=0,l=!1,i=function(){l&&(l=!1,
window.clearInterval(m))},g=3,j=function(){--g;return 0<=g?(h(),!0):!1},h=function(){i();null!=f&&f.abort();f=new XMLHttpRequest;f.open("GET",a,!0);f.responseType=c;var h=0;f.onprogress=function(a){l||(l=!0,m=window.setInterval(function(){4!=f.readyState&&5E3<Date.now()-h&&!j()&&(i(),e.handleError(b,"Download stalled"))},1E3));h=Date.now();e.handleProgress(b,a.loaded)};f.onerror=function(){if(0!=f.status||!j())i(),e.handleError(b,"HTTP error "+f.status)};f.onload=function(){var a=f.response;null==
a&&(a=f.responseText);i();d(a)};f.send()};h()},__class__:I});var fd=function(a,b){xa.call(this,a);this._canvas=b};fd.__name__=!0;fd.__super__=xa;fd.prototype=r(xa.prototype,{__class__:fd});var Yc=function(a){this._disposed=!1;this.audioElement=a};Yc.__name__=!0;Yc.__interfaces__=[ae];Yc.__super__=X;Yc.prototype=r(X.prototype,{onDisposed:function(){this.audioElement=null},__class__:Yc});var ff=function(){};ff.__name__=!0;ff.prototype={__class__:ff};var ed=function(a){var b=this;this._canvas=a;this.resize=
new ld;this.scaleFactor=ed.computeScaleFactor();1!=this.scaleFactor&&(C.setVendorStyle(this._canvas,"transform-origin","top left"),C.setVendorStyle(this._canvas,"transform","scale("+1/this.scaleFactor+")"));C.SHOULD_HIDE_MOBILE_BROWSER&&(window.addEventListener("orientationchange",function(){C.callLater(E(b,b.hideMobileBrowser),200)},!1),this.hideMobileBrowser());window.addEventListener("resize",E(this,this.onWindowResize),!1);this.onWindowResize(null);this.orientation=new Ia(null);null!=window.orientation&&
(window.addEventListener("orientationchange",E(this,this.onOrientationChange),!1),this.onOrientationChange(null));this.fullscreen=new Ia(!1);C.addVendorListener(window.document,"fullscreenchange",function(){b.updateFullscreen()},!1);this.updateFullscreen()};ed.__name__=!0;ed.__interfaces__=[ff];ed.computeScaleFactor=function(){var a=window.devicePixelRatio;null==a&&(a=1);var b=window.document.createElement("canvas").getContext("2d",null),b=C.loadExtension("backingStorePixelRatio",b).value;null==b&&
(b=1);a/=b;b=window.screen.height;return 1136<a*window.screen.width||1136<a*b?1:a};ed.prototype={get_width:function(){return this._canvas.width},get_height:function(){return this._canvas.height},onWindowResize:function(){var a=this._canvas.parentElement.getBoundingClientRect();this.resizeCanvas(a.width,a.height)},resizeCanvas:function(a,b){var c=this.scaleFactor*a,d=this.scaleFactor*b;if(this._canvas.width==c&&this._canvas.height==d)return!1;this._canvas.width=c|0;this._canvas.height=d|0;this.resize.emit();
return!0},hideMobileBrowser:function(){var a=this,b=window.document.documentElement.style;b.height=window.innerHeight+100+"px";b.width=window.innerWidth+"px";b.overflow="visible";C.callLater(function(){C.hideMobileBrowser();C.callLater(function(){b.height=window.innerHeight+"px";a.onWindowResize(null)},100)})},onOrientationChange:function(){this.orientation.set__(C.orientation(window.orientation))},updateFullscreen:function(){this.fullscreen.set__(!0==C.loadFirstExtension(["fullscreen","fullScreen",
"isFullScreen"],window.document).value)},__class__:ed};var C=function(){};C.__name__=!0;C.callLater=function(a,b){null==b&&(b=0);window.setTimeout(a,b)};C.hideMobileBrowser=function(){window.scrollTo(1,0)};C.loadExtension=function(a,b){null==b&&(b=window);var c=nc.field(b,a);if(null!=c)return{prefix:"",field:a,value:c};for(var c=a.charAt(0).toUpperCase()+Ha.substr(a,1,null),d=0,e=C.VENDOR_PREFIXES;d<e.length;){var f=e[d];++d;var h=f+c,m=nc.field(b,h);if(null!=m)return{prefix:f,field:h,value:m}}return{prefix:null,
field:null,value:null}};C.loadFirstExtension=function(a,b){for(var c=0;c<a.length;){var d=a[c];++c;d=C.loadExtension(d,b);if(null!=d.field)return d}return{prefix:null,field:null,value:null}};C.polyfill=function(a,b){null==b&&(b=window);var c=C.loadExtension(a,b).value;if(null==c)return!1;b[a]=c;return!0};C.setVendorStyle=function(a,b,c){for(var a=a.style,d=0,e=C.VENDOR_PREFIXES;d<e.length;){var f=e[d];++d;a.setProperty("-"+f+"-"+b,c)}a.setProperty(b,c)};C.addVendorListener=function(a,b,c,d){for(var e=
0,f=C.VENDOR_PREFIXES;e<f.length;){var h=f[e];++e;a.addEventListener(h+b,c,d)}a.addEventListener(b,c,d)};C.orientation=function(a){switch(a){case -90:case 90:return Fc.Landscape;default:return Fc.Portrait}};C.createEmptyCanvas=function(a,b){var c;c=window.document.createElement("canvas");c.width=a;c.height=b;return c};C.createCanvas=function(a){var b=C.createEmptyCanvas(a.width,a.height),c=b.getContext("2d",null);c.save();c.globalCompositeOperation="copy";c.drawImage(a,0,0);c.restore();return b};
C.detectSlowDriver=function(a){if(0<=window.navigator.platform.indexOf("Win")&&null!=window.chrome){for(var b=0,a=a.getSupportedExtensions();b<a.length;){var c=a[b];++b;if(0<=c.indexOf("WEBGL_compressed_texture"))return!1}return!0}return!1};C.fixAndroidMath=function(){if(0<=window.navigator.userAgent.indexOf("Linux; U; Android 4")){var a=Math.sin,b=Math.cos;Math.sin=function(b){return 0==b?0:a(b)};Math.cos=function(a){return 0==a?1:b(a)}}};var S=function(a){this._disposed=!1;this.buffer=a};S.__name__=
!0;S.__interfaces__=[ae];S.get_supported=function(){if(S._detectSupport){S._detectSupport=!1;var a=C.loadExtension("AudioContext").value;null!=a&&(S.ctx=new a,S.gain=S.createGain(),S.gain.connect(S.ctx.destination),J.volume.watch(function(a){S.gain.gain.value=a}))}return null!=S.ctx};S.createGain=function(){return null!=S.ctx.createGain?S.ctx.createGain():S.ctx.createGainNode()};S.__super__=X;S.prototype=r(X.prototype,{onDisposed:function(){this.buffer=null},__class__:S});var gf=function(a){this._quads=
this._maxQuads=this._dataOffset=this._backbufferWidth=this._backbufferHeight=0;this._pendingSetScissor=!1;this._lastBlendMode=this._lastRenderTarget=this._lastShader=this._lastTexture=this._lastScissor=this._currentBlendMode=this._currentShader=this._currentTexture=this._currentRenderTarget=null;this._gl=a;a.clearColor(0,0,0,0);a.enable(3042);a.pixelStorei(37441,1);this._vertexBuffer=a.createBuffer();a.bindBuffer(34962,this._vertexBuffer);this._quadIndexBuffer=a.createBuffer();a.bindBuffer(34963,
this._quadIndexBuffer);this._drawTextureShader=new pd(a);this._drawPatternShader=new de(a);this._fillRectShader=new qd(a);this.resize(16)};gf.__name__=!0;gf.prototype={resizeBackbuffer:function(a,b){this._gl.viewport(0,0,a,b);this._backbufferWidth=a;this._backbufferHeight=b},willRender:function(){},didRender:function(){this.flush()},bindTexture:function(a){this.flush();this._currentTexture=this._lastTexture=null;this._gl.bindTexture(3553,a)},deleteTexture:function(a){null!=this._lastTexture&&this._lastTexture.root==
a&&(this.flush(),this._currentTexture=this._lastTexture=null);this._gl.deleteTexture(a.nativeTexture)},bindFramebuffer:function(a){a!=this._lastRenderTarget&&(this.flush(),this.bindRenderTarget(a))},deleteFramebuffer:function(a){a==this._lastRenderTarget&&(this.flush(),this._currentRenderTarget=this._lastRenderTarget=null);this._gl.deleteFramebuffer(a.framebuffer)},prepareDrawTexture:function(a,b,c,d){d!=this._lastTexture&&(this.flush(),this._lastTexture=d);return this.prepareQuad(5,a,b,c,this._drawTextureShader)},
prepareFillRect:function(a,b,c){return this.prepareQuad(6,a,b,c,this._fillRectShader)},prepareQuad:function(a,b,c,d,e){b!=this._lastRenderTarget&&(this.flush(),this._lastRenderTarget=b);c!=this._lastBlendMode&&(this.flush(),this._lastBlendMode=c);e!=this._lastShader&&(this.flush(),this._lastShader=e);if(null!=d||null!=this._lastScissor)if(null==d||null==this._lastScissor||!this._lastScissor.equals(d))this.flush(),this._lastScissor=null!=d?d.clone(this._lastScissor):null,this._pendingSetScissor=!0;
this._quads>=this._maxQuads&&this.resize(2*this._maxQuads);++this._quads;b=this._dataOffset;this._dataOffset+=4*a;return b},flush:function(){if(!(1>this._quads)){this._lastRenderTarget!=this._currentRenderTarget&&this.bindRenderTarget(this._lastRenderTarget);if(this._lastBlendMode!=this._currentBlendMode){switch(this._lastBlendMode[1]){case 0:this._gl.blendFunc(1,771);break;case 1:this._gl.blendFunc(1,1);break;case 2:this._gl.blendFunc(774,771);break;case 3:this._gl.blendFunc(1,769);break;case 4:this._gl.blendFunc(0,
770);break;case 5:this._gl.blendFunc(1,0)}this._currentBlendMode=this._lastBlendMode}this._pendingSetScissor&&(null!=this._lastScissor?(this._gl.enable(3089),this._gl.scissor(this._lastScissor.x|0,this._lastScissor.y|0,this._lastScissor.width|0,this._lastScissor.height|0)):this._gl.disable(3089),this._pendingSetScissor=!1);this._lastTexture!=this._currentTexture&&(this._gl.bindTexture(3553,this._lastTexture.root.nativeTexture),this._currentTexture=this._lastTexture);this._lastShader!=this._currentShader&&
(this._lastShader.useProgram(),this._lastShader.prepare(),this._currentShader=this._lastShader);if(this._lastShader==this._drawPatternShader){var a=this._lastTexture,b=a.root;this._drawPatternShader.setRegion(a.rootX/b.width,a.rootY/b.height,a._width/b.width,a._height/b.height)}this._gl.bufferData(34962,this.data.subarray(0,this._dataOffset),35040);this._gl.drawElements(4,6*this._quads,5123,0);this._dataOffset=this._quads=0}},resize:function(a){this.flush();if(!(1024<a)){this._maxQuads=a;this.data=
new Float32Array(24*a);this._gl.bufferData(34962,4*this.data.length,35040);for(var b=new Uint16Array(6*a),c=0;c<a;){var d=c++;b[6*d]=4*d;b[6*d+1]=4*d+1;b[6*d+2]=4*d+2;b[6*d+3]=4*d+2;b[6*d+4]=4*d+3;b[6*d+5]=4*d}this._gl.bufferData(34963,b,35044)}},bindRenderTarget:function(a){null!=a?(this._gl.bindFramebuffer(36160,a.framebuffer),this._gl.viewport(0,0,a.width,a.height)):(this._gl.bindFramebuffer(36160,null),this._gl.viewport(0,0,this._backbufferWidth,this._backbufferHeight));this._lastRenderTarget=
this._currentRenderTarget=a},__class__:gf};var gb=function(a,b){this._inverseProjection=this._stateList=null;null==gb._scratchQuadArray&&(gb._scratchQuadArray=new Float32Array(8));this._batcher=a;this._renderTarget=b};gb.__name__=!0;gb.__interfaces__=[Gd];gb.prototype={save:function(){var a=this._stateList,b=this._stateList.next;null==b&&(b=new Kd,b.prev=a,a.next=b);a.matrix.clone(b.matrix);b.alpha=a.alpha;b.blendMode=a.blendMode;b.scissor=null!=a.scissor?a.scissor.clone(b.scissor):null;this._stateList=
b},transform:function(a,b,c,d,e,f){var h=this._stateList;gb._scratchMatrix.set(a,b,c,d,e,f);va.multiply(h.matrix,gb._scratchMatrix,h.matrix)},restore:function(){this._stateList=this._stateList.prev},drawTexture:function(a,b,c){this.drawSubTexture(a,b,c,0,0,a.get_width(),a.get_height())},drawSubTexture:function(a,b,c,d,e,f,h){var m=this._stateList,l=a.root,b=this.transformQuad(b,c,f,h),c=l.width,l=l.height,d=(a.rootX+d)/c,e=(a.rootY+e)/l,f=d+f/c,h=e+h/l,c=m.alpha,a=this._batcher.prepareDrawTexture(this._renderTarget,
m.blendMode,m.scissor,a),m=this._batcher.data;m[a]=b[0];m[++a]=b[1];m[++a]=d;m[++a]=e;m[++a]=c;m[++a]=b[2];m[++a]=b[3];m[++a]=f;m[++a]=e;m[++a]=c;m[++a]=b[4];m[++a]=b[5];m[++a]=f;m[++a]=h;m[++a]=c;m[++a]=b[6];m[++a]=b[7];m[++a]=d;m[++a]=h;m[++a]=c},fillRect:function(a,b,c,d,e){var f=this._stateList,b=this.transformQuad(b,c,d,e),c=(a&16711680)/16711680,d=(a&65280)/65280,a=(a&255)/255,e=f.alpha,f=this._batcher.prepareFillRect(this._renderTarget,f.blendMode,f.scissor),h=this._batcher.data;h[f]=b[0];
h[++f]=b[1];h[++f]=c;h[++f]=d;h[++f]=a;h[++f]=e;h[++f]=b[2];h[++f]=b[3];h[++f]=c;h[++f]=d;h[++f]=a;h[++f]=e;h[++f]=b[4];h[++f]=b[5];h[++f]=c;h[++f]=d;h[++f]=a;h[++f]=e;h[++f]=b[6];h[++f]=b[7];h[++f]=c;h[++f]=d;h[++f]=a;h[++f]=e},multiplyAlpha:function(a){this._stateList.alpha*=a},setBlendMode:function(a){this._stateList.blendMode=a},applyScissor:function(a,b,c,d){var e=this._stateList,f=gb._scratchQuadArray;f[0]=a;f[1]=b;f[2]=a+c;f[3]=b+d;e.matrix.transformArray(f,4,f);this._inverseProjection.transformArray(f,
4,f);a=f[0];b=f[1];c=f[2]-a;d=f[3]-b;0>c&&(a+=c,c=-c);0>d&&(b+=d,d=-d);e.applyScissor(a,b,c,d)},willRender:function(){this._batcher.willRender()},didRender:function(){this._batcher.didRender()},onResize:function(a,b){this._stateList=new Kd;var c;c=null!=this._renderTarget?-1:1;this._stateList.matrix.set(2/a,0,0,-2*c/b,-1,c);this._inverseProjection=new va;this._inverseProjection.set(2/a,0,0,2/b,-1,-1);this._inverseProjection.invert()},transformQuad:function(a,b,c,d){var c=a+c,d=b+d,e=gb._scratchQuadArray;
e[0]=a;e[1]=b;e[2]=c;e[3]=b;e[4]=c;e[5]=d;e[6]=a;e[7]=d;this._stateList.matrix.transformArray(e,8,e);return e},__class__:gb};var Kd=function(){this.scissor=this.prev=this.next=null;this.matrix=new va;this.alpha=1;this.blendMode=ca.Normal};Kd.__name__=!0;Kd.prototype={applyScissor:function(a,b,c,d){if(null!=this.scissor)var e=Rb.max(this.scissor.x,a),f=Rb.max(this.scissor.y,b),c=Rb.min(this.scissor.x+this.scissor.width,a+c),d=Rb.min(this.scissor.y+this.scissor.height,b+d),a=e,b=f,c=c-e,d=d-f;else this.scissor=
new kd;this.scissor.set(Math.round(a),Math.round(b),Math.round(c),Math.round(d))},__class__:Kd};var Vd=function(a,b){var c=this;this._hasGPU=new Ia(!0);this.gl=b;b.canvas.addEventListener("webglcontextlost",function(a){a.preventDefault();c._hasGPU.set__(!1)},!1);b.canvas.addEventListener("webglcontextrestore",function(){c.init();c._hasGPU.set__(!0)},!1);a.resize.connect(E(this,this.onResize));this.init()};Vd.__name__=!0;Vd.__interfaces__=[Hd];Vd.prototype={get_type:function(){return Bb.WebGL},createTextureFromImage:function(a){if(this.gl.isContextLost())return null;
var b=new Zc(this,a.width,a.height);b.uploadImageData(a);return b.createTexture(a.width,a.height)},getCompressedTextureFormats:function(){return[]},createCompressedTexture:function(){this.gl.isContextLost();return null},willRender:function(){this.graphics.willRender()},didRender:function(){this.graphics.didRender()},onResize:function(){var a=this.gl.canvas.width,b=this.gl.canvas.height;this.batcher.resizeBackbuffer(a,b);this.graphics.onResize(a,b)},init:function(){this.batcher=new gf(this.gl);this.graphics=
new gb(this.batcher,null);this.onResize()},__class__:Vd};var Ld=function(a,b,c){ka.call(this,a,b,c)};Ld.__name__=!0;Ld.__super__=ka;Ld.prototype=r(ka.prototype,{__class__:Ld});var Zc=function(a,b,c){this.framebuffer=this._graphics=null;this._disposed=!1;this._renderer=a;this.width=Rb.max(2,ef.nextPowerOfTwo(b));this.height=Rb.max(2,ef.nextPowerOfTwo(c));b=a.gl;this.nativeTexture=b.createTexture();a.batcher.bindTexture(this.nativeTexture);b.texParameteri(3553,10242,33071);b.texParameteri(3553,10243,
33071);b.texParameteri(3553,10240,9729);b.texParameteri(3553,10241,9728)};Zc.__name__=!0;Zc.__interfaces__=[nd];Zc.drawBorder=function(a,b,c){var d=a.getContext("2d",null);d.drawImage(a,b-1,0,1,c,b,0,1,c);d.drawImage(a,0,c-1,b,1,0,c,b,1)};Zc.__super__=X;Zc.prototype=r(X.prototype,{createTexture:function(a,b){return new Ld(this,a,b)},uploadImageData:function(a){if(this.width!=a.width||this.height!=a.height){var b=C.createEmptyCanvas(this.width,this.height);b.getContext("2d",null).drawImage(a,0,0);
Zc.drawBorder(b,a.width,a.height);a=b}this._renderer.batcher.bindTexture(this.nativeTexture);this._renderer.gl.texImage2D(3553,0,6408,6408,5121,a)},readPixels:function(a,b,c,d){this.getGraphics();this._renderer.batcher.bindFramebuffer(this);var e=new hf(4*c*d);this._renderer.gl.readPixels(a,b,c,d,6408,5121,e);a=0;for(b=e.length;a<b;)c=255/e[a+3],e[a]*=c,++a,e[a]*=c,++a,e[a]*=c,a+=2;return od.ofData(e)},getGraphics:function(){if(null==this._graphics){this._graphics=new gb(this._renderer.batcher,this);
this._graphics.onResize(this.width,this.height);var a=this._renderer.gl;this.framebuffer=a.createFramebuffer();this._renderer.batcher.bindFramebuffer(this);a.framebufferTexture2D(36160,36064,3553,this.nativeTexture,0)}return this._graphics},onDisposed:function(){var a=this._renderer.batcher;a.deleteTexture(this);null!=this.framebuffer&&a.deleteFramebuffer(this);this._graphics=this.framebuffer=this.nativeTexture=null},__class__:Zc});var Ua=function(a,b,c){c="#ifdef GL_ES\nprecision mediump float;\n#endif\n"+
c;this._gl=a;this._program=a.createProgram();a.attachShader(this._program,Ua.createShader(a,35633,b));a.attachShader(this._program,Ua.createShader(a,35632,c));a.linkProgram(this._program);a.useProgram(this._program)};Ua.__name__=!0;Ua.createShader=function(a,b,c){b=a.createShader(b);a.shaderSource(b,c);a.compileShader(b);return b};Ua.prototype={useProgram:function(){this._gl.useProgram(this._program)},prepare:function(){null},getAttribLocation:function(a){return this._gl.getAttribLocation(this._program,
a)},getUniformLocation:function(a){return this._gl.getUniformLocation(this._program,a)},__class__:Ua};var de=function(a){Ua.call(this,a,"attribute highp vec2 a_pos;\nattribute mediump vec2 a_uv;\nattribute lowp float a_alpha;\nvarying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nvoid main (void) {\nv_uv = a_uv;\nv_alpha = a_alpha;\ngl_Position = vec4(a_pos, 0, 1);\n}","varying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nuniform lowp sampler2D u_texture;\nuniform mediump vec4 u_region;\nvoid main (void) {\ngl_FragColor = texture2D(u_texture, u_region.xy + mod(v_uv, u_region.zw)) * v_alpha;\n}");
this.a_pos=this.getAttribLocation("a_pos");this.a_uv=this.getAttribLocation("a_uv");this.a_alpha=this.getAttribLocation("a_alpha");this.u_texture=this.getUniformLocation("u_texture");this.u_region=this.getUniformLocation("u_region");this.setTexture(0)};de.__name__=!0;de.__super__=Ua;de.prototype=r(Ua.prototype,{setTexture:function(a){this._gl.uniform1i(this.u_texture,a)},setRegion:function(a,b,c,d){this._gl.uniform4f(this.u_region,a,b,c,d)},prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);
this._gl.enableVertexAttribArray(this.a_uv);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,2,5126,!1,20,0);this._gl.vertexAttribPointer(this.a_uv,2,5126,!1,20,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,20,16)},__class__:de});var pd=function(a){Ua.call(this,a,"attribute highp vec2 a_pos;\nattribute mediump vec2 a_uv;\nattribute lowp float a_alpha;\nvarying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nvoid main (void) {\nv_uv = a_uv;\nv_alpha = a_alpha;\ngl_Position = vec4(a_pos, 0, 1);\n}",
"varying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nuniform lowp sampler2D u_texture;\nvoid main (void) {\ngl_FragColor = texture2D(u_texture, v_uv) * v_alpha;\n}");this.a_pos=this.getAttribLocation("a_pos");this.a_uv=this.getAttribLocation("a_uv");this.a_alpha=this.getAttribLocation("a_alpha");this.u_texture=this.getUniformLocation("u_texture");this.setTexture(0)};pd.__name__=!0;pd.__super__=Ua;pd.prototype=r(Ua.prototype,{setTexture:function(a){this._gl.uniform1i(this.u_texture,a)},prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);
this._gl.enableVertexAttribArray(this.a_uv);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,2,5126,!1,20,0);this._gl.vertexAttribPointer(this.a_uv,2,5126,!1,20,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,20,16)},__class__:pd});var qd=function(a){Ua.call(this,a,"attribute highp vec2 a_pos;\nattribute lowp vec3 a_rgb;\nattribute lowp float a_alpha;\nvarying lowp vec4 v_color;\nvoid main (void) {\nv_color = vec4(a_rgb*a_alpha, a_alpha);\ngl_Position = vec4(a_pos, 0, 1);\n}",
"varying lowp vec4 v_color;\nvoid main (void) {\ngl_FragColor = v_color;\n}");this.a_pos=this.getAttribLocation("a_pos");this.a_rgb=this.getAttribLocation("a_rgb");this.a_alpha=this.getAttribLocation("a_alpha")};qd.__name__=!0;qd.__super__=Ua;qd.prototype=r(Ua.prototype,{prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);this._gl.enableVertexAttribArray(this.a_rgb);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,2,5126,!1,24,0);this._gl.vertexAttribPointer(this.a_rgb,
3,5126,!1,24,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,24,20)},__class__:qd});var jf=function(){this._transitor=null};jf.__name__=!0;jf.__super__=H;jf.prototype=r(H.prototype,{get_name:function(){return"Director_2"},onAdded:function(){this.owner.addChild(this._root)},onRemoved:function(){this.completeTransition();for(var a=0,b=this.scenes;a<b.length;){var c=b[a];++a;c.dispose()}this.scenes=[];this.occludedScenes=[];this._root.dispose()},onUpdate:function(a){null!=this._transitor&&this._transitor.update(a)&&
this.completeTransition()},get_topScene:function(){var a=this.scenes.length;return 0<a?this.scenes[a-1]:null},show:function(a){a=a._compMap.Scene_4;null!=a&&a.shown.emit()},invalidateVisibility:function(){for(var a=this.scenes.length;0<a;){var b=this.scenes[--a]._compMap.Scene_4;if(null==b||b.opaque)break}this.occludedScenes=0<this.scenes.length?this.scenes.slice(a,this.scenes.length-1):[];a=this.get_topScene();null!=a&&this.show(a)},completeTransition:function(){null!=this._transitor&&(this._transitor.complete(),
this._transitor=null,this.invalidateVisibility())},__class__:jf});var kf=function(){};kf.__name__=!0;kf.__super__=H;kf.prototype=r(H.prototype,{get_name:function(){return"Scene_4"},__class__:kf});var Bb={__ename__:!0,__constructs__:["Stage3D","WebGL","Canvas"],Stage3D:["Stage3D",0]};Bb.Stage3D.toString=n;Bb.Stage3D.__enum__=Bb;Bb.WebGL=["WebGL",1];Bb.WebGL.toString=n;Bb.WebGL.__enum__=Bb;Bb.Canvas=["Canvas",2];Bb.Canvas.toString=n;Bb.Canvas.__enum__=Bb;var ee=function(){};ee.__name__=!0;ee.prototype=
{__class__:ee};var Md=function(a,b){this._name=a.symbol;var c=a.rect;this.texture=b.subTexture(c[0],c[1],c[2],c[3]);c=a.origin;null!=c?(this.anchorX=c[0],this.anchorY=c[1]):this.anchorY=this.anchorX=0};Md.__name__=!0;Md.__interfaces__=[ee];Md.prototype={createSprite:function(){var a=new Dc(this.texture);a.setAnchor(this.anchorX,this.anchorY);return a},__class__:Md};var lf=function(a,b){this._file=a.getFile(b+"/library.json");var c=JSON.parse(this._file.toString());this._symbols=new bc;this.frameRate=
c.frameRate;for(var d=[],e=0,f=c.movies;e<f.length;){var h=f[e];++e;h=new fe(this,h);d.push(h);this._symbols.set(h._name,h)}c=c.textureGroups;(1!=c[0].scaleFactor||1<c.length)&&null;c=c[0].atlases;for(e=0;e<c.length;){var m=c[e];++e;f=a.getTexture(b+"/"+na.removeFileExtension(m.file));h=0;for(m=m.textures;h<m.length;){var l=m[h];++h;l=new Md(l,f);this._symbols.set(l._name,l)}}for(c=0;c<d.length;){f=d[c];++c;e=0;for(f=f.layers;e<f.length;){h=f[e];++e;h=h.keyframes;m=h.length;for(l=0;l<m;){var i=l++,
g=h[i];if(null!=g.symbolName){var j=this._symbols.get(g.symbolName);g.symbol=j}if(g.tweened&&1==g.duration&&i+1<m&&(i=h[i+1],!i.visible||null==i.symbolName))g.visible=!1}}}};lf.__name__=!0;lf.prototype={createSprite:function(a,b){null==b&&(b=!0);var c=this._symbols.get(a);if(null==c){if(b)throw new j(na.withFields("Missing symbol",["name",a]));return null}return c.createSprite()},__class__:lf};var rd=function(a){this._oneshotSprite=this._loopingSprite=null;H.call(this);this._lib=a;this._root=new ob;
this.movie=new Ia(null);this.setCache(!0)};rd.__name__=!0;rd.__super__=H;rd.prototype=r(H.prototype,{get_name:function(){return"MoviePlayer_0"},setCache:function(a){this._cache=a?new bc:null;return this},loop:function(a,b){null==b&&(b=!0);if(b||null==this._loopingSprite||this._loopingSprite.symbol._name!=a)this._oneshotSprite=null,this._loopingSprite=this.playFromCache(a);return this},onAdded:function(){this.owner.addChild(this._root)},onRemoved:function(){this._root.dispose();this._oneshotSprite=
this._loopingSprite=null;this.movie.set__(null)},onUpdate:function(a){null!=this._oneshotSprite&&this._oneshotSprite._position+a>this._oneshotSprite.symbol.duration&&(this._oneshotSprite=null,this.setCurrent(this._loopingSprite))},playFromCache:function(a){var b;null!=this._cache?(b=this._cache.get(a),null!=b?b.set_position(0):(b=this.createMovie(a),this._cache.set(a,b))):b=this.createMovie(a);return this.setCurrent(b)},createMovie:function(a){a=this._lib.createSprite(a,!0);null!=this._decorator&&
this._decorator(a);return a},setCurrent:function(a){this._root.add(a);return this.movie.set__(a)},__class__:rd});var sd=function(a){this._looped=null;B.call(this);this.symbol=a;this.speed=new ia(1);this._animators=Array(a.layers.length);for(var b=0,c=this._animators.length;b<c;){var d=b++;this._animators[d]=new mf(a.layers[d])}this._position=this._frame=0;this["goto"](1)};sd.__name__=!0;sd.__super__=B;sd.prototype=r(B.prototype,{getLayer:function(a,b){null==b&&(b=!0);for(var c=0,d=this._animators;c<
d.length;){var e=d[c];++c;if(e.layer.name==a)return e.content}if(b)throw new j(na.withFields("Missing layer",["name",a]));return null},onAdded:function(){B.prototype.onAdded.call(this);for(var a=0,b=this._animators;a<b.length;){var c=b[a];++a;this.owner.addChild(c.content)}},onRemoved:function(){B.prototype.onRemoved.call(this);for(var a=0,b=this._animators;a<b.length;){var c=b[a];++a;this.owner.removeChild(c.content)}},onUpdate:function(a){B.prototype.onUpdate.call(this,a);this.speed.update(a);switch(this._flags&
768){case 0:this._position+=this.speed._value*a;this._position>this.symbol.duration&&(this._position%=this.symbol.duration,null!=this._looped&&this._looped.emit());break;case 512:this._flags&=-513}this["goto"](this._position*this.symbol.frameRate)},"goto":function(a){if(this._frame!=a){if(a<this._frame)for(var b=0,c=this._animators;b<c.length;){var d=c[b];++b;d.needsKeyframeUpdate=!0;d.keyframeIdx=0}b=0;for(c=this._animators;b<c.length;)d=c[b],++b,d.composeFrame(a);this._frame=a}},set_position:function(a){return this._position=
Rb.clamp(a,0,this.symbol.duration)},set_pixelSnapping:function(a){for(var b=0,c=this._animators;b<c.length;){var d=c[b];++b;d.setPixelSnapping(a)}return B.prototype.set_pixelSnapping.call(this,a)},rewind:function(){this._position=0;this._flags|=512},__class__:sd});var mf=function(a){this.keyframeIdx=0;this.needsKeyframeUpdate=!1;this.layer=a;this.content=new ob;if(a.empty)this._sprites=null;else{this._sprites=Array(a.keyframes.length);for(var b=0,c=this._sprites.length;b<c;){var d=b++,e=a.keyframes[d];
this._sprites[d]=0<d&&a.keyframes[d-1].symbol==e.symbol?this._sprites[d-1]:null==e.symbol?new B:e.symbol.createSprite()}this.content.add(this._sprites[0])}};mf.__name__=!0;mf.prototype={composeFrame:function(a){if(null!=this._sprites){var b=this.layer.keyframes,c=b.length-1;if(a>this.layer.frames)this.content._compMap.Sprite_1.set_visible(!1),this.keyframeIdx=c,this.needsKeyframeUpdate=!0;else{for(;this.keyframeIdx<c&&b[this.keyframeIdx+1].index<=a;)++this.keyframeIdx,this.needsKeyframeUpdate=!0;
var d;this.needsKeyframeUpdate?(this.needsKeyframeUpdate=!1,d=this._sprites[this.keyframeIdx],d!=this.content._compMap.Sprite_1&&((null==d?null:u.getClass(d))==sd&&d.rewind(),this.content.add(d))):d=this.content._compMap.Sprite_1;var e=b[this.keyframeIdx],f=e.visible&&null!=e.symbol;d.set_visible(f);if(f){var f=e.x,h=e.y,m=e.scaleX,l=e.scaleY,i=e.skewX,g=e.skewY,j=e.alpha;if(e.tweened&&this.keyframeIdx<c){a=(a-e.index)/e.duration;c=e.ease;if(0!=c){var k;0>c?(k=1-a,k=1-k*k,c=-c):k=a*a;a=c*k+(1-c)*
a}b=b[this.keyframeIdx+1];f+=(b.x-f)*a;h+=(b.y-h)*a;m+=(b.scaleX-m)*a;l+=(b.scaleY-l)*a;i+=(b.skewX-i)*a;g+=(b.skewY-g)*a;j+=(b.alpha-j)*a}b=d.getLocalMatrix();a=0;c=1;k=0;var n=1;0!=i&&(a=Math.sin(i),c=Math.cos(i));0!=g&&(k=Math.sin(g),n=Math.cos(g));b.set(n*m,k*m,-a*l,c*l,f,h);b.translate(-e.pivotX,-e.pivotY);d.alpha.set__(j)}}}},setPixelSnapping:function(a){if(null!=this._sprites)for(var b=0,c=this._sprites;b<c.length;){var d=c[b];++b;d.set_pixelSnapping(a)}},__class__:mf};var fe=function(a,b){this._name=
b.id;this.frameRate=a.frameRate;this.frames=0;this.layers=Array(b.layers.length);for(var c=0,d=this.layers.length;c<d;){var e=c++,f=new nf(b.layers[e]);this.frames=Math.max(f.frames,this.frames);this.layers[e]=f}this.duration=this.frames/this.frameRate};fe.__name__=!0;fe.__interfaces__=[ee];fe.prototype={createSprite:function(){return new sd(this)},__class__:fe};var nf=function(a){this.empty=!0;this.name=a.name;var b=null;this.keyframes=Array(a.keyframes.length);for(var c=0,d=this.keyframes.length;c<
d;){var e=c++,b=new of(a.keyframes[e],b);this.keyframes[e]=b;this.empty=this.empty&&null==b.symbolName}this.frames=null!=b?b.index+b.duration:0};nf.__name__=!0;nf.prototype={__class__:nf};var of=function(a,b){this.ease=0;this.visible=this.tweened=!0;this.alpha=1;this.skewX=this.skewY=this.pivotX=this.pivotY=0;this.scaleX=this.scaleY=1;this.x=this.y=0;this.symbol=null;this.index=null!=b?b.index+b.duration:0;this.duration=a.duration;this.label=a.label;this.symbolName=a.ref;var c=a.loc;null!=c&&(this.x=
c[0],this.y=c[1]);c=a.scale;null!=c&&(this.scaleX=c[0],this.scaleY=c[1]);c=a.skew;null!=c&&(this.skewX=c[0],this.skewY=c[1]);c=a.pivot;null!=c&&(this.pivotX=c[0],this.pivotY=c[1]);null!=a.alpha&&(this.alpha=a.alpha);null!=a.visible&&(this.visible=a.visible);null!=a.tweened&&(this.tweened=a.tweened);null!=a.ease&&(this.ease=a.ease)};of.__name__=!0;of.prototype={__class__:of};var bg=function(){};bg.__name__=!0;bg.that=function(){};var Se=function(){};Se.__name__=!0;Se.set=function(a,b,c){return c?a|
b:a&~b};var Vc=function(){this.success=new Q;this.error=new Q;this.progressChanged=new ld;this.hasResult=!1;this._total=this._progress=0};Vc.__name__=!0;Vc.prototype={set_result:function(a){if(this.hasResult)throw new j("Promise result already assigned");this._result=a;this.hasResult=!0;this.success.emit(a);return a},get:function(a){return this.hasResult?(a(this._result),null):this.success.connect(a).once()},set_progress:function(a){this._progress!=a&&(this._progress=a,this.progressChanged.emit());
return a},set_total:function(a){this._total!=a&&(this._total=a,this.progressChanged.emit());return a},__class__:Vc};var ld=function(a){U.call(this,a)};ld.__name__=!0;ld.__super__=U;ld.prototype=r(U.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(){var a=this;this._head==U.DISPATCHING_SENTINEL?this.defer(function(){a.emitImpl()}):this.emitImpl()},emitImpl:function(){for(var a=this.willEmit(),b=a;null!=b;)b._listener(),b.stayInList||b.dispose(),b=b._next;
this.didEmit(a)},__class__:ld});var Oe=function(a){this.next=null;this.fn=a};Oe.__name__=!0;Oe.prototype={__class__:Oe};var na=function(){};na.__name__=!0;na.getFileExtension=function(a){var b=a.lastIndexOf(".");return 0<b?Ha.substr(a,b+1,null):null};na.removeFileExtension=function(a){var b=a.lastIndexOf(".");return 0<b?Ha.substr(a,0,b):a};na.getUrlExtension=function(a){var b=a.lastIndexOf("?");0<=b&&(a=Ha.substr(a,0,b));b=a.lastIndexOf("/");0<=b&&(a=Ha.substr(a,b+1,null));return na.getFileExtension(a)};
na.joinPath=function(a,b){0<a.length&&47!=a.charCodeAt(a.length-1)&&(a+="/");return a+b};na.withFields=function(a,b){var c=b.length;if(0<c){for(var a=0<a.length?a+" [":a+"[",d=0;d<c;){0<d&&(a+=", ");var e=b[d],f=b[d+1];if($.is(f,Error)){var h=f.stack;null!=h&&(f=h)}a+=e+"="+$.string(f);d+=2}a+="]"}return a};var eg=function(){};eg.__name__=!0;var Xc=function(){this.h={}};Xc.__name__=!0;Xc.__interfaces__=[eg];Xc.prototype={remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},
__class__:Xc};var $d=function(a,b){this.map=a;this.keys=b;this.index=0;this.count=b.length};$d.__name__=!0;$d.prototype={hasNext:function(){return this.index<this.count},next:function(){return this.map.get(this.keys[this.index++])},__class__:$d};var bc=function(){this.h={}};bc.__name__=!0;bc.__interfaces__=[eg];bc.prototype={set:function(a,b){null!=jg[a]?this.setReserved(a,b):this.h[a]=b},get:function(a){return null!=jg[a]?this.getReserved(a):this.h[a]},setReserved:function(a,b){null==this.rh&&(this.rh=
{});this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},arrayKeys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b);if(null!=this.rh)for(b in this.rh)36==b.charCodeAt(0)&&a.push(b.substr(1));return a},iterator:function(){return new $d(this,this.arrayKeys())},__class__:bc};var od=function(a){this.length=a.byteLength;this.b=new hf(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b};od.__name__=!0;od.ofData=function(a){var b=a.hxBytes;return null!=
b?b:new od(a)};od.prototype={__class__:od};var Cd=function(){};Cd.__name__=!0;Cd.getType=function(a){a=Cd.getMeta(a);return null==a||null==a.obj?{}:a.obj};Cd.getMeta=function(a){return a.__meta__};var j=function(a){Error.call(this);this.val=a;this.message=""+a;Error.captureStackTrace&&Error.captureStackTrace(this,j)};j.__name__=!0;j.__super__=Error;j.prototype=r(Error.prototype,{__class__:j});var u=function(){};u.__name__=!0;u.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;
var b=a.__class__;if(null!=b)return b;a=u.__nativeClassName(a);return null!=a?u.__resolveNativeClass(a):null};u.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;if("function"==c&&(a.__name__||a.__ename__))c="object";switch(c){case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];for(var c=a[0]+"(",b=b+"\t",d=2,e=a.length;d<e;)var f=d++,c=2!=f?c+(","+u.__string_rec(a[f],b)):c+u.__string_rec(a[f],b);return c+")"}c=a.length;d="[";
b+="\t";for(e=0;e<c;)f=e++,d+=(0<f?",":"")+u.__string_rec(a[f],b);return d+"]"}try{d=a.toString}catch(h){return h instanceof j&&(h=h.val),"???"}if(null!=d&&d!=Object.toString&&"function"==typeof d&&(c=a.toString(),"[object Object]"!=c))return c;c=null;d="{\n";b+="\t";e=null!=a.hasOwnProperty;for(c in a)if(!e||a.hasOwnProperty(c))"prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+u.__string_rec(a[c],b));b=b.substring(1);
return d+("\n"+b+"}");case "function":return"<function>";case "string":return a;default:return""+a}};u.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,f=c[f];if(f==b||u.__interfLoop(f,b))return!0}return u.__interfLoop(a.__super__,b)};u.__instanceof=function(a,b){if(null==b)return!1;switch(b){case qg:return(a|0)===a;case kg:return"number"==typeof a;case lg:return"boolean"==typeof a;case String:return"string"==
typeof a;case Array:return a instanceof Array&&null==a.__enum__;case rg:return!0;default:if(null!=a)if("function"==typeof b){if(a instanceof b||u.__interfLoop(u.getClass(a),b))return!0}else{if("object"==typeof b&&u.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==sg&&null!=a.__name__||b==tg&&null!=a.__ename__?!0:a.__enum__==b}};u.__nativeClassName=function(a){a=u.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};u.__isNativeObj=function(a){return null!=
u.__nativeClassName(a)};u.__resolveNativeClass=function(a){return Function("return typeof "+a+' != "undefined" ? '+a+" : null")()};var ag=function(){};ag.__name__=!0;ag.getContextWebGL=function(a,b){for(var c=0,d=["webgl","experimental-webgl"];c<d.length;){var e=d[c];++c;e=a.getContext(e,b);if(null!=e)return e}return null};var cb=function(a){if(a instanceof Array&&null==a.__enum__)this.a=a,this.byteLength=a.length;else{this.a=[];for(var b=0;b<a;)this.a[b++]=0;this.byteLength=a}};cb.__name__=!0;cb.sliceImpl=
function(a,b){var c=new hf(this,a,null==b?null:b-a),d=new fg(c.byteLength);(new hf(d)).set(c);return d};cb.prototype={slice:function(a,b){return new cb(this.a.slice(a,b))},__class__:cb};var pc=function(){};pc.__name__=!0;pc._new=function(a,b,c){if("number"==typeof a){c=[];for(b=0;b<a;){var d=b++;c[d]=0}c.byteLength=c.length;c.byteOffset=0;c.buffer=new cb(c)}else if(u.__instanceof(a,cb))null==b&&(b=0),null==c&&(c=a.byteLength-b),c=0==b?a.a:a.a.slice(b,b+c),c.byteLength=c.length,c.byteOffset=b,c.buffer=
a;else if(a instanceof Array&&null==a.__enum__)c=a.slice(),c.byteLength=c.length,c.byteOffset=0,c.buffer=new cb(c);else throw new j("TODO "+$.string(a));c.subarray=pc._subarray;c.set=pc._set;return c};pc._set=function(a,b){if(u.__instanceof(a.buffer,cb)){if(a.byteLength+b>this.byteLength)throw new j("set() outside of range");for(var c=0,d=a.byteLength;c<d;){var e=c++;this[e+b]=a[e]}}else if(a instanceof Array&&null==a.__enum__){if(a.length+b>this.byteLength)throw new j("set() outside of range");c=
0;for(d=a.length;c<d;)e=c++,this[e+b]=a[e]}else throw new j("TODO");};pc._subarray=function(a,b){var c=pc._new(this.slice(a,b));c.byteOffset=a;return c};var k=function(){};k.__name__=!0;var Va=function(){this.zpp_inner=null;if(!N.internal)throw new j("Error: Callback cannot be instantiated derp!");};Va.__name__=!0;Va.prototype={toString:function(){return""},__class__:Va};var $c=function(){Va.call(this)};$c.__name__=!0;$c.__super__=Va;$c.prototype=r(Va.prototype,{toString:function(){var a;a="Cb:"+
["WAKE","SLEEP"][this.zpp_inner.event-i.id_CbEvent_WAKE];a+=":"+this.zpp_inner.body.outer.toString();return a+=" : listener: "+$.string(this.zpp_inner.listener.outer)},__class__:$c});var cc=function(){this.zpp_inner=null};cc.__name__=!0;cc.prototype={toString:function(){var a="BEGIN,END,WAKE,SLEEP,BREAK,PRE,ONGOING".split(",")[this.zpp_inner.event];if(this.zpp_inner.type==i.id_ListenerType_BODY)return"BodyListener{"+a+"::"+$.string(this.zpp_inner.body.outer_zn.zpp_inner_zn.options.outer)+"}";if(this.zpp_inner.type==
i.id_ListenerType_CONSTRAINT)return"ConstraintListener{"+a+"::"+$.string(this.zpp_inner.constraint.outer_zn.zpp_inner_zn.options.outer)+"}";var b=this.zpp_inner.interaction,c;switch(b.itype){case 1:c="COLLISION";break;case 2:c="SENSOR";break;case 4:c="FLUID";break;default:c="ALL"}return(this.zpp_inner.type==i.id_ListenerType_INTERACTION?"InteractionListener{"+a+"#"+c+"::"+$.string(b.outer_zni.zpp_inner_zn.options1.outer)+":"+$.string(b.outer_zni.zpp_inner_zn.options2.outer)+"}":"PreListener{"+c+"::"+
$.string(b.outer_znp.zpp_inner_zn.options1.outer)+":"+$.string(b.outer_znp.zpp_inner_zn.options2.outer)+"}")+" precedence="+this.zpp_inner.precedence},__class__:cc};var pf=function(){this.zpp_inner_zn=null};pf.__name__=!0;pf.__super__=cc;pf.prototype=r(cc.prototype,{__class__:pf});var Gc=function(){this.zpp_inner=null;this.zpp_inner=new ya;this.zpp_inner.outer=this};Gc.__name__=!0;Gc.prototype={toString:function(){return this==ya.ANY_BODY?"ANY_BODY":this==ya.ANY_SHAPE?"ANY_SHAPE":this==ya.ANY_COMPOUND?
"ANY_COMPOUND":this==ya.ANY_CONSTRAINT?"ANY_CONSTRAINT":"CbType#"+this.zpp_inner.id},__class__:Gc};var ge=function(){Va.call(this)};ge.__name__=!0;ge.__super__=Va;ge.prototype=r(Va.prototype,{toString:function(){var a;a="Cb:"+["WAKE","SLEEP","BREAK"][this.zpp_inner.event-i.id_CbEvent_WAKE];a+=":"+this.zpp_inner.constraint.outer.toString();return a+=" : listener: "+$.string(this.zpp_inner.listener.outer)},__class__:ge});var qf=function(){this.zpp_inner_zn=null};qf.__name__=!0;qf.__super__=cc;qf.prototype=
r(cc.prototype,{__class__:qf});var td=function(){Va.call(this)};td.__name__=!0;td.__super__=Va;td.prototype=r(Va.prototype,{toString:function(){var a;a="Cb:"+"BEGIN,END,,,,,ONGOING".split(",")[this.zpp_inner.event];a+=":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString();a+=" : "+this.zpp_inner.wrap_arbiters.toString();return a+=" : listener: "+$.string(this.zpp_inner.listener.outer)},__class__:td});var rf=function(){this.zpp_inner_zn=null};rf.__name__=!0;rf.__super__=
cc;rf.prototype=r(cc.prototype,{__class__:rf});var qc=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!Sb.internal)throw new j("Error: Cannot instantiate ListenerIterator derp!");};qc.__name__=!0;qc.get=function(a){var b;null==qc.zpp_pool?(Sb.internal=!0,b=new qc,Sb.internal=!1):(b=qc.zpp_pool,qc.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};qc.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();
this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=qc.zpp_pool;qc.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:qc};var sf=function(){this.zpp_inner=null;this.zpp_inner=new Sb;this.zpp_inner.outer=this};sf.__name__=!0;sf.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},
at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new j("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},remove:function(a){if(this.zpp_inner.immutable)throw new j("Error: ListenerList is immutable");
this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=qc.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();
b=!1}return a+"]"},__class__:sf};var ad=function(){Va.call(this)};ad.__name__=!0;ad.__super__=Va;ad.prototype=r(Va.prototype,{toString:function(){var a;a="Cb:PRE:"+(":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString());a+=" : "+this.zpp_inner.pre_arbiter.wrapper().toString();return a+=" : listnener: "+$.string(this.zpp_inner.listener.outer)},__class__:ad});var Ja=function(){if(!i.internal)throw new j("Error: Cannot instantiate PreFlag derp!");};Ja.__name__=!0;Ja.prototype=
{toString:function(){var a;null==i.PreFlag_ACCEPT&&(i.internal=!0,i.PreFlag_ACCEPT=new Ja,i.internal=!1);this==i.PreFlag_ACCEPT?a="ACCEPT":(null==i.PreFlag_IGNORE&&(i.internal=!0,i.PreFlag_IGNORE=new Ja,i.internal=!1),this==i.PreFlag_IGNORE?a="IGNORE":(null==i.PreFlag_ACCEPT_ONCE&&(i.internal=!0,i.PreFlag_ACCEPT_ONCE=new Ja,i.internal=!1),this==i.PreFlag_ACCEPT_ONCE?a="ACCEPT_ONCE":(null==i.PreFlag_IGNORE_ONCE&&(i.internal=!0,i.PreFlag_IGNORE_ONCE=new Ja,i.internal=!1),a=this==i.PreFlag_IGNORE_ONCE?
"IGNORE_ONCE":"")));return a},__class__:Ja};var tf=function(){this.zpp_inner_zn=null};tf.__name__=!0;tf.__super__=cc;tf.prototype=r(cc.prototype,{__class__:tf});var fa=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!dc.internal)throw new j("Error: Cannot instantiate ConstraintIterator derp!");};fa.__name__=!0;fa.get=function(a){var b;null==fa.zpp_pool?(dc.internal=!0,b=new fa,dc.internal=!1):(b=fa.zpp_pool,fa.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=
!1;return b};fa.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=fa.zpp_pool;fa.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:fa};var uf=function(){this.zpp_inner=null;this.zpp_inner=new dc;this.zpp_inner.outer=this};uf.__name__=!0;uf.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&
(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new j("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=
this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},remove:function(a){if(this.zpp_inner.immutable)throw new j("Error: ConstraintList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},toString:function(){var a=
"[",b=!0,c;this.zpp_inner.valmod();for(c=fa.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:uf};var Tb=function(){this.zpp_inner=null;if(!D.internal)throw new j("Error: Cannot instantiate Arbiter derp!");};Tb.__name__=!0;Tb.prototype={get_state:function(){if(!this.zpp_inner.active)throw new j("Error: Arbiter not currently in use");var a=this.zpp_inner.immState;if(a==(i.id_ImmState_ACCEPT|i.id_ImmState_ALWAYS))return null==
i.PreFlag_ACCEPT&&(i.internal=!0,i.PreFlag_ACCEPT=new Ja,i.internal=!1),i.PreFlag_ACCEPT;switch(a){case 1:return null==i.PreFlag_ACCEPT_ONCE&&(i.internal=!0,i.PreFlag_ACCEPT_ONCE=new Ja,i.internal=!1),i.PreFlag_ACCEPT_ONCE;default:if(a==(i.id_ImmState_IGNORE|i.id_ImmState_ALWAYS))return null==i.PreFlag_IGNORE&&(i.internal=!0,i.PreFlag_IGNORE=new Ja,i.internal=!1),i.PreFlag_IGNORE;null==i.PreFlag_IGNORE_ONCE&&(i.internal=!0,i.PreFlag_IGNORE_ONCE=new Ja,i.internal=!1);return i.PreFlag_IGNORE_ONCE}},
toString:function(){var a;a=this.zpp_inner.type==D.COL?"CollisionArbiter":this.zpp_inner.type==D.FLUID?"FluidArbiter":"SensorArbiter";if(this.zpp_inner.cleared)a+="(object-pooled)";else{a+="(";if(!this.zpp_inner.active)throw new j("Error: Arbiter not currently in use");a=a+(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer).toString()+"|";if(!this.zpp_inner.active)throw new j("Error: Arbiter not currently in use");a=a+(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?
this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer).toString()+")"+(this.zpp_inner.type==D.COL?"["+["SD","DD"][this.zpp_inner.colarb.stat?0:1]+"]":"")+"<-"+this.get_state().toString()}return a},__class__:Tb};var la=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!Ub.internal)throw new j("Error: Cannot instantiate ArbiterIterator derp!");};la.__name__=!0;la.get=function(a){var b;null==la.zpp_pool?(Ub.internal=!0,b=new la,Ub.internal=!1):(b=la.zpp_pool,la.zpp_pool=
b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};la.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.zpp_gl();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=la.zpp_pool;la.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:la};var vf=function(){this.zpp_inner=null;this.zpp_inner=new Ub;this.zpp_inner.outer=this};vf.__name__=!0;vf.prototype={zpp_gl:function(){this.zpp_inner.valmod();
if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1;this.zpp_inner.user_length=0;for(var a=this.zpp_inner.inner.head;null!=a;)a.elt.active&&this.zpp_inner.user_length++,a=a.next}return this.zpp_inner.user_length},zpp_vm:function(){this.zpp_inner.valmod()},at:function(a){this.zpp_vm();if(0>a||a>=this.zpp_gl())throw new j("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.zpp_gl()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite){this.zpp_inner.at_index=0;for(this.zpp_inner.at_ite=
this.zpp_inner.inner.head;!this.zpp_inner.at_ite.elt.active;)this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}for(;this.zpp_inner.at_index!=a;){this.zpp_inner.at_index++;for(this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;!this.zpp_inner.at_ite.elt.active;)this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}return this.zpp_inner.at_ite.elt.wrapper()},iterator:function(){this.zpp_vm();return la.get(this)},toString:function(){for(var a="[",b=!0,c=this.iterator();c.hasNext();){var d;c.zpp_critical=!1;
d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:vf};var he=function(){if(!D.internal)throw new j("Error: Cannot instantiate CollisionArbiter derp!");Tb.call(this)};he.__name__=!0;he.__super__=Tb;he.prototype=r(Tb.prototype,{__class__:he});var wf=function(){this.zpp_inner=null;if(!Y.internal)throw new j("Error: Cannot instantiate Contact derp!");};wf.__name__=!0;wf.prototype={toString:function(){return null==this.zpp_inner.arbiter||this.zpp_inner.arbiter.cleared?
"{object-pooled}":"{Contact}"},__class__:wf};var ie=function(){if(!D.internal)throw new j("Error: Cannot instantiate FluidArbiter derp!");Tb.call(this)};ie.__name__=!0;ie.__super__=Tb;ie.prototype=r(Tb.prototype,{__class__:ie});var xf=function(a,b,c,d,e,f){null==f&&(f=-1);null==e&&(e=1);null==d&&(d=-1);null==c&&(c=1);null==b&&(b=-1);null==a&&(a=1);this.zpp_inner=null;null==Cb.zpp_pool?this.zpp_inner=new Cb:(this.zpp_inner=Cb.zpp_pool,Cb.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null);null;
this.zpp_inner.outer=this;this.zpp_inner.collisionGroup!=a&&(this.zpp_inner.collisionGroup=a,this.zpp_inner.invalidate());this.zpp_inner.collisionGroup;this.zpp_inner.collisionMask!=b&&(this.zpp_inner.collisionMask=b,this.zpp_inner.invalidate());this.zpp_inner.collisionMask;this.zpp_inner.sensorGroup!=c&&(this.zpp_inner.sensorGroup=c,this.zpp_inner.invalidate());this.zpp_inner.sensorGroup;this.zpp_inner.sensorMask!=d&&(this.zpp_inner.sensorMask=d,this.zpp_inner.invalidate());this.zpp_inner.sensorMask;
this.zpp_inner.fluidGroup!=e&&(this.zpp_inner.fluidGroup=e,this.zpp_inner.invalidate());this.zpp_inner.fluidGroup;this.zpp_inner.fluidMask!=f&&(this.zpp_inner.fluidMask=f,this.zpp_inner.invalidate());this.zpp_inner.fluidMask};xf.__name__=!0;xf.prototype={__class__:xf};var Qb=function(a){this.zpp_pool=this.zpp_inner=null;this.zpp_inner=new yf(this);if(null!=a){if(a instanceof Array&&null==a.__enum__)for(var b=0;b<a.length;){var c=a[b];++b;if(null==c)throw new j("Error: Array<Vec2> contains null objects");
if(!u.__instanceof(c,K))throw new j("Error: Array<Vec2> contains non Vec2 objects");var d=c;if(null!=d&&d.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");c=V.get(function(){if(null!=d&&d.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");d.zpp_inner.validate();return d.zpp_inner.x}(this),function(){if(null!=d&&d.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");d.zpp_inner.validate();return d.zpp_inner.y}(this));null==this.zpp_inner.vertices?
this.zpp_inner.vertices=c.prev=c.next=c:(c.prev=this.zpp_inner.vertices,c.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=c,this.zpp_inner.vertices.next=c);this.zpp_inner.vertices=c}else if(u.__instanceof(a,Wa))for(b=a.iterator();b.hasNext();){var e;b.zpp_critical=!1;e=b.zpp_inner.at(b.zpp_i++);if(null==e)throw new j("Error: Vec2List contains null objects");if(null!=e&&e.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");c=V.get(function(){if(null!=e&&e.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");
e.zpp_inner.validate();return e.zpp_inner.x}(this),function(){if(null!=e&&e.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");e.zpp_inner.validate();return e.zpp_inner.y}(this));null==this.zpp_inner.vertices?this.zpp_inner.vertices=c.prev=c.next=c:(c.prev=this.zpp_inner.vertices,c.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=c,this.zpp_inner.vertices.next=c);this.zpp_inner.vertices=c}else if(u.__instanceof(a,Qb)){if(null!=a&&a.zpp_disp)throw new j("Error: GeomPoly has been disposed and cannot be used!");
b=a.zpp_inner.vertices;if(null!=b){c=b;do{var f=K.get(c.x,c.y,null),c=c.next,h=V.get(function(){if(null!=f&&f.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");f.zpp_inner.validate();return f.zpp_inner.x}(this),function(){if(null!=f&&f.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");f.zpp_inner.validate();return f.zpp_inner.y}(this));null==this.zpp_inner.vertices?this.zpp_inner.vertices=h.prev=h.next=h:(h.prev=this.zpp_inner.vertices,h.next=this.zpp_inner.vertices.next,
this.zpp_inner.vertices.next.prev=h,this.zpp_inner.vertices.next=h);this.zpp_inner.vertices=h;f.dispose()}while(c!=b)}}else throw new j("Error: Invalid type for polygon object, should be Array<Vec2>, Vec2List, GeomPoly or for flash10+ flash.Vector<Vec2>");this.skipForward(1);if(a instanceof Array&&null==a.__enum__)for(b=0;b<a.length;){c=a[b];if(h=c.zpp_inner.weak)c.dispose(),h=!0;h?a.splice(b,1):b++}else if(u.__instanceof(a,Wa)){null!=a.zpp_inner._validate&&a.zpp_inner._validate();a=a.zpp_inner.inner;
b=null;for(c=a.head;null!=c;)h=c.elt,h.outer.zpp_inner.weak?(c=a.erase(b),h.outer.zpp_inner.weak?(h.outer.dispose(),!0):!1):(b=c,c=c.next)}}};Qb.__name__=!0;Qb.get=function(a){var b;null==oa.poolGeomPoly?b=new Qb:(b=oa.poolGeomPoly,oa.poolGeomPoly=b.zpp_pool,b.zpp_pool=null,b.zpp_disp=!1,b==oa.nextGeomPoly&&(oa.nextGeomPoly=null));if(null!=a){if(a instanceof Array&&null==a.__enum__)for(var c=0;c<a.length;){var d=a[c];++c;if(null==d)throw new j("Error: Array<Vec2> contains null objects");if(!u.__instanceof(d,
K))throw new j("Error: Array<Vec2> contains non Vec2 objects");var e=d;if(null!=e&&e.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");d=V.get(function(){if(null!=e&&e.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");e.zpp_inner.validate();return e.zpp_inner.x}(this),function(){if(null!=e&&e.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");e.zpp_inner.validate();return e.zpp_inner.y}(this));null==b.zpp_inner.vertices?b.zpp_inner.vertices=
d.prev=d.next=d:(d.prev=b.zpp_inner.vertices,d.next=b.zpp_inner.vertices.next,b.zpp_inner.vertices.next.prev=d,b.zpp_inner.vertices.next=d);b.zpp_inner.vertices=d}else if(u.__instanceof(a,Wa))for(c=a.iterator();c.hasNext();){var f;c.zpp_critical=!1;f=c.zpp_inner.at(c.zpp_i++);if(null==f)throw new j("Error: Vec2List contains null objects");if(null!=f&&f.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");d=V.get(function(){if(null!=f&&f.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");
f.zpp_inner.validate();return f.zpp_inner.x}(this),function(){if(null!=f&&f.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");f.zpp_inner.validate();return f.zpp_inner.y}(this));null==b.zpp_inner.vertices?b.zpp_inner.vertices=d.prev=d.next=d:(d.prev=b.zpp_inner.vertices,d.next=b.zpp_inner.vertices.next,b.zpp_inner.vertices.next.prev=d,b.zpp_inner.vertices.next=d);b.zpp_inner.vertices=d}else if(u.__instanceof(a,Qb)){if(null!=a&&a.zpp_disp)throw new j("Error: GeomPoly has been disposed and cannot be used!");
c=a.zpp_inner.vertices;if(null!=c){d=c;do{var h=K.get(d.x,d.y,null),d=d.next,m=V.get(function(){if(null!=h&&h.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();return h.zpp_inner.x}(this),function(){if(null!=h&&h.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();return h.zpp_inner.y}(this));null==b.zpp_inner.vertices?b.zpp_inner.vertices=m.prev=m.next=m:(m.prev=b.zpp_inner.vertices,m.next=b.zpp_inner.vertices.next,
b.zpp_inner.vertices.next.prev=m,b.zpp_inner.vertices.next=m);b.zpp_inner.vertices=m;h.dispose()}while(d!=c)}}else throw new j("Error: Invalid type for polygon object, should be Array<Vec2>, Vec2List, GeomPoly or for flash10+ flash.Vector<Vec2>");b.skipForward(1);if(a instanceof Array&&null==a.__enum__)for(c=0;c<a.length;){d=a[c];if(m=d.zpp_inner.weak)d.dispose(),m=!0;m?a.splice(c,1):c++}else if(u.__instanceof(a,Wa)){null!=a.zpp_inner._validate&&a.zpp_inner._validate();a=a.zpp_inner.inner;c=null;
for(d=a.head;null!=d;)m=d.elt,m.outer.zpp_inner.weak?(d=a.erase(c),m.outer.zpp_inner.weak?(m.outer.dispose(),!0):!1):(c=d,d=d.next)}}return b};Qb.prototype={skipForward:function(a){if(this.zpp_disp)throw new j("Error: GeomPoly has been disposed and cannot be used!");if(null!=this.zpp_inner.vertices)if(0<a)for(;0<a--;)this.zpp_inner.vertices=this.zpp_inner.vertices.next;else if(0>a)for(;0>a++;)this.zpp_inner.vertices=this.zpp_inner.vertices.prev;return this},copy:function(){if(this.zpp_disp)throw new j("Error: GeomPoly has been disposed and cannot be used!");
var a=Qb.get(),b=this.zpp_inner.vertices,c=this.zpp_inner.vertices;if(null!=b){do{var d=b,d=V.get(d.x,d.y);null==a.zpp_inner.vertices?a.zpp_inner.vertices=d.prev=d.next=d:(d.prev=a.zpp_inner.vertices,d.next=a.zpp_inner.vertices.next,a.zpp_inner.vertices.next.prev=d,a.zpp_inner.vertices.next=d);a.zpp_inner.vertices=d;b=b.next}while(b!=c)}return a.skipForward(1)},toString:function(){var a="GeomPoly[",b=this.zpp_inner.vertices,c=this.zpp_inner.vertices;if(null!=b){do{var d=b;d!=this.zpp_inner.vertices&&
(a+=",");a+="{"+d.x+","+d.y+"}";b=b.next}while(b!=c)}return a+"]"},simplify:function(a){if(this.zpp_disp)throw new j("Error: GeomPoly has been disposed and cannot be used!");if(0>=a)throw new j("Error: Epsilon should be > 0 for simplifying a GeomPoly");if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return this.copy();var a=za.simplify(this.zpp_inner.vertices,a),b=Qb.get();b.zpp_inner.vertices=a;return b},convexDecomposition:function(a,
b){null==a&&(a=!1);if(this.zpp_disp)throw new j("Error: GeomPoly has been disposed and cannot be used!");if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)throw new j("Error: Cannot decompose a degenerate polygon");var c=z.decompose(this.zpp_inner.vertices,function(){null==z.sharedPPoly&&(z.sharedPPoly=new T);return z.sharedPPoly}(this)).extract_partitions(function(){null==T.sharedPPList&&(T.sharedPPList=new je);return T.sharedPPList}(this)),
d;for(d=null==b?new zf:b;null!=c.head;){var e=c.pop_unsafe();F.triangulate(e);a&&F.optimise(e);rc.optimise(e);var f=e.extract(function(){null==T.sharedGVList&&(T.sharedGVList=new ve);return T.sharedGVList}(this));e.next=T.zpp_pool;for(T.zpp_pool=e;null!=f.head;){var e=f.pop_unsafe(),h=Qb.get();h.zpp_inner.vertices=e;d.zpp_inner.reverse_flag?d.push(h):d.unshift(h)}}return d},__class__:Qb};var ua=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!bd.internal)throw new j("Error: Cannot instantiate GeomPolyIterator derp!");
};ua.__name__=!0;ua.get=function(a){var b;null==ua.zpp_pool?(bd.internal=!0,b=new ua,bd.internal=!1):(b=ua.zpp_pool,ua.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};ua.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=ua.zpp_pool;ua.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:ua};
var zf=function(){this.zpp_inner=null;this.zpp_inner=new bd;this.zpp_inner.outer=this};zf.__name__=!0;zf.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new j("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||
null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){if(this.zpp_inner.immutable)throw new j("Error: GeomPolyList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?
this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){if(this.zpp_inner.immutable)throw new j("Error: GeomPolyList is immutable");this.zpp_inner.modify_test();
this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},toString:function(){var a=
"[",b=!0,c;this.zpp_inner.valmod();for(c=ua.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:zf};var K=function(a,b){null==b&&(b=0);null==a&&(a=0);this.zpp_inner=this.zpp_pool=null;if(a!=a||b!=b)throw new j("Error: Vec2 components cannot be NaN");this.zpp_inner=G.get(a,b,null);this.zpp_inner.outer=this};K.__name__=!0;K.get=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);null==a&&(a=0);if(a!=a||b!=
b)throw new j("Error: Vec2 components cannot be NaN");var d;null==oa.poolVec2?d=new K:(d=oa.poolVec2,oa.poolVec2=d.zpp_pool,d.zpp_pool=null,d.zpp_disp=!1,d==oa.nextVec2&&(oa.nextVec2=null));if(null==d.zpp_inner)d.zpp_inner=G.get(a,b,null),d.zpp_inner.outer=d;else{if(null!=d&&d.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");d.zpp_inner.immutable();if(a!=a||b!=b)throw new j("Error: Vec2 components cannot be NaN");var e;if(null!=d&&d.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");
d.zpp_inner.validate();if(e=d.zpp_inner.x==a){if(null!=d&&d.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");d.zpp_inner.validate();e=d.zpp_inner.y==b}e||(d.zpp_inner.x=a,d.zpp_inner.y=b,d.zpp_inner.invalidate());d}d.zpp_inner.weak=c;return d};K.prototype={dispose:function(){if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.immutable();if(this.zpp_inner._inuse)throw new j("Error: This Vec2 is not disposable");var a=this.zpp_inner;
this.zpp_pool=this.zpp_inner=this.zpp_inner.outer=null;null!=oa.nextVec2?oa.nextVec2.zpp_pool=this:oa.poolVec2=this;oa.nextVec2=this;this.zpp_disp=!0;null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=G.zpp_pool;G.zpp_pool=a},get_x:function(){if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();return this.zpp_inner.x},set_x:function(a){if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");
this.zpp_inner.immutable();if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();if(this.zpp_inner.x!=a){if(a!=a)throw new j("Error: Vec2::x cannot be NaN");this.zpp_inner.x=a;this.zpp_inner.invalidate()}if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();return this.zpp_inner.x},get_y:function(){if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();
return this.zpp_inner.y},set_y:function(a){if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.immutable();if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();if(this.zpp_inner.y!=a){if(a!=a)throw new j("Error: Vec2::y cannot be NaN");this.zpp_inner.y=a;this.zpp_inner.invalidate()}if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();return this.zpp_inner.y},
lsq:function(){if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");var a;if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();a=this.zpp_inner.x;if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();a*=this.zpp_inner.x;var b;if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();b=this.zpp_inner.y;if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");
this.zpp_inner.validate();return a+b*this.zpp_inner.y},set:function(a){if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.immutable();if(null==a)throw new j("Error: Cannot assign null Vec2");var b=this.setxy(function(){if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(){if(null!=
a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this));a.zpp_inner.weak?(a.dispose(),!0):!1;return b},setxy:function(a,b){if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.immutable();if(a!=a||b!=b)throw new j("Error: Vec2 components cannot be NaN");var c;if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();if(c=this.zpp_inner.x==
a){if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();c=this.zpp_inner.y==b}c||(this.zpp_inner.x=a,this.zpp_inner.y=b,this.zpp_inner.invalidate());return this},subeq:function(a){if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.immutable();if(null==a)throw new j("Error: Cannot subtract null vectors");this.setxy(function(a){if(a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(this)-function(){if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(a){if(a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)-function(){if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this));a.zpp_inner.weak?
(a.dispose(),!0):!1;return this},toString:function(){if(this.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();return this.zpp_inner.toString()},__class__:K};var Db=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!sc.internal)throw new j("Error: Cannot instantiate Vec2Iterator derp!");};Db.__name__=!0;Db.get=function(a){var b;null==Db.zpp_pool?(sc.internal=!0,b=new Db,sc.internal=!1):(b=Db.zpp_pool,Db.zpp_pool=
b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Db.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.zpp_gl();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Db.zpp_pool;Db.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Db};var Wa=function(){this.zpp_inner=null;this.zpp_inner=new sc;this.zpp_inner.outer=this};Wa.__name__=!0;Wa.prototype={zpp_gl:function(){this.zpp_inner.valmod();
this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},zpp_vm:function(){this.zpp_inner.valmod()},at:function(a){this.zpp_vm();if(0>a||a>=this.zpp_gl())throw new j("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.zpp_gl()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=
a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.wrapper()},push:function(a){if(this.zpp_inner.immutable)throw new j("Error: Vec2List is immutable");this.zpp_inner.modify_test();this.zpp_vm();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-
1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},empty:function(){return 0==this.zpp_gl()},iterator:function(){this.zpp_vm();return Db.get(this)},toString:function(){for(var a="[",b=!0,c=this.iterator();c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:Wa};var Ka=function(){this.zpp_inner_i=
null;if(!Ka.zpp_internalAlloc)throw new j("Error: Cannot instantiate an Interactor, only Shape/Body/Compound");};Ka.__name__=!0;Ka.prototype={toString:function(){return""},__class__:Ka};var Bc=function(a,b){this.zpp_inner=null;Ka.zpp_internalAlloc=!0;Ka.call(this);Ka.zpp_internalAlloc=!1;this.zpp_inner=new rb;this.zpp_inner.outer=this;this.zpp_inner.outer_i=this;this.zpp_inner_i=this.zpp_inner;if(null!=b){if(null!=b&&b.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");if(null!=
b&&b.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();this.zpp_inner.posx=b.zpp_inner.x;if(null!=b&&b.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();this.zpp_inner.posy=b.zpp_inner.y}else this.zpp_inner.posx=0,this.zpp_inner.posy=0;this.set_type(null==a?function(){null==i.BodyType_DYNAMIC&&(i.internal=!0,i.BodyType_DYNAMIC=new ab,i.internal=!1);return i.BodyType_DYNAMIC}(this):a);null!=b&&(b.zpp_inner.weak?
(b.dispose(),!0):!1);this.zpp_inner_i.insert_cbtype(ya.ANY_BODY.zpp_inner)};Bc.__name__=!0;Bc.__super__=Ka;Bc.prototype=r(Ka.prototype,{set_type:function(a){this.zpp_inner.immutable_midstep("Body::type");if(this.zpp_inner.world)throw new j("Error: Space::world is immutable");if(rb.types[this.zpp_inner.type]!=a){if(null==a)throw new j("Error: Cannot use null BodyType");null==i.BodyType_DYNAMIC&&(i.internal=!0,i.BodyType_DYNAMIC=new ab,i.internal=!1);a==i.BodyType_DYNAMIC?a=i.id_BodyType_DYNAMIC:(null==
i.BodyType_KINEMATIC&&(i.internal=!0,i.BodyType_KINEMATIC=new ab,i.internal=!1),a=a==i.BodyType_KINEMATIC?i.id_BodyType_KINEMATIC:i.id_BodyType_STATIC);a==i.id_BodyType_STATIC&&null!=this.zpp_inner.space&&(this.zpp_inner.velx=0,this.zpp_inner.vely=0,this.zpp_inner.angvel=0);this.zpp_inner.invalidate_type();null!=this.zpp_inner.space?this.zpp_inner.space.transmitType(this.zpp_inner,a):this.zpp_inner.type=a}return rb.types[this.zpp_inner.type]},set_space:function(a){if(null!=this.zpp_inner.compound)throw new j("Error: Cannot set the space of a Body belonging to a Compound, only the root Compound space can be set");
this.zpp_inner.immutable_midstep("Body::space");if(this.zpp_inner.world)throw new j("Error: Space::world is immutable");if((null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=a){if(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer))this.zpp_inner.component.woken=!1;if(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer))(null==this.zpp_inner.space?null:this.zpp_inner.space.outer).zpp_inner.wrap_bodies.remove(this);null!=a&&a.zpp_inner.wrap_bodies.add(this)}return null==
this.zpp_inner.space?null:this.zpp_inner.space.outer},get_isSleeping:function(){if(null==this.zpp_inner.space)throw new j("Error: isSleeping makes no sense if the object is not contained within a Space");return this.zpp_inner.component.sleeping},get_position:function(){null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();return this.zpp_inner.wrap_pos},set_position:function(a){if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new j("Error: Body::position cannot be null");
null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();this.zpp_inner.wrap_pos.set(a);null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();return this.zpp_inner.wrap_pos},get_velocity:function(){null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity();return this.zpp_inner.wrap_vel},set_rotation:function(a){this.zpp_inner.immutable_midstep("Body::rotation");if(this.zpp_inner.world)throw new j("Error: Space::world is immutable");if(this.zpp_inner.type==i.id_BodyType_STATIC&&null!=
this.zpp_inner.space)throw new j("Error: Static objects cannot be rotated once inside a Space");if(this.zpp_inner.rot!=a){if(a!=a)throw new j("Error: Body::rotation cannot be NaN");this.zpp_inner.rot=a;this.zpp_inner.invalidate_rot();this.zpp_inner.wake()}return this.zpp_inner.rot},localVectorToWorld:function(a,b){null==b&&(b=!1);if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new j("Error: Cannot transform null Vec2");this.zpp_inner.validate_axis();
var c=0,d=0,c=this.zpp_inner.axisy;if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();c*=a.zpp_inner.x;d=this.zpp_inner.axisx;if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();c-=d*a.zpp_inner.y;if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();d=a.zpp_inner.x*this.zpp_inner.axisx;if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();d+=a.zpp_inner.y*this.zpp_inner.axisy;a.zpp_inner.weak?(a.dispose(),!0):!1;return K.get(c,d,b)},translateShapes:function(a){this.zpp_inner.immutable_midstep("Body::translateShapes()");if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");if(this.zpp_inner.world)throw new j("Error: Space::world is immutable");if(null==a)throw new j("Error: Cannot displace by null Vec2");var b=a.zpp_inner.weak;a.zpp_inner.weak=!1;for(var c=this.zpp_inner.shapes.head;null!=
c;)c.elt.outer.translate(a),c=c.next;a.zpp_inner.weak=b;a.zpp_inner.weak?(a.dispose(),!0):!1;return this},align:function(){this.zpp_inner.immutable_midstep("Body::align()");if(this.zpp_inner.world)throw new j("Error: Space::world is immutable");if(null==this.zpp_inner.shapes.head)throw new j("Error: Cannot align empty Body");this.zpp_inner.validate_localCOM();var a=K.get(-this.zpp_inner.localCOMx,-this.zpp_inner.localCOMy,null);this.translateShapes(a);var b=this.localVectorToWorld(a);null==this.zpp_inner.wrap_pos&&
this.zpp_inner.setupPosition();this.zpp_inner.wrap_pos.subeq(b);if(Infinity>this.zpp_inner.pre_posx){var c=this.zpp_inner,d=this.zpp_inner.pre_posx;if(null!=b&&b.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();c.pre_posx=d-1*b.zpp_inner.x;c=this.zpp_inner;d=this.zpp_inner.pre_posy;if(null!=b&&b.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();c.pre_posy=d-1*b.zpp_inner.y}a.dispose();b.dispose();return this},
toString:function(){return(this.zpp_inner.world?"(space::world":"("+(this.zpp_inner.type==i.id_BodyType_DYNAMIC?"dynamic":this.zpp_inner.type==i.id_BodyType_STATIC?"static":"kinematic"))+")#"+this.zpp_inner_i.id},__class__:Bc});var jb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!pb.internal)throw new j("Error: Cannot instantiate BodyIterator derp!");};jb.__name__=!0;jb.get=function(a){var b;null==jb.zpp_pool?(pb.internal=!0,b=new jb,pb.internal=!1):(b=jb.zpp_pool,
jb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};jb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=jb.zpp_pool;jb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:jb};var Af=function(){this.zpp_inner=null;this.zpp_inner=new pb;this.zpp_inner.outer=this};Af.__name__=!0;Af.prototype=
{get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new j("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);
else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){if(this.zpp_inner.immutable)throw new j("Error: BodyList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?
null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){if(this.zpp_inner.immutable)throw new j("Error: BodyList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&
(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new j("Error: BodyList is immutable");
this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=jb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();
b=!1}return a+"]"},__class__:Af};var ab=function(){if(!i.internal)throw new j("Error: Cannot instantiate BodyType derp!");};ab.__name__=!0;ab.prototype={toString:function(){var a;null==i.BodyType_STATIC&&(i.internal=!0,i.BodyType_STATIC=new ab,i.internal=!1);this==i.BodyType_STATIC?a="STATIC":(null==i.BodyType_DYNAMIC&&(i.internal=!0,i.BodyType_DYNAMIC=new ab,i.internal=!1),this==i.BodyType_DYNAMIC?a="DYNAMIC":(null==i.BodyType_KINEMATIC&&(i.internal=!0,i.BodyType_KINEMATIC=new ab,i.internal=!1),
a=this==i.BodyType_KINEMATIC?"KINEMATIC":""));return a},__class__:ab};var Bf=function(){this.zpp_inner=null};Bf.__name__=!0;Bf.__super__=Ka;Bf.prototype=r(Ka.prototype,{toString:function(){return"Compound"+this.zpp_inner_i.id},__class__:Bf});var vb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!Vb.internal)throw new j("Error: Cannot instantiate CompoundIterator derp!");};vb.__name__=!0;vb.get=function(a){var b;null==vb.zpp_pool?(Vb.internal=!0,b=new vb,Vb.internal=
!1):(b=vb.zpp_pool,vb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};vb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=vb.zpp_pool;vb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:vb};var Cf=function(){this.zpp_inner=null;this.zpp_inner=new Vb;this.zpp_inner.outer=this};Cf.__name__=
!0;Cf.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new j("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);
else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},remove:function(a){if(this.zpp_inner.immutable)throw new j("Error: CompoundList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),
this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=vb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:Cf};var Df=function(a,b,c,d,e){null==e&&(e=0.001);null==d&&(d=1);null==c&&(c=2);null==b&&(b=1);null==a&&(a=0);this.zpp_inner=null;null==M.zpp_pool?this.zpp_inner=new M:(this.zpp_inner=M.zpp_pool,M.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=
null);null;this.zpp_inner.outer=this;if(a!=this.zpp_inner.elasticity){if(a!=a)throw new j("Error: Material::elasticity cannot be NaN");this.zpp_inner.elasticity=a/1;this.zpp_inner.invalidate(M.WAKE|M.ARBITERS)}this.zpp_inner.elasticity;if(b!=this.zpp_inner.dynamicFriction){if(b!=b)throw new j("Error: Material::dynamicFriction cannot be NaN");if(0>b)throw new j("Error: Material::dynamicFriction cannot be negative");this.zpp_inner.dynamicFriction=b/1;this.zpp_inner.invalidate(M.WAKE|M.ANGDRAG|M.ARBITERS)}this.zpp_inner.dynamicFriction;
if(c!=this.zpp_inner.staticFriction){if(c!=c)throw new j("Error: Material::staticFriction cannot be NaN");if(0>c)throw new j("Error: Material::staticFriction cannot be negative");this.zpp_inner.staticFriction=c/1;this.zpp_inner.invalidate(M.WAKE|M.ARBITERS)}this.zpp_inner.staticFriction;if(d!=1E3*this.zpp_inner.density){if(d!=d)throw new j("Error: Material::density cannot be NaN");if(0>d)throw new j("Error: Material::density must be positive");if(0>d)throw new j("Error: Material::density cannot be negative");
this.zpp_inner.density=d/1E3;this.zpp_inner.invalidate(M.WAKE|M.PROPS)}1E3*this.zpp_inner.density;if(e!=this.zpp_inner.rollingFriction){if(e!=e)throw new j("Error: Material::rollingFriction cannot be NaN");if(0>e)throw new j("Error: Material::rollingFriction cannot be negative");this.zpp_inner.rollingFriction=e/1;this.zpp_inner.invalidate(M.WAKE|M.ARBITERS)}this.zpp_inner.rollingFriction};Df.__name__=!0;Df.prototype={toString:function(){return"{ elasticity: "+this.zpp_inner.elasticity+" dynamicFriction: "+
this.zpp_inner.dynamicFriction+" staticFriction: "+this.zpp_inner.staticFriction+" density: "+1E3*this.zpp_inner.density+" rollingFriction: "+this.zpp_inner.rollingFriction+" }"},__class__:Df};var Fb=function(){this.zpp_inner=null;Ka.zpp_internalAlloc=!0;Ka.call(this);Ka.zpp_internalAlloc=!1;if(!Fb.zpp_internalAlloc)throw new j("Error: Shape cannot be instantiated derp!");};Fb.__name__=!0;Fb.__super__=Ka;Fb.prototype=r(Ka.prototype,{translate:function(a){this.zpp_inner.immutable_midstep("Shape::translate()");
if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");if(null!=this.zpp_inner.body&&null!=this.zpp_inner.body.space&&this.zpp_inner.body.type==i.id_BodyType_STATIC)throw new j("Error: Cannot modify Shape belonging to a static Object once inside a Space");if(null==a)throw new j("Error: Cannot displace Shape by null Vec2");0<a.lsq()&&(this.zpp_inner.type==i.id_ShapeType_CIRCLE?this.zpp_inner.circle.__translate(function(){if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(this),function(){if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)):this.zpp_inner.polygon.__translate(function(){if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(){if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();
return a.zpp_inner.y}(this)));a.zpp_inner.weak?(a.dispose(),!0):!1;return this},toString:function(){return(this.zpp_inner.type==i.id_ShapeType_CIRCLE?"Circle":"Polygon")+"#"+this.zpp_inner_i.id},__class__:Fb});var Ef=function(){};Ef.__name__=!0;Ef.__super__=Fb;Ef.prototype=r(Fb.prototype,{__class__:Ef});var Ff=function(){this.zpp_inner=null;if(!R.internal)throw new j("Error: Cannot instantiate an Edge derp!");};Ff.__name__=!0;Ff.prototype={toString:function(){if(null==this.zpp_inner.polygon)return"Edge(object-pooled)";
if(null==this.zpp_inner.polygon.body)return this.zpp_inner.polygon.validate_laxi(),"{ localNormal : "+("{ x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" }")+" }";this.zpp_inner.polygon.validate_gaxi();return"{ localNormal : "+("{ x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" }")+" worldNormal : "+("{ x: "+this.zpp_inner.gnormx+" y: "+this.zpp_inner.gnormy+" }")+" }"},__class__:Ff};var Cc=function(a,b,c){this.zpp_inner_zn=null;Fb.zpp_internalAlloc=!0;Fb.call(this);Fb.zpp_internalAlloc=
!1;if(null==a)throw new j("Error: localVerts cannot be null");this.zpp_inner_zn=new we;this.zpp_inner_zn.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner_i=this.zpp_inner=this.zpp_inner_zn;this.zpp_inner_i.outer_i=this;if(a instanceof Array&&null==a.__enum__)for(var d=0;d<a.length;){var e=a[d];++d;if(null==e)throw new j("Error: Array<Vec2> contains null objects");if(!u.__instanceof(e,K))throw new j("Error: Array<Vec2> contains non Vec2 objects");var f=e;if(null!=f&&f.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");
null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();this.zpp_inner_zn.wrap_lverts.push(function(a){if(null!=f&&f.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");return K.get(function(){if(null!=f&&f.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");f.zpp_inner.validate();return f.zpp_inner.x}(a),function(){if(null!=f&&f.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");f.zpp_inner.validate();return f.zpp_inner.y}(a),
!1)}(this))}else if(u.__instanceof(a,Wa))for(d=a.iterator();d.hasNext();){var h;d.zpp_critical=!1;h=d.zpp_inner.at(d.zpp_i++);if(null==h)throw new j("Error: Vec2List contains null objects");if(null!=h&&h.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();this.zpp_inner_zn.wrap_lverts.push(function(a){if(null!=h&&h.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");return K.get(function(){if(null!=
h&&h.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();return h.zpp_inner.x}(a),function(){if(null!=h&&h.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();return h.zpp_inner.y}(a),!1)}(this))}else if(u.__instanceof(a,Qb)){if(null!=a&&a.zpp_disp)throw new j("Error: GeomPoly has been disposed and cannot be used!");d=a.zpp_inner.vertices;if(null!=d){e=d;do{var m=K.get(e.x,e.y,null),e=e.next;null==this.zpp_inner_zn.wrap_lverts&&
this.zpp_inner_zn.getlverts();this.zpp_inner_zn.wrap_lverts.push(function(a){if(null!=m&&m.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");return K.get(function(){if(null!=m&&m.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");m.zpp_inner.validate();return m.zpp_inner.x}(a),function(){if(null!=m&&m.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");m.zpp_inner.validate();return m.zpp_inner.y}(a),!1)}(this));m.dispose()}while(e!=
d)}}else throw new j("Error: Invalid type for polygon object, should be Array<Vec2>, Vec2List, GeomPoly or for flash10+ flash.Vector<Vec2>");if(a instanceof Array&&null==a.__enum__)for(d=0;d<a.length;){var e=a[d],l;if(l=e.zpp_inner.weak)e.dispose(),l=!0;l?a.splice(d,1):d++}else if(u.__instanceof(a,Wa)){null!=a.zpp_inner._validate&&a.zpp_inner._validate();a=a.zpp_inner.inner;d=null;for(e=a.head;null!=e;)l=e.elt,l.outer.zpp_inner.weak?(e=a.erase(d),l.outer.zpp_inner.weak?(l.outer.dispose(),!0):!1):
(d=e,e=e.next)}if(null==b)null==M.zpp_pool?this.zpp_inner.material=new M:(this.zpp_inner.material=M.zpp_pool,M.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null),null;else{this.zpp_inner.immutable_midstep("Shape::material");if(null==b)throw new j("Error: Cannot assign null as Shape material");this.zpp_inner.setMaterial(b.zpp_inner);this.zpp_inner.material.wrapper()}if(null==c)null==Cb.zpp_pool?this.zpp_inner.filter=new Cb:(this.zpp_inner.filter=Cb.zpp_pool,Cb.zpp_pool=this.zpp_inner.filter.next,
this.zpp_inner.filter.next=null),null;else{this.zpp_inner.immutable_midstep("Shape::filter");if(null==c)throw new j("Error: Cannot assign null as Shape filter");this.zpp_inner.setFilter(c.zpp_inner);this.zpp_inner.filter.wrapper()}this.zpp_inner_i.insert_cbtype(ya.ANY_SHAPE.zpp_inner)};Cc.__name__=!0;Cc.rect=function(a,b,c,d,e){null==e&&(e=!1);if(a!=a||b!=b||c!=c||d!=d)throw new j("Error: Polygon.rect cannot accept NaN arguments");return[K.get(a,b,e),K.get(a+c,b,e),K.get(a+c,b+d,e),K.get(a,b+d,e)]};
Cc.__super__=Fb;Cc.prototype=r(Fb.prototype,{__class__:Cc});var Gb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!tc.internal)throw new j("Error: Cannot instantiate ShapeIterator derp!");};Gb.__name__=!0;Gb.get=function(a){var b;null==Gb.zpp_pool?(tc.internal=!0,b=new Gb,tc.internal=!1):(b=Gb.zpp_pool,Gb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Gb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();
this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Gb.zpp_pool;Gb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Gb};var Gf=function(){this.zpp_inner=null;this.zpp_inner=new tc;this.zpp_inner.outer=this};Gf.__name__=!0;Gf.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},
at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new j("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){if(this.zpp_inner.immutable)throw new j("Error: ShapeList is immutable");
this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);
return b},unshift:function(a){if(this.zpp_inner.immutable)throw new j("Error: ShapeList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),
this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new j("Error: ShapeList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||
this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Gb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:Gf};var pa=function(){if(!i.internal)throw new j("Error: Cannot instantiate ValidationResult derp!");};pa.__name__=!0;pa.prototype={toString:function(){var a;null==i.ValidationResult_VALID&&(i.internal=
!0,i.ValidationResult_VALID=new pa,i.internal=!1);this==i.ValidationResult_VALID?a="VALID":(null==i.ValidationResult_DEGENERATE&&(i.internal=!0,i.ValidationResult_DEGENERATE=new pa,i.internal=!1),this==i.ValidationResult_DEGENERATE?a="DEGENERATE":(null==i.ValidationResult_CONCAVE&&(i.internal=!0,i.ValidationResult_CONCAVE=new pa,i.internal=!1),this==i.ValidationResult_CONCAVE?a="CONCAVE":(null==i.ValidationResult_SELF_INTERSECTING&&(i.internal=!0,i.ValidationResult_SELF_INTERSECTING=new pa,i.internal=
!1),a=this==i.ValidationResult_SELF_INTERSECTING?"SELF_INTERSECTING":"")));return a},__class__:pa};var Hc=function(){if(!i.internal)throw new j("Error: Cannot instantiate Broadphase derp!");};Hc.__name__=!0;Hc.prototype={toString:function(){var a;null==i.Broadphase_DYNAMIC_AABB_TREE&&(i.internal=!0,i.Broadphase_DYNAMIC_AABB_TREE=new Hc,i.internal=!1);this==i.Broadphase_DYNAMIC_AABB_TREE?a="DYNAMIC_AABB_TREE":(null==i.Broadphase_SWEEP_AND_PRUNE&&(i.internal=!0,i.Broadphase_SWEEP_AND_PRUNE=new Hc,i.internal=
!1),a=this==i.Broadphase_SWEEP_AND_PRUNE?"SWEEP_AND_PRUNE":"");return a},__class__:Hc};var Me=function(a,b){this.zpp_inner=null;if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner=new Hf(null==a?null:a.zpp_inner,b);this.zpp_inner.outer=this;null!=a&&(a.zpp_inner.weak?(a.dispose(),!0):!1)};Me.__name__=!0;Me.prototype={step:function(a,b,c){null==c&&(c=10);null==b&&(b=10);if(a!=a)throw new j("Error: deltaTime cannot be NaN");if(0>=a)throw new j("Error: deltaTime must be strictly positive");
if(0>=b)throw new j("Error: must use atleast one velocity iteration");if(0>=c)throw new j("Error: must use atleast one position iteration");this.zpp_inner.step(a,b,c)},__class__:Me};var xe=function(a){H.call(this);this._pack=a;this.init()};xe.__name__=!0;xe.__super__=H;xe.prototype=r(H.prototype,{get_name:function(){return"Background_6"},onStart:function(){this.owner.addChild(this._container)},setXY:function(a,b){this._container._compMap.Sprite_1.setXY(a,b);return this},init:function(){this._container=
(new ob).add(new B).add(this._player=(new rd(new lf(this._pack,"background"))).loop("default"));this._player.movie._value.setAnchor(0,function(a){a._player.movie._value.getLayer("back");return a._player.movie._value.getLayer("back").getComponent("Sprite_1")}(this).getNaturalHeight());this._player.movie._value.getLayer("platform1").add(new oc);this._player.movie._value.getLayer("platform2").add(new oc);this._player.movie._value.getLayer("platform4").add(new oc)},__class__:xe});var ye=function(a,b){H.call(this);
this._pack=a;this._container=b};ye.__name__=!0;ye.__super__=H;ye.prototype=r(H.prototype,{get_name:function(){return"Game_5"},run:function(){J.root.add(new Rd);var a=(new ob).add(this._back=(new xe(this._pack)).setXY(0,J._platform.getStage().get_height())),b=(new ob).add(new ze(this._pack)).add(new Rc),c=(new ob).add(new Sd(0.4,1.5));this._container.addChild(a);this._container.addChild(b);this._container.addChild(c);c._compMap.Controller_9.fnLeft=(uc=b._compMap.Walker_12,E(uc,uc.moveLeft));c._compMap.Controller_9.fnRight=
(uc=b._compMap.Walker_12,E(uc,uc.moveRight));c._compMap.Controller_9.fnUp=(uc=b._compMap.Walker_12,E(uc,uc.moveUp));return this},__class__:ye});var Ae=function(){};Ae.__name__=!0;Ae.main=function(){J.init();var a=Da.fromAssets("bootstrap");J._platform.loadAssetPack(a).get(Ae.onSuccess)};Ae.onSuccess=function(a){var b;J.root.addChild(b=new ob);J.root.add((new ye(a,b)).run())};var ze=function(a){H.call(this);this._pack=a};ze.__name__=!0;ze.__super__=H;ze.prototype=r(H.prototype,{get_name:function(){return"Walker_12"},
onStart:function(){this.owner.add(this.sprite=(new Xd(65280,70,70)).setXY(400,40).centerAnchor().disablePixelSnapping())},moveLeft:function(a){var b=this.owner._compMap.Body_8.body.get_position();b.set_x(function(){if(null!=b&&b.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.x}(this)-a)},moveRight:function(a){var b=this.owner._compMap.Body_8.body.get_position();b.set_x(function(){if(null!=b&&b.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");
b.zpp_inner.validate();return b.zpp_inner.x}(this)+a)},moveUp:function(){var a=this.owner._compMap.Body_8.body.get_velocity();a.set_y(function(){if(null!=a&&a.zpp_disp)throw new j("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)-30)},__class__:ze});var db=function(){};db.__name__=!0;db.Interactor=function(){return db._Interactor++};db.CbType=function(){return db._CbType++};db.CbSet=function(){return db._CbSet++};var N=function(){this.body=this.constraint=
null;this.pre_swapped=!1;this.int1=this.int2=this.set=this.wrap_arbiters=this.pre_arbiter=null;this.length=0;this.listener=this.next=this.prev=null;this.event=0;this.outer_body=this.outer_con=this.outer_int=null;this.length=0};N.__name__=!0;N.prototype={wrapper_body:function(){null==this.outer_body&&(N.internal=!0,this.outer_body=new $c,N.internal=!1,this.outer_body.zpp_inner=this);return this.outer_body},wrapper_con:function(){null==this.outer_con&&(N.internal=!0,this.outer_con=new ge,N.internal=
!1,this.outer_con.zpp_inner=this);return this.outer_con},wrapper_int:function(){null==this.outer_int&&(N.internal=!0,this.outer_int=new td,N.internal=!1,this.outer_int.zpp_inner=this);null==this.wrap_arbiters?this.wrap_arbiters=Ub.get(this.set.arbiters,!0):this.wrap_arbiters.zpp_inner.inner=this.set.arbiters;this.wrap_arbiters.zpp_inner.zip_length=!0;this.wrap_arbiters.zpp_inner.at_ite=null;return this.outer_int},push:function(a){null!=this.prev?this.prev.next=a:this.next=a;a.prev=this.prev;a.next=
null;this.prev=a;this.length++},pop:function(){var a=this.next;this.next=a.next;null==this.next?this.prev=null:this.next.prev=null;this.length--;return a},empty:function(){return null==this.next},__class__:N};var aa=function(){this.interactors=this.constraints=null;this.zip_conlisteners=!1;this.conlisteners=null;this.zip_bodylisteners=!1;this.bodylisteners=null;this.zip_listeners=!1;this.manager=this.cbpairs=this.listeners=null;this.id=0;this.next=null;this.count=0;this.cbTypes=null;this.cbTypes=
new vc;this.listeners=new cd;this.zip_listeners=!0;this.bodylisteners=new Be;this.zip_bodylisteners=!0;this.conlisteners=new Ce;this.zip_conlisteners=!0;this.constraints=new Ic;this.interactors=new Jc;this.id=db.CbSet();this.cbpairs=new If};aa.__name__=!0;aa.setlt=function(a,b){for(var c=a.cbTypes.head,d=b.cbTypes.head;null!=c&&null!=d;){var e=c.elt,f=d.elt;if(e.id<f.id)return!0;if(f.id<e.id)return!1;c=c.next;d=d.next}return null!=d&&null==c};aa.get=function(a){var b;null==aa.zpp_pool?b=new aa:(b=
aa.zpp_pool,aa.zpp_pool=b.next,b.next=null);null;for(var c=null,a=a.head;null!=a;){var d=a.elt,c=b.cbTypes.insert(c,d);d.cbsets.add(b);a=a.next}return b};aa.single_intersection=function(a,b,c){return a.manager.pair(a,b).single_intersection(c)};aa.find_all=function(a,b,c,d){a.manager.pair(a,b).forall(c,d)};aa.prototype={invalidate_pairs:function(){for(var a=this.cbpairs.head;null!=a;)a.elt.zip_listeners=!0,a=a.next},realvalidate_listeners:function(){this.listeners.clear();for(var a=this.cbTypes.head;null!=
a;){for(var b=null,c=this.listeners.head,d=a.elt.listeners.head;null!=d;){var e=d.elt;null!=c&&c.elt==e?(d=d.next,b=c,c=c.next):null==c||Hb.setlt(e,c.elt)?(e.space==this.manager.space&&(b=this.listeners.inlined_insert(b,e)),d=d.next):(b=c,c=c.next)}a=a.next}},realvalidate_bodylisteners:function(){this.bodylisteners.clear();for(var a=this.cbTypes.head;null!=a;){for(var b=null,c=this.bodylisteners.head,d=a.elt.bodylisteners.head;null!=d;){var e=d.elt;null!=c&&c.elt==e?(d=d.next,b=c,c=c.next):null==
c||Hb.setlt(e,c.elt)?(!e.options.excluded(this.cbTypes)&&e.space==this.manager.space&&(b=this.bodylisteners.inlined_insert(b,e)),d=d.next):(b=c,c=c.next)}a=a.next}},realvalidate_conlisteners:function(){this.conlisteners.clear();for(var a=this.cbTypes.head;null!=a;){for(var b=null,c=this.conlisteners.head,d=a.elt.conlisteners.head;null!=d;){var e=d.elt;null!=c&&c.elt==e?(d=d.next,b=c,c=c.next):null==c||Hb.setlt(e,c.elt)?(!e.options.excluded(this.cbTypes)&&e.space==this.manager.space&&(b=this.conlisteners.inlined_insert(b,
e)),d=d.next):(b=c,c=c.next)}a=a.next}},validate:function(){this.zip_listeners&&(this.zip_listeners=!1,this.realvalidate_listeners());this.zip_bodylisteners&&(this.zip_bodylisteners=!1,this.realvalidate_bodylisteners());this.zip_conlisteners&&(this.zip_conlisteners=!1,this.realvalidate_conlisteners())},free:function(){this.listeners.clear();this.zip_listeners=!0;this.bodylisteners.clear();this.zip_bodylisteners=!0;this.conlisteners.clear();for(this.zip_conlisteners=!0;null!=this.cbTypes.head;)this.cbTypes.pop_unsafe().cbsets.remove(this)},
__class__:aa};var Ea=function(){this.listeners=null;this.zip_listeners=!1;this.a=this.b=this.next=null;this.listeners=new cd};Ea.__name__=!0;Ea.get=function(a,b){var c;null==Ea.zpp_pool?c=new Ea:(c=Ea.zpp_pool,Ea.zpp_pool=c.next,c.next=null);c.zip_listeners=!0;aa.setlt(a,b)?(c.a=a,c.b=b):(c.a=b,c.b=a);return c};Ea.setlt=function(a,b){return aa.setlt(a.a,b.a)||a.a==b.a&&aa.setlt(a.b,b.b)};Ea.prototype={__validate:function(){this.listeners.clear();for(var a=this.a.listeners.head,b=this.b.listeners.head;null!=
a&&null!=b;){var c=a.elt,d=b.elt;c==d?((c.options1.compatible(this.a.cbTypes)&&c.options2.compatible(this.b.cbTypes)||c.options2.compatible(this.a.cbTypes)&&c.options1.compatible(this.b.cbTypes))&&this.listeners.add(c),a=a.next,b=b.next):c.precedence>d.precedence||c.precedence==d.precedence&&c.id>d.id?a=a.next:b=b.next}},empty_intersection:function(){return null==this.listeners.head},single_intersection:function(a){var b=this.listeners.head;return null!=b&&b.elt==a&&null==b.next},forall:function(a,
b){for(var c=this.listeners.head;null!=c;){var d=c.elt;d.event==a&&b(d);c=c.next}},__class__:Ea};var cd=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};cd.__name__=!0;cd.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==qa.zpp_pool?b=new qa:(b=qa.zpp_pool,qa.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},inlined_insert:function(a,b){var c;null==qa.zpp_pool?c=new qa:(c=qa.zpp_pool,
qa.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=qa.zpp_pool;qa.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=
c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=qa.zpp_pool;qa.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},__class__:cd};var Be=function(){this.length=0;this.modified=
this.pushmod=!1;this.head=null};Be.__name__=!0;Be.prototype={inlined_insert:function(a,b){var c;null==Xa.zpp_pool?c=new Xa:(c=Xa.zpp_pool,Xa.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Xa.zpp_pool;Xa.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},remove:function(a){this.inlined_try_remove(a)},
inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Xa.zpp_pool;Xa.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},__class__:Be};
var Ce=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Ce.__name__=!0;Ce.prototype={inlined_insert:function(a,b){var c;null==Ib.zpp_pool?c=new Ib:(c=Ib.zpp_pool,Ib.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Ib.zpp_pool;Ib.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},
remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Ib.zpp_pool;Ib.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();
this.pushmod=!0},__class__:Ce};var Ic=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Ic.__name__=!0;Ic.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==ec.zpp_pool?b=new ec:(b=ec.zpp_pool,ec.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=ec.zpp_pool;ec.zpp_pool=
a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,
a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=ec.zpp_pool;ec.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Ic};var Jc=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Jc.__name__=!0;Jc.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==fc.zpp_pool?b=new fc:(b=fc.zpp_pool,fc.zpp_pool=b.next,b.next=null);null;b.elt=
a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=fc.zpp_pool;fc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,
d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=fc.zpp_pool;fc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;
return b},__class__:Jc};var Kc=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Kc.__name__=!0;Kc.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Wb.zpp_pool?b=new Wb:(b=Wb.zpp_pool,Wb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Wb.zpp_pool;Wb.zpp_pool=a;null==
this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,
a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Wb.zpp_pool;Wb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Kc};var ya=function(){this.cbsets=this.listeners=this.bodylisteners=this.conlisteners=null;this.id=0;this.outer=null;this.id=db.CbType();this.listeners=new cd;this.bodylisteners=new Be;this.conlisteners=new Ce;this.constraints=new Ic;this.interactors=new Jc;this.cbsets=new Kc};ya.__name__=!0;ya.prototype={addint:function(a){for(var b=null,c=this.listeners.head;null!=
c;){var d=c.elt;if(a.precedence>d.precedence||a.precedence==d.precedence&&a.id>d.id)break;b=c;c=c.next}this.listeners.inlined_insert(b,a);this.invalidateint()},invalidateint:function(){for(var a=this.cbsets.head;null!=a;){var b=a.elt;b.zip_listeners=!0;b.invalidate_pairs();a=a.next}},addbody:function(a){for(var b=null,c=this.bodylisteners.head;null!=c;){var d=c.elt;if(a.precedence>d.precedence||a.precedence==d.precedence&&a.id>d.id)break;b=c;c=c.next}this.bodylisteners.inlined_insert(b,a);this.invalidatebody()},
invalidatebody:function(){for(var a=this.cbsets.head;null!=a;)a.elt.zip_bodylisteners=!0,a=a.next},addconstraint:function(a){for(var b=null,c=this.conlisteners.head;null!=c;){var d=c.elt;if(a.precedence>d.precedence||a.precedence==d.precedence&&a.id>d.id)break;b=c;c=c.next}this.conlisteners.inlined_insert(b,a);this.invalidateconstraint()},invalidateconstraint:function(){for(var a=this.cbsets.head;null!=a;)a.elt.zip_conlisteners=!0,a=a.next},__class__:ya};var i=function(){};i.__name__=!0;var Hb=function(){this.body=
this.constraint=this.interaction=this.space=null;this.id=this.type=this.event=this.precedence=0;this.outer=null};Hb.__name__=!0;Hb.setlt=function(a,b){return a.precedence>b.precedence||a.precedence==b.precedence&&a.id>b.id};Hb.prototype={addedToSpace:function(){},removedFromSpace:function(){},__class__:Hb};var Jf=function(){this.outer_zn=this.options=this.handler=null};Jf.__name__=!0;Jf.__super__=Hb;Jf.prototype=r(Hb.prototype,{addedToSpace:function(){this.options.handler=E(this,this.cbtype_change);
for(var a=this.options.includes.head;null!=a;)a.elt.addbody(this),a=a.next},removedFromSpace:function(){for(var a=this.options.includes.head;null!=a;){var b=a.elt;b.bodylisteners.remove(this);b.invalidatebody();a=a.next}this.options.handler=null},cbtype_change:function(a,b,c){this.removedFromSpace();this.options.effect_change(a,b,c);this.addedToSpace()},__class__:Jf});var Kf=function(){this.outer_zn=this.options=this.handler=null};Kf.__name__=!0;Kf.__super__=Hb;Kf.prototype=r(Hb.prototype,{addedToSpace:function(){this.options.handler=
E(this,this.cbtype_change);for(var a=this.options.includes.head;null!=a;)a.elt.addconstraint(this),a=a.next},removedFromSpace:function(){for(var a=this.options.includes.head;null!=a;){var b=a.elt;b.conlisteners.remove(this);b.invalidateconstraint();a=a.next}this.options.handler=null},cbtype_change:function(a,b,c){this.removedFromSpace();this.options.effect_change(a,b,c);this.addedToSpace()},__class__:Kf});var vc=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};vc.__name__=!0;
vc.prototype={inlined_add:function(a){var b;null==Z.zpp_pool?b=new Z:(b=Z.zpp_pool,Z.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Z.zpp_pool?c=new Z:(c=Z.zpp_pool,Z.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},
inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Z.zpp_pool;Z.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,
c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Z.zpp_pool;Z.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},iterator_at:function(a){for(var b=this.head;0<
a--&&null!=b;)b=b.next;return b},__class__:vc};var ga=function(){this.handlerp=null;this.allowSleepingCallbacks=this.pure=!1;this.options1=this.options2=this.handleri=null;this.itype=0;this.outer_zni=this.outer_znp=null};ga.__name__=!0;ga.__super__=Hb;ga.prototype=r(Hb.prototype,{CbSetset:function(a,b,c){for(var d=ga.UCbSet,e=ga.VCbSet,f=ga.WCbSet,a=a.head,h=b.head;null!=a&&null!=h;){var m=a.elt,l=h.elt;m==l?(f.inlined_add(m),a=a.next,h=h.next):aa.setlt(m,l)?(d.inlined_add(m),a=a.next):(e.inlined_add(l),
h=h.next)}for(;null!=a;)d.inlined_add(a.elt),a=a.next;for(;null!=h;)e.inlined_add(h.elt),h=h.next;for(;null!=d.head;){a=d.pop_unsafe();for(h=b.head;null!=h;)c(a,h.elt),h=h.next}for(;null!=e.head;){b=e.pop_unsafe();for(d=f.head;null!=d;)c(b,d.elt),d=d.next}for(;null!=f.head;){e=f.pop_unsafe();c(e,e);for(b=f.head;null!=b;)c(e,b.elt),b=b.next}},CbTypeset:function(a,b,c){for(var d=ga.UCbType,e=ga.VCbType,f=ga.WCbType,a=a.head,h=b.head;null!=a&&null!=h;){var m=a.elt,l=h.elt;m==l?(f.inlined_add(m),a=a.next,
h=h.next):m.id<l.id?(d.inlined_add(m),a=a.next):(e.inlined_add(l),h=h.next)}for(;null!=a;)d.inlined_add(a.elt),a=a.next;for(;null!=h;)e.inlined_add(h.elt),h=h.next;for(;null!=d.head;){a=d.pop_unsafe();for(h=b.head;null!=h;)c(a,h.elt),h=h.next}for(;null!=e.head;){b=e.pop_unsafe();for(d=f.head;null!=d;)c(b,d.elt),d=d.next}for(;null!=f.head;){e=f.pop_unsafe();c(e,e);for(b=f.head;null!=b;)c(e,b.elt),b=b.next}},with_uniquesets:function(a){var b=this,c;null==ba.zpp_pool?c=new ba:(c=ba.zpp_pool,ba.zpp_pool=
c.next,c.next=null);null;c.lt=Ea.setlt;this.CbTypeset(this.options1.includes,this.options2.includes,function(a,d){b.CbSetset(a.cbsets,d.cbsets,function(a,d){a.validate();d.validate();aa.single_intersection(a,d,b)&&c.try_insert(Ea.get(a,d))})});c.clear_with(function(c){a?b.space.freshListenerType(c.a,c.b):b.space.nullListenerType(c.a,c.b);c.a=c.b=null;c.listeners.clear();c.next=Ea.zpp_pool;Ea.zpp_pool=c});var d=c;d.data=null;d.lt=null;d.swapped=null;d.next=ba.zpp_pool;ba.zpp_pool=d},with_union:function(a){for(var b=
this.options1.includes.head,c=this.options2.includes.head;null!=b&&null!=c;){var d=b.elt,e=c.elt;d==e?(a(d),b=b.next,c=c.next):d.id<e.id?(a(d),b=b.next):(a(e),c=c.next)}for(;null!=b;)a(b.elt),b=b.next;for(;null!=c;)a(c.elt),c=c.next},addedToSpace:function(){var a=this,b=this.type==i.id_ListenerType_PRE;this.with_union(function(c){c.addint(a);if(b)for(c=c.interactors.head;null!=c;)c.elt.wake(),c=c.next});this.options1.handler=E(this,this.cbtype_change1);this.options2.handler=E(this,this.cbtype_change2);
this.with_uniquesets(!0)},removedFromSpace:function(){var a=this;this.with_uniquesets(!1);var b=this.type==i.id_ListenerType_PRE;this.with_union(function(c){c.listeners.remove(a);c.invalidateint();if(b)for(c=c.interactors.head;null!=c;)c.elt.wake(),c=c.next});this.options1.handler=null;this.options2.handler=null},cbtype_change1:function(a,b,c){this.cbtype_change(this.options1,a,b,c)},cbtype_change2:function(a,b,c){this.cbtype_change(this.options2,a,b,c)},cbtype_change:function(a,b,c,d){this.removedFromSpace();
a.effect_change(b,c,d);this.addedToSpace();null},__class__:ga});var D=function(){this.colarb=this.fluidarb=this.sensorarb=null;this.type=0;this.b1=this.b2=this.ws1=this.ws2=this.pair=null;this.invalidated=!1;this.immState=0;this.intchange=this.presentable=this.continuous=this.fresh=!1;this.present=0;this.active=this.cleared=this.sleeping=!1;this.id=this.di=this.stamp=this.up_stamp=this.sleep_stamp=this.endGenerated=0;this.outer=null};D.__name__=!0;D.prototype={wrapper:function(){null==this.outer&&
(D.internal=!0,this.type==D.COL?(this.colarb.outer_zn=new he,this.outer=this.colarb.outer_zn):this.type==D.FLUID?(this.fluidarb.outer_zn=new ie,this.outer=this.fluidarb.outer_zn):this.outer=new Tb,this.outer.zpp_inner=this,D.internal=!1);return this.outer},__class__:D};var Ya=function(){this.next=null;D.call(this);this.type=D.SENSOR;this.sensorarb=this};Ya.__name__=!0;Ya.__super__=D;Ya.prototype=r(D.prototype,{retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),
null!=this.pair&&(this.pair=this.pair.arb=null));this.b1=this.b2=null;this.intchange=this.active=!1;this.next=Ya.zpp_pool;Ya.zpp_pool=this},__class__:Ya});var hb=function(){this.pre_dt=0;this.mutable=!1;this.wrap_position=null;this.wMass=this.adamp=this.agamma=this.vMassa=this.vMassb=this.vMassc=this.dampx=this.dampy=this.lgamma=this.nx=this.ny=this.buoyx=this.buoyy=0;this.nodrag=!1;this.centroidx=this.centroidy=this.overlap=this.r1x=this.r1y=this.r2x=this.r2y=0;this.outer_zn=this.next=null;D.call(this);
this.type=D.FLUID;this.fluidarb=this;this.buoyy=this.buoyx=0;this.pre_dt=-1};hb.__name__=!0;hb.__super__=D;hb.prototype=r(D.prototype,{retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair=this.pair.arb=null));this.b1=this.b2=null;this.intchange=this.active=!1;this.next=hb.zpp_pool;hb.zpp_pool=this;this.pre_dt=-1},preStep:function(a,b){-1==this.pre_dt&&(this.pre_dt=b);var c=b/this.pre_dt;this.pre_dt=b;this.r1x=
this.centroidx-this.b1.posx;this.r1y=this.centroidy-this.b1.posy;this.r2x=this.centroidx-this.b2.posx;this.r2y=this.centroidy-this.b2.posy;var d=0,e=0;this.ws1.fluidEnabled&&null!=this.ws1.fluidProperties.wrap_gravity?(d=this.ws1.fluidProperties.gravityx,e=this.ws1.fluidProperties.gravityy):(d=a.gravityx,e=a.gravityy);var f=0,h=0;this.ws2.fluidEnabled&&null!=this.ws2.fluidProperties.wrap_gravity?(f=this.ws2.fluidProperties.gravityx,h=this.ws2.fluidProperties.gravityy):(f=a.gravityx,h=a.gravityy);
var m=0,l=0;if(this.ws1.fluidEnabled&&this.ws2.fluidEnabled){var g=this.overlap*this.ws1.fluidProperties.density,v=this.overlap*this.ws2.fluidProperties.density;if(g>v)f=g+v,m-=d*f,l-=e*f;else if(g<v)d=g+v,m+=f*d,l+=h*d;else{var j=0,q=0,j=0.5*(d+f),q=0.5*(e+h);this.ws1.worldCOMx*j+this.ws1.worldCOMy*q>this.ws2.worldCOMx*j+this.ws2.worldCOMy*q?(d=g+v,m-=j*d,l-=q*d):(d=g+v,m+=j*d,l+=q*d)}}else this.ws1.fluidEnabled?(f=this.overlap*this.ws1.fluidProperties.density,m-=d*f,l-=e*f):this.ws2.fluidEnabled&&
(d=this.overlap*this.ws2.fluidProperties.density,m+=f*d,l+=h*d);m*=b;l*=b;this.buoyx=m;this.buoyy=l;this.b1.type==i.id_BodyType_DYNAMIC&&(d=this.b1.imass,this.b1.velx-=m*d,this.b1.vely-=l*d,this.b1.angvel-=(l*this.r1x-m*this.r1y)*this.b1.iinertia);this.b2.type==i.id_BodyType_DYNAMIC&&(d=this.b2.imass,this.b2.velx+=m*d,this.b2.vely+=l*d,this.b2.angvel+=(l*this.r2x-m*this.r2y)*this.b2.iinertia);if((!this.ws1.fluidEnabled||0==this.ws1.fluidProperties.viscosity)&&(!this.ws2.fluidEnabled||0==this.ws2.fluidProperties.viscosity))this.nodrag=
!0,this.adamp=this.dampy=this.dampx=0;else{this.nodrag=!1;m=0;this.ws1.fluidEnabled&&(this.ws2.validate_angDrag(),m+=this.ws1.fluidProperties.viscosity*this.ws2.angDrag*this.overlap/this.ws2.area);this.ws2.fluidEnabled&&(this.ws1.validate_angDrag(),m+=this.ws2.fluidProperties.viscosity*this.ws1.angDrag*this.overlap/this.ws1.area);0!=m?(l=this.b1.sinertia+this.b2.sinertia,this.wMass=0!=l?1/l:0,m=2*Math.PI*4.0E-4*m,this.agamma=1/(b*m*(2+m*b)),m=1/(1+this.agamma),this.agamma*=m,this.wMass*=m):this.agamma=
this.wMass=0;m=this.b2.velx+this.b2.kinvelx-this.r2y*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.r1y*(this.b2.angvel+this.b2.kinangvel));l=this.b2.vely+this.b2.kinvely+this.r2x*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.r1x*(this.b1.angvel+this.b1.kinangvel));m*m+l*l<k.epsilon*k.epsilon||(d=1/Math.sqrt(m*m+l*l),this.nx=m*d,this.ny=l*d);m=0;if(this.ws1.fluidEnabled)if(l=-this.ws1.fluidProperties.viscosity*this.overlap/this.ws2.area,this.ws2.type==
i.id_ShapeType_CIRCLE)m-=l*this.ws2.circle.radius*k.fluidLinearDrag/(2*this.ws2.circle.radius*Math.PI);else{e=d=0;for(f=this.ws2.polygon.edges.head;null!=f;)h=f.elt,d+=h.length,h=l*h.length*(h.gnormx*this.nx+h.gnormy*this.ny),0<h&&(h=h*=-k.fluidVacuumDrag),e-=0.5*h*k.fluidLinearDrag,f=f.next;m+=e/d}if(this.ws2.fluidEnabled)if(l=-this.ws2.fluidProperties.viscosity*this.overlap/this.ws1.area,this.ws1.type==i.id_ShapeType_CIRCLE)m-=l*this.ws1.circle.radius*k.fluidLinearDrag/(2*this.ws1.circle.radius*
Math.PI);else{e=d=0;for(f=this.ws1.polygon.edges.head;null!=f;)h=f.elt,d+=h.length,h=l*h.length*(h.gnormx*this.nx+h.gnormy*this.ny),0<h&&(h=h*=-k.fluidVacuumDrag),e-=0.5*h*k.fluidLinearDrag,f=f.next;m+=e/d}0!=m?(f=this.b1.smass+this.b2.smass,e=d=l=0,l=f,d=0,e=f,0!=this.b1.sinertia&&(f=this.r1x*this.b1.sinertia,h=this.r1y*this.b1.sinertia,l+=h*this.r1y,d+=-h*this.r1x,e+=f*this.r1x),0!=this.b2.sinertia&&(f=this.r2x*this.b2.sinertia,h=this.r2y*this.b2.sinertia,l+=h*this.r2y,d+=-h*this.r2x,e+=f*this.r2x),
f=l*e-d*d,f!=f?(l=d=e=0,3):0==f?(f=0,0!=l?l=1/l:(l=0,f|=1),0!=e?e=1/e:(e=0,f|=2),d=0,f):(f=1/f,h=e*f,e=l*f,l=h,d*=-f,0),this.vMassa=l,this.vMassb=d,this.vMassc=e,m*=2*Math.PI,this.lgamma=1/(b*m*(2+m*b)),m=1/(1+this.lgamma),this.lgamma*=m,this.vMassa*=m,this.vMassb*=m,this.vMassc*=m):this.lgamma=this.vMassc=this.vMassb=this.vMassa=0}this.dampx*=c;this.dampy*=c;this.adamp*=c},warmStart:function(){var a=this.b1.imass;this.b1.velx-=this.dampx*a;this.b1.vely-=this.dampy*a;a=this.b2.imass;this.b2.velx+=
this.dampx*a;this.b2.vely+=this.dampy*a;this.b1.angvel-=this.b1.iinertia*(this.dampy*this.r1x-this.dampx*this.r1y);this.b2.angvel+=this.b2.iinertia*(this.dampy*this.r2x-this.dampx*this.r2y);this.b1.angvel-=this.adamp*this.b1.iinertia;this.b2.angvel+=this.adamp*this.b2.iinertia},applyImpulseVel:function(){if(!this.nodrag){var a=this.b1.angvel+this.b1.kinangvel,b=this.b2.angvel+this.b2.kinangvel,c=this.b1.velx+this.b1.kinvelx-this.r1y*a-(this.b2.velx+this.b2.kinvelx-this.r2y*b),d=this.b1.vely+this.b1.kinvely+
this.r1x*a-(this.b2.vely+this.b2.kinvely+this.r2x*b),e=this.vMassa*c+this.vMassb*d,d=this.vMassb*c+this.vMassc*d,f=this.lgamma,c=e-this.dampx*f,d=d-this.dampy*f;this.dampx+=1*c;this.dampy+=1*d;e=this.b1.imass;this.b1.velx-=c*e;this.b1.vely-=d*e;e=this.b2.imass;this.b2.velx+=c*e;this.b2.vely+=d*e;this.b1.angvel-=this.b1.iinertia*(d*this.r1x-c*this.r1y);this.b2.angvel+=this.b2.iinertia*(d*this.r2x-c*this.r2y);a=(a-b)*this.wMass-this.adamp*this.agamma;this.adamp+=a;this.b1.angvel-=a*this.b1.iinertia;
this.b2.angvel+=a*this.b2.iinertia}},__class__:hb});var kb=function(){this.pre_dt=0;this.stat=this.mutable=!1;this.next=null;this.hc2=this.hpc2=!1;this.c1=this.oc1=this.c2=this.oc2=null;this.__ref_vertex=0;this.__ref_edge1=this.__ref_edge2=null;this.biasCoef=0;this.rev=!1;this.kMassa=this.kMassb=this.kMassc=this.Ka=this.Kb=this.Kc=this.rMass=this.jrAcc=this.rn1a=this.rt1a=this.rn1b=this.rt1b=this.rn2a=this.rt2a=this.rn2b=this.rt2b=this.k1x=this.k1y=this.k2x=this.k2y=this.surfacex=this.surfacey=this.lnormx=
this.lnormy=this.lproj=this.radius=0;this.wrap_normal=null;this.nx=this.ny=0;this.s1=this.s2=this.contacts=this.wrap_contacts=this.innards=null;this.userdef_dyn_fric=this.userdef_stat_fric=this.userdef_restitution=this.userdef_rfric=!1;this.dyn_fric=this.stat_fric=this.restitution=this.rfric=0;this.outer_zn=null;D.call(this);this.pre_dt=-1;this.contacts=new Y;this.innards=new De;this.type=D.COL;this.colarb=this};kb.__name__=!0;kb.__super__=D;kb.prototype=r(D.prototype,{injectContact:function(a,b,
c,d,e,f,h){null==h&&(h=!1);for(var m=null,l=this.contacts.next;null!=l;){var i=l;if(f==i.hash){m=i;break}l=l.next}null==m?(null==Y.zpp_pool?m=new Y:(m=Y.zpp_pool,Y.zpp_pool=m.next,m.next=null),null,l=m.inner,l.jnAcc=l.jtAcc=0,m.hash=f,m.fresh=!0,m.arbiter=this,this.jrAcc=0,this.contacts.inlined_add(m),this.innards.add(l)):m.fresh=!1;m.px=a;m.py=b;this.nx=c;this.ny=d;m.dist=e;m.stamp=this.stamp;m.posOnly=h;return m},retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),
null!=this.pair&&(this.pair=this.pair.arb=null));this.b1=this.b2=null;for(this.intchange=this.active=!1;null!=this.contacts.next;){var a=this.contacts.inlined_pop_unsafe();a.arbiter=null;a.next=Y.zpp_pool;Y.zpp_pool=a;this.innards.inlined_pop()}this.userdef_rfric=this.userdef_restitution=this.userdef_stat_fric=this.userdef_dyn_fric=!1;this.__ref_edge1=this.__ref_edge2=null;this.next=kb.zpp_pool;kb.zpp_pool=this;this.pre_dt=-1},cleanupContacts:function(){var a=!0,b=null,c=null,d=this.innards.next;
this.hc2=!1;for(var e=this.contacts.next;null!=e;){var f=e;f.stamp+k.arbiterExpirationDelay<this.stamp?(e=this.contacts.inlined_erase(b),d=this.innards.inlined_erase(c),f.arbiter=null,f.next=Y.zpp_pool,Y.zpp_pool=f):(b=f.inner,c=f.active,f.active=f.stamp==this.stamp,f.active&&(a?(a=!1,this.c1=b,this.oc1=f):(this.hc2=!0,this.c2=b,this.oc2=f)),c!=f.active&&(this.contacts.modified=!0),b=e,c=d,d=d.next,e=e.next)}this.hc2?(this.hpc2=!0,this.oc1.posOnly?(d=this.c1,this.c1=this.c2,this.c2=d,d=this.oc1,this.oc1=
this.oc2,this.oc2=d,this.hc2=!1):this.oc2.posOnly&&(this.hc2=!1),this.oc1.posOnly&&(a=!0)):this.hpc2=!1;return a},preStep:function(a){this.invalidated&&(this.invalidated=!1,this.userdef_restitution||(this.restitution=-Infinity>=this.s1.material.elasticity||-Infinity>=this.s2.material.elasticity?0:Infinity<=this.s1.material.elasticity||Infinity<=this.s2.material.elasticity?1:(this.s1.material.elasticity+this.s2.material.elasticity)/2,0>this.restitution&&(this.restitution=0),1<this.restitution&&(this.restitution=
1)),this.userdef_dyn_fric||(this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||(this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction)));-1==this.pre_dt&&(this.pre_dt=a);var b=a/this.pre_dt;this.pre_dt=a;var c=this.b1.smass+this.b2.smass;this.hc2=!1;a=!0;this.biasCoef=this.b1.type!=i.id_BodyType_DYNAMIC||
this.b2.type!=i.id_BodyType_DYNAMIC?this.continuous?k.contactContinuousStaticBiasCoef:k.contactStaticBiasCoef:this.continuous?k.contactContinuousBiasCoef:k.contactBiasCoef;this.continuous=!1;for(var d=null,e=null,f=this.innards.next,h=this.contacts.next;null!=h;){var m=h;if(m.stamp+k.arbiterExpirationDelay<this.stamp)h=this.contacts.inlined_erase(d),f=this.innards.inlined_erase(e),m.arbiter=null,m.next=Y.zpp_pool,Y.zpp_pool=m;else{d=m.inner;e=m.active;m.active=m.stamp==this.stamp;if(m.active){a?(a=
!1,this.c1=d,this.oc1=m):(this.hc2=!0,this.c2=d,this.oc2=m);d.r2x=m.px-this.b2.posx;d.r2y=m.py-this.b2.posy;d.r1x=m.px-this.b1.posx;d.r1y=m.py-this.b1.posy;var l=c+this.b2.sinertia*Lc.sqr(d.r2x*this.nx+d.r2y*this.ny),l=l+this.b1.sinertia*Lc.sqr(d.r1x*this.nx+d.r1y*this.ny);d.tMass=l<k.epsilon*k.epsilon?0:1/l;l=c+this.b2.sinertia*Lc.sqr(this.ny*d.r2x-this.nx*d.r2y);l+=this.b1.sinertia*Lc.sqr(this.ny*d.r1x-this.nx*d.r1y);d.nMass=l<k.epsilon*k.epsilon?0:1/l;var g=l=0,v=this.b2.angvel+this.b2.kinangvel,
l=this.b2.velx+this.b2.kinvelx-d.r2y*v,g=this.b2.vely+this.b2.kinvely+d.r2x*v,v=this.b1.angvel+this.b1.kinangvel,l=l-(this.b1.velx+this.b1.kinvelx-d.r1y*v),g=g-(this.b1.vely+this.b1.kinvely+d.r1x*v),v=this.nx*l+this.ny*g;m.elasticity=this.restitution;d.bounce=v*m.elasticity;d.bounce>-k.elasticThreshold&&(d.bounce=0);v=g*this.nx-l*this.ny;l=k.staticFrictionThreshold;d.friction=v*v>l*l?this.dyn_fric:this.stat_fric;d.jnAcc*=b;d.jtAcc*=b}e!=m.active&&(this.contacts.modified=!0);d=h;e=f;f=f.next;h=h.next}}this.hc2?
(this.hpc2=!0,this.oc1.posOnly?(f=this.c1,this.c1=this.c2,this.c2=f,f=this.oc1,this.oc1=this.oc2,this.oc2=f,this.hc2=!1):this.oc2.posOnly&&(this.hc2=!1),this.oc1.posOnly&&(a=!0)):this.hpc2=!1;this.jrAcc*=b;a||(this.rn1a=this.ny*this.c1.r1x-this.nx*this.c1.r1y,this.rt1a=this.c1.r1x*this.nx+this.c1.r1y*this.ny,this.rn1b=this.ny*this.c1.r2x-this.nx*this.c1.r2y,this.rt1b=this.c1.r2x*this.nx+this.c1.r2y*this.ny,this.k1x=this.b2.kinvelx-this.c1.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c1.r1y*this.b1.kinangvel),
this.k1y=this.b2.kinvely+this.c1.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c1.r1x*this.b1.kinangvel));this.hc2&&(this.rn2a=this.ny*this.c2.r1x-this.nx*this.c2.r1y,this.rt2a=this.c2.r1x*this.nx+this.c2.r1y*this.ny,this.rn2b=this.ny*this.c2.r2x-this.nx*this.c2.r2y,this.rt2b=this.c2.r2x*this.nx+this.c2.r2y*this.ny,this.k2x=this.b2.kinvelx-this.c2.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c2.r1y*this.b1.kinangvel),this.k2y=this.b2.kinvely+this.c2.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c2.r1x*
this.b1.kinangvel),this.kMassa=c+this.b1.sinertia*this.rn1a*this.rn1a+this.b2.sinertia*this.rn1b*this.rn1b,this.kMassb=c+this.b1.sinertia*this.rn1a*this.rn2a+this.b2.sinertia*this.rn1b*this.rn2b,this.kMassc=c+this.b1.sinertia*this.rn2a*this.rn2a+this.b2.sinertia*this.rn2b*this.rn2b,this.kMassa*this.kMassa+2*this.kMassb*this.kMassb+this.kMassc*this.kMassc<k.illConditionedThreshold*(this.kMassa*this.kMassc-this.kMassb*this.kMassb)?(this.Ka=this.kMassa,this.Kb=this.kMassb,this.Kc=this.kMassc,b=this.kMassa*
this.kMassc-this.kMassb*this.kMassb,b!=b?(this.kMassa=this.kMassb=this.kMassc=0,3):0==b?(b=0,0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,b|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,b|=2),this.kMassb=0,b):(b=1/b,c=this.kMassc*b,this.kMassc=this.kMassa*b,this.kMassa=c,this.kMassb*=-b,0)):(this.hc2=!1,this.oc2.dist<this.oc1.dist&&(b=this.c1,this.c1=this.c2,this.c2=b),this.oc2.active=!1,this.contacts.modified=!0));this.surfacex=this.b2.svelx;this.surfacey=this.b2.svely;this.surfacex+=
1*this.b1.svelx;this.surfacey+=1*this.b1.svely;this.surfacex=-this.surfacex;this.surfacey=-this.surfacey;this.rMass=this.b1.sinertia+this.b2.sinertia;0!=this.rMass&&(this.rMass=1/this.rMass);return a},warmStart:function(){var a=this.nx*this.c1.jnAcc-this.ny*this.c1.jtAcc,b=this.ny*this.c1.jnAcc+this.nx*this.c1.jtAcc,c=this.b1.imass;this.b1.velx-=a*c;this.b1.vely-=b*c;this.b1.angvel-=this.b1.iinertia*(b*this.c1.r1x-a*this.c1.r1y);c=this.b2.imass;this.b2.velx+=a*c;this.b2.vely+=b*c;this.b2.angvel+=
this.b2.iinertia*(b*this.c1.r2x-a*this.c1.r2y);this.hc2&&(a=this.nx*this.c2.jnAcc-this.ny*this.c2.jtAcc,b=this.ny*this.c2.jnAcc+this.nx*this.c2.jtAcc,c=this.b1.imass,this.b1.velx-=a*c,this.b1.vely-=b*c,this.b1.angvel-=this.b1.iinertia*(b*this.c2.r1x-a*this.c2.r1y),c=this.b2.imass,this.b2.velx+=a*c,this.b2.vely+=b*c,this.b2.angvel+=this.b2.iinertia*(b*this.c2.r2x-a*this.c2.r2y));this.b2.angvel+=this.jrAcc*this.b2.iinertia;this.b1.angvel-=this.jrAcc*this.b1.iinertia},applyImpulseVel:function(){var a,
b,c,d,e;d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel);var f=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel);c=(f*this.nx-d*this.ny+this.surfacex)*this.c1.tMass;d=this.c1.friction*this.c1.jnAcc;a=this.c1.jtAcc;e=a-c;e>d?e=d:e<-d&&(e=-d);c=e-a;this.c1.jtAcc=e;a=-this.ny*c;b=this.nx*c;this.b2.velx+=a*this.b2.imass;this.b2.vely+=b*this.b2.imass;this.b1.velx-=a*this.b1.imass;this.b1.vely-=b*this.b1.imass;this.b2.angvel+=
this.rt1b*c*this.b2.iinertia;this.b1.angvel-=this.rt1a*c*this.b1.iinertia;this.hc2?(e=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),b=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel),c=(b*this.nx-e*this.ny+this.surfacex)*this.c2.tMass,d=this.c2.friction*this.c2.jnAcc,a=this.c2.jtAcc,e=a-c,e>d?e=d:e<-d&&(e=-d),c=e-a,this.c2.jtAcc=e,a=-this.ny*c,b=this.nx*c,this.b2.velx+=a*this.b2.imass,this.b2.vely+=b*this.b2.imass,
this.b1.velx-=a*this.b1.imass,this.b1.vely-=b*this.b1.imass,this.b2.angvel+=this.rt2b*c*this.b2.iinertia,this.b1.angvel-=this.rt2a*c*this.b1.iinertia,d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),f=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),e=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),b=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*
this.b1.angvel),c=this.c1.jnAcc,a=this.c2.jnAcc,d=d*this.nx+f*this.ny+this.surfacey+this.c1.bounce-(this.Ka*c+this.Kb*a),e=e*this.nx+b*this.ny+this.surfacey+this.c2.bounce-(this.Kb*c+this.Kc*a),b=-(this.kMassa*d+this.kMassb*e),f=-(this.kMassb*d+this.kMassc*e),0<=b&&0<=f?(d=b-c,e=f-a,this.c1.jnAcc=b,this.c2.jnAcc=f):(b=-this.c1.nMass*d,0<=b&&0<=this.Kb*b+e?(d=b-c,e=-a,this.c1.jnAcc=b,this.c2.jnAcc=0):(f=-this.c2.nMass*e,0<=f&&0<=this.Kb*f+d?(d=-c,e=f-a,this.c1.jnAcc=0,this.c2.jnAcc=f):0<=d&&0<=e?(d=
-c,e=-a,this.c1.jnAcc=this.c2.jnAcc=0):e=d=0)),c=d+e,a=this.nx*c,b=this.ny*c,this.b2.velx+=a*this.b2.imass,this.b2.vely+=b*this.b2.imass,this.b1.velx-=a*this.b1.imass,this.b1.vely-=b*this.b1.imass,this.b2.angvel+=(this.rn1b*d+this.rn2b*e)*this.b2.iinertia,this.b1.angvel-=(this.rn1a*d+this.rn2a*e)*this.b1.iinertia):(0!=this.radius&&(c=(this.b2.angvel-this.b1.angvel)*this.rMass,d=this.rfric*this.c1.jnAcc,a=this.jrAcc,this.jrAcc-=c,this.jrAcc>d?this.jrAcc=d:this.jrAcc<-d&&(this.jrAcc=-d),c=this.jrAcc-
a,this.b2.angvel+=c*this.b2.iinertia,this.b1.angvel-=c*this.b1.iinertia),d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),f=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),c=(this.c1.bounce+(this.nx*d+this.ny*f)+this.surfacey)*this.c1.nMass,a=this.c1.jnAcc,e=a-c,0>e&&(e=0),c=e-a,this.c1.jnAcc=e,a=this.nx*c,b=this.ny*c,this.b2.velx+=a*this.b2.imass,this.b2.vely+=b*this.b2.imass,this.b1.velx-=a*this.b1.imass,this.b1.vely-=
b*this.b1.imass,this.b2.angvel+=this.rn1b*c*this.b2.iinertia,this.b1.angvel-=this.rn1a*c*this.b1.iinertia)},applyImpulsePos:function(){if(2==this.ptype){var a=this.c1,b=0,c=0,b=this.b2.axisy*a.lr2x-this.b2.axisx*a.lr2y,c=a.lr2x*this.b2.axisx+a.lr2y*this.b2.axisy,b=b+1*this.b2.posx,c=c+1*this.b2.posy,d=0,e=0,d=this.b1.axisy*a.lr1x-this.b1.axisx*a.lr1y,e=a.lr1x*this.b1.axisx+a.lr1y*this.b1.axisy,d=d+1*this.b1.posx,e=e+1*this.b1.posy,f=a=0,a=b-d,f=c-e,h=Math.sqrt(a*a+f*f),m=this.radius-k.collisionSlop,
l=h-m;0>a*this.nx+f*this.ny&&(a=-a,f=-f,l-=this.radius);0>l&&(h<k.epsilon?0!=this.b1.smass?this.b1.posx+=10*k.epsilon:this.b2.posx+=10*k.epsilon:(l=1/h,a*=l,f*=l,b=0.5*(d+b),c=0.5*(e+c),d=b-this.b1.posx,e=c-this.b1.posy,b-=this.b2.posx,c-=this.b2.posy,d=f*d-a*e,b=f*b-a*c,c=this.b2.smass+b*b*this.b2.sinertia+this.b1.smass+d*d*this.b1.sinertia,0!=c&&(h=-this.biasCoef*(h-m)/c,c=m=0,m=a*h,c=f*h,a=this.b1.imass,this.b1.posx-=m*a,this.b1.posy-=c*a,this.b1.delta_rot(-d*this.b1.iinertia*h),a=this.b2.imass,
this.b2.posx+=m*a,this.b2.posy+=c*a,this.b2.delta_rot(b*this.b2.iinertia*h))))}else{var i=l=f=a=0,e=b=0;0==this.ptype?(a=this.b1.axisy*this.lnormx-this.b1.axisx*this.lnormy,f=this.lnormx*this.b1.axisx+this.lnormy*this.b1.axisy,m=this.lproj+(a*this.b1.posx+f*this.b1.posy),l=this.b2.axisy*this.c1.lr1x-this.b2.axisx*this.c1.lr1y,i=this.c1.lr1x*this.b2.axisx+this.c1.lr1y*this.b2.axisy,l+=1*this.b2.posx,i+=1*this.b2.posy,this.hpc2&&(b=this.b2.axisy*this.c2.lr1x-this.b2.axisx*this.c2.lr1y,e=this.c2.lr1x*
this.b2.axisx+this.c2.lr1y*this.b2.axisy,b+=1*this.b2.posx,e+=1*this.b2.posy)):(a=this.b2.axisy*this.lnormx-this.b2.axisx*this.lnormy,f=this.lnormx*this.b2.axisx+this.lnormy*this.b2.axisy,m=this.lproj+(a*this.b2.posx+f*this.b2.posy),l=this.b1.axisy*this.c1.lr1x-this.b1.axisx*this.c1.lr1y,i=this.c1.lr1x*this.b1.axisx+this.c1.lr1y*this.b1.axisy,l+=1*this.b1.posx,i+=1*this.b1.posy,this.hpc2&&(b=this.b1.axisy*this.c2.lr1x-this.b1.axisx*this.c2.lr1y,e=this.c2.lr1x*this.b1.axisx+this.c2.lr1y*this.b1.axisy,
b+=1*this.b1.posx,e+=1*this.b1.posy));h=l*a+i*f-m-this.radius;h+=k.collisionSlop;c=0;this.hpc2&&(c=b*a+e*f-m-this.radius,c+=k.collisionSlop);if(0>h||0>c){this.rev&&(a=-a,f=-f);var g=0,j=0,g=l-this.b1.posx,j=i-this.b1.posy,d=m=0,m=l-this.b2.posx,d=i-this.b2.posy,q=0,n=0,i=l=0;if(this.hpc2){q=b-this.b1.posx;n=e-this.b1.posy;l=b-this.b2.posx;i=e-this.b2.posy;b=f*g-a*j;m=f*m-a*d;e=f*q-a*n;d=f*l-a*i;l=this.b1.smass+this.b2.smass;this.kMassa=l+this.b1.sinertia*b*b+this.b2.sinertia*m*m;this.kMassb=l+this.b1.sinertia*
b*e+this.b2.sinertia*m*d;this.kMassc=l+this.b1.sinertia*e*e+this.b2.sinertia*d*d;g=i=l=0;l=this.kMassa;i=this.kMassb;g=this.kMassc;j=h*this.biasCoef;q=c*this.biasCoef;c=h=0;h=-j;c=-q;n=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(n!=n)h=c=0;else if(0==n)h=0!=this.kMassa?h/this.kMassa:0,c=0!=this.kMassc?c/this.kMassc:0;else var n=1/n,o=n*(this.kMassc*h-this.kMassb*c),c=n*(this.kMassa*c-this.kMassb*h),h=o;0<=h&&0<=c?(l=(h+c)*this.b1.imass,this.b1.posx-=a*l,this.b1.posy-=f*l,this.b1.delta_rot(-this.b1.iinertia*
(b*h+e*c)),b=(h+c)*this.b2.imass,this.b2.posx+=a*b,this.b2.posy+=f*b,this.b2.delta_rot(this.b2.iinertia*(m*h+d*c))):(h=-j/l,c=0,0<=h&&0<=i*h+q?(l=(h+c)*this.b1.imass,this.b1.posx-=a*l,this.b1.posy-=f*l,this.b1.delta_rot(-this.b1.iinertia*(b*h+e*c)),b=(h+c)*this.b2.imass,this.b2.posx+=a*b,this.b2.posy+=f*b,this.b2.delta_rot(this.b2.iinertia*(m*h+d*c))):(h=0,c=-q/g,0<=c&&0<=i*c+j&&(l=(h+c)*this.b1.imass,this.b1.posx-=a*l,this.b1.posy-=f*l,this.b1.delta_rot(-this.b1.iinertia*(b*h+e*c)),b=(h+c)*this.b2.imass,
this.b2.posx+=a*b,this.b2.posy+=f*b,this.b2.delta_rot(this.b2.iinertia*(m*h+d*c)))))}else b=f*g-a*j,m=f*m-a*d,c=this.b2.smass+m*m*this.b2.sinertia+this.b1.smass+b*b*this.b1.sinertia,0!=c&&(h=-this.biasCoef*h/c,d=c=0,c=a*h,d=f*h,a=this.b1.imass,this.b1.posx-=c*a,this.b1.posy-=d*a,this.b1.delta_rot(-b*this.b1.iinertia*h),a=this.b2.imass,this.b2.posx+=c*a,this.b2.posy+=d*a,this.b2.delta_rot(m*this.b2.iinertia*h))}}},__class__:kb});var Y=function(){this.length=0;this._inuse=this.modified=this.pushmod=
!1;this.next=null;this.dist=this.elasticity=0;this.fresh=!1;this.stamp=this.hash=0;this.active=this.posOnly=!1;this.arbiter=this.inner=null;this.px=this.py=0;this.outer=null;this.inner=new De};Y.__name__=!0;Y.prototype={wrapper:function(){null==this.outer&&(Y.internal=!0,this.outer=new wf,Y.internal=!1,this.outer.zpp_inner=this);return this.outer},inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=
this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_pop_unsafe:function(){var a=this.next;this.pop();return a},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Y};var De=function(){this.length=0;this._inuse=this.modified=this.pushmod=!1;this.next=
null;this.r1x=this.r1y=this.r2x=this.r2y=this.nMass=this.tMass=this.bounce=this.friction=this.jnAcc=this.jtAcc=this.lr1x=this.lr1y=this.lr2x=this.lr2y=0};De.__name__=!0;De.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_erase:function(a){var b,c;
null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:De};var Cb=function(){this.collisionGroup=this.collisionMask=this.sensorGroup=this.sensorMask=this.fluidGroup=this.fluidMask=0;this.next=this.outer=this.shapes=null;this.shapes=new Mc;this.collisionGroup=this.sensorGroup=this.fluidGroup=1;this.collisionMask=this.sensorMask=this.fluidMask=-1};
Cb.__name__=!0;Cb.prototype={wrapper:function(){if(null==this.outer){this.outer=new xf;var a=this.outer.zpp_inner;a.outer=null;a.next=Cb.zpp_pool;Cb.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},shouldCollide:function(a){return 0!=(this.collisionMask&a.collisionGroup)&&0!=(a.collisionMask&this.collisionGroup)},shouldSense:function(a){return 0!=(this.sensorMask&a.sensorGroup)&&0!=(a.sensorMask&this.sensorGroup)},shouldFlow:function(a){return 0!=(this.fluidMask&a.fluidGroup)&&0!=(a.fluidMask&
this.fluidGroup)},invalidate:function(){for(var a=this.shapes.head;null!=a;)a.elt.invalidate_filter(),a=a.next},__class__:Cb};var ra=function(){this.wrap_max=null;this.maxx=this.maxy=0;this.wrap_min=null;this.minx=this.miny=0;this.outer=this.next=null;this._immutable=!1;this._invalidate=this._validate=null};ra.__name__=!0;ra.get=function(a,b,c,d){var e;null==ra.zpp_pool?e=new ra:(e=ra.zpp_pool,ra.zpp_pool=e.next,e.next=null);null;e.minx=a;e.miny=b;e.maxx=c;e.maxy=d;return e};ra.prototype={validate:function(){null!=
this._validate&&this._validate()},perimeter:function(){return 2*(this.maxx-this.minx+(this.maxy-this.miny))},intersectY:function(a){return!(a.miny>this.maxy||this.miny>a.maxy)},intersect:function(a){return a.miny<=this.maxy&&this.miny<=a.maxy&&a.minx<=this.maxx&&this.minx<=a.maxx},combine:function(a){a.minx<this.minx&&(this.minx=a.minx);a.maxx>this.maxx&&(this.maxx=a.maxx);a.miny<this.miny&&(this.miny=a.miny);a.maxy>this.maxy&&(this.maxy=a.maxy)},contains:function(a){return a.minx>=this.minx&&a.miny>=
this.miny&&a.maxx<=this.maxx&&a.maxy<=this.maxy},setCombine:function(a,b){this.minx=a.minx<b.minx?a.minx:b.minx;this.miny=a.miny<b.miny?a.miny:b.miny;this.maxx=a.maxx>b.maxx?a.maxx:b.maxx;this.maxy=a.maxy>b.maxy?a.maxy:b.maxy},setExpand:function(a,b){this.minx=a.minx-b;this.miny=a.miny-b;this.maxx=a.maxx+b;this.maxy=a.maxy+b},toString:function(){return"{ x: "+this.minx+" y: "+this.miny+" w: "+(this.maxx-this.minx)+" h: "+(this.maxy-this.miny)+" }"},__class__:ra};var wc=function(){this.length=0;this.modified=
this.pushmod=!1;this.head=null};wc.__name__=!0;wc.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Za.zpp_pool?b=new Za:(b=Za.zpp_pool,Za.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Za.zpp_pool?c=new Za:(c=Za.zpp_pool,Za.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=
c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Za.zpp_pool;Za.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?
(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Za.zpp_pool;Za.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:wc};var s=function(){};s.__name__=!0;s.contactCollide=function(a,b,c,d){if(b.type==i.id_ShapeType_POLYGON)if(a.type==
i.id_ShapeType_POLYGON){for(var e=!0,f=-1.0E100,h=-1,m=null,l=null,g=a.polygon.edges.head;null!=g;){for(var j=g.elt,A=1.0E100,q=b.polygon.gverts.next;null!=q;){var n=q,n=j.gnormx*n.x+j.gnormy*n.y;n<A&&(A=n);if(A-j.gprojection<=f)break;q=q.next}A-=j.gprojection;if(0<=A){e=!1;break}A>f&&(f=A,m=j,h=1);g=g.next}if(e){for(g=b.polygon.edges.head;null!=g;){j=g.elt;A=1.0E100;for(q=a.polygon.gverts.next;null!=q;){n=q;n=j.gnormx*n.x+j.gnormy*n.y;n<A&&(A=n);if(A-j.gprojection<=f)break;q=q.next}A-=j.gprojection;
if(0<=A){e=!1;break}A>f&&(f=A,l=j,h=2);g=g.next}if(e){1==h?(a=b.polygon,b=m,l=1):(a=a.polygon,b=l,l=-1);m=null;e=1.0E100;for(f=a.edges.head;null!=f;)g=f.elt,j=b.gnormx*g.gnormx+b.gnormy*g.gnormy,j<e&&(e=j,m=g),f=f.next;var f=e=0,e=m.gp0.x,f=m.gp0.y,j=g=0,g=m.gp1.x,j=m.gp1.y,q=A=0,A=g-e,q=j-f,o=b.gnormy*e-b.gnormx*f,n=b.gnormy*g-b.gnormx*j,le=1/(n-o),o=(-b.tp1-o)*le;o>k.epsilon&&(e+=A*o,f+=q*o);n=(-b.tp0-n)*le;n<-k.epsilon&&(g+=A*n,j+=q*n);q=A=0;q=l;A=b.gnormx*q;q*=b.gnormy;c.lnormx=b.lnormx;c.lnormy=
b.lnormy;c.lproj=b.lprojection;c.radius=0;c.rev=d!=(-1==l);c.ptype=c.rev?1:0;n=e*b.gnormx+f*b.gnormy-b.gprojection;l=g*b.gnormx+j*b.gnormy-b.gprojection;if(0<n&&0<l)return!1;d&&(A=-A,q=-q);d=c.injectContact(e-0.5*b.gnormx*n,f-0.5*b.gnormy*n,A,q,n,c.rev?1:0,0<n);e-=1*a.body.posx;f-=1*a.body.posy;d.inner.lr1x=e*a.body.axisy+f*a.body.axisx;d.inner.lr1y=f*a.body.axisy-e*a.body.axisx;d=c.injectContact(g-0.5*b.gnormx*l,j-0.5*b.gnormy*l,A,q,l,c.rev?0:1,0<l);g-=1*a.body.posx;j-=1*a.body.posy;d.inner.lr1x=
g*a.body.axisy+j*a.body.axisx;d.inner.lr1y=j*a.body.axisy-g*a.body.axisx;1==h?(c.__ref_edge1=b,c.__ref_edge2=m):(c.__ref_edge2=b,c.__ref_edge1=m);return!0}}}else{l=-1.0E100;m=!0;e=h=null;f=b.polygon.gverts.next;for(g=b.polygon.edges.head;null!=g;){j=g.elt;A=j.gnormx*a.circle.worldCOMx+j.gnormy*a.circle.worldCOMy-j.gprojection-a.circle.radius;if(0<A){m=!1;break}A>l&&(l=A,h=j,e=f);f=f.next;g=g.next}if(m){m=e;e=null==e.next?b.polygon.gverts.next:e.next;f=a.circle.worldCOMy*h.gnormx-a.circle.worldCOMx*
h.gnormy;if(f<=m.y*h.gnormx-m.x*h.gnormy)return l=a.circle.radius,f=e=0,e=m.x-a.circle.worldCOMx,f=m.y-a.circle.worldCOMy,g=e*e+f*f,g>l*l?l=null:g<k.epsilon*k.epsilon?l=c.injectContact(a.circle.worldCOMx,a.circle.worldCOMy,1,0,-l,0,null):(g=1/Math.sqrt(g),j=g<k.epsilon?1.0E100:1/g,A=0.5+(a.circle.radius-0.5*l)*g,l=d?c.injectContact(a.circle.worldCOMx+e*A,a.circle.worldCOMy+f*A,-e*g,-f*g,j-l,0,null):c.injectContact(a.circle.worldCOMx+e*A,a.circle.worldCOMy+f*A,e*g,f*g,j-l,0,null)),null!=l&&(e=l.inner,
c.ptype=2,g=f=0,f=m.x-b.polygon.body.posx,g=m.y-b.polygon.body.posy,c.__ref_edge1=h,c.__ref_vertex=-1,d?(e.lr1x=f*b.polygon.body.axisy+g*b.polygon.body.axisx,e.lr1y=g*b.polygon.body.axisy-f*b.polygon.body.axisx,e.lr2x=a.circle.localCOMx,e.lr2y=a.circle.localCOMy):(e.lr2x=f*b.polygon.body.axisy+g*b.polygon.body.axisx,e.lr2y=g*b.polygon.body.axisy-f*b.polygon.body.axisx,e.lr1x=a.circle.localCOMx,e.lr1y=a.circle.localCOMy),c.radius=a.circle.radius),null!=l;if(f>=e.y*h.gnormx-e.x*h.gnormy)return m=a.circle.radius,
f=l=0,l=e.x-a.circle.worldCOMx,f=e.y-a.circle.worldCOMy,g=l*l+f*f,g>m*m?m=null:g<k.epsilon*k.epsilon?m=c.injectContact(a.circle.worldCOMx,a.circle.worldCOMy,1,0,-m,0,null):(g=1/Math.sqrt(g),j=g<k.epsilon?1.0E100:1/g,A=0.5+(a.circle.radius-0.5*m)*g,m=d?c.injectContact(a.circle.worldCOMx+l*A,a.circle.worldCOMy+f*A,-l*g,-f*g,j-m,0,null):c.injectContact(a.circle.worldCOMx+l*A,a.circle.worldCOMy+f*A,l*g,f*g,j-m,0,null)),null!=m&&(l=m.inner,c.ptype=2,g=f=0,f=e.x-b.polygon.body.posx,g=e.y-b.polygon.body.posy,
c.__ref_edge1=h,c.__ref_vertex=1,d?(l.lr1x=f*b.polygon.body.axisy+g*b.polygon.body.axisx,l.lr1y=g*b.polygon.body.axisy-f*b.polygon.body.axisx,l.lr2x=a.circle.localCOMx,l.lr2y=a.circle.localCOMy):(l.lr2x=f*b.polygon.body.axisy+g*b.polygon.body.axisx,l.lr2y=g*b.polygon.body.axisy-f*b.polygon.body.axisx,l.lr1x=a.circle.localCOMx,l.lr1y=a.circle.localCOMy),c.radius=a.circle.radius),null!=m;m=b=0;m=a.circle.radius+0.5*l;b=h.gnormx*m;m*=h.gnormy;f=e=0;e=a.circle.worldCOMx-b;f=a.circle.worldCOMy-m;b=d?c.injectContact(e,
f,h.gnormx,h.gnormy,l,0,null):c.injectContact(e,f,-h.gnormx,-h.gnormy,l,0,null);c.ptype=d?0:1;c.lnormx=h.lnormx;c.lnormy=h.lnormy;c.rev=!d;c.lproj=h.lprojection;c.radius=a.circle.radius;b.inner.lr1x=a.circle.localCOMx;b.inner.lr1y=a.circle.localCOMy;c.__ref_edge1=h;c.__ref_vertex=0;return!0}}else if(h=a.circle.radius+b.circle.radius,l=m=0,m=b.circle.worldCOMx-a.circle.worldCOMx,l=b.circle.worldCOMy-a.circle.worldCOMy,e=m*m+l*l,e>h*h?h=null:e<k.epsilon*k.epsilon?h=c.injectContact(a.circle.worldCOMx,
a.circle.worldCOMy,1,0,-h,0,null):(e=1/Math.sqrt(e),f=e<k.epsilon?1.0E100:1/e,g=0.5+(a.circle.radius-0.5*h)*e,h=d?c.injectContact(a.circle.worldCOMx+m*g,a.circle.worldCOMy+l*g,-m*e,-l*e,f-h,0,null):c.injectContact(a.circle.worldCOMx+m*g,a.circle.worldCOMy+l*g,m*e,l*e,f-h,0,null)),null!=h)return h=h.inner,d?(h.lr1x=b.circle.localCOMx,h.lr1y=b.circle.localCOMy,h.lr2x=a.circle.localCOMx,h.lr2y=a.circle.localCOMy):(h.lr1x=a.circle.localCOMx,h.lr1y=a.circle.localCOMy,h.lr2x=b.circle.localCOMx,h.lr2y=b.circle.localCOMy),
c.radius=a.circle.radius+b.circle.radius,c.ptype=2,!0;return!1};s.testCollide_safe=function(a,b){if(b.type==i.id_ShapeType_CIRCLE)var c=a,a=b,b=c;return s.testCollide(a,b)};s.testCollide=function(a,b){if(b.type==i.id_ShapeType_POLYGON){if(a.type==i.id_ShapeType_POLYGON){for(var c=!0,d=a.polygon.edges.head;null!=d;){for(var e=d.elt,f=1.0E100,h=b.polygon.gverts.next;null!=h;){var m=h,m=e.gnormx*m.x+e.gnormy*m.y;m<f&&(f=m);h=h.next}f-=e.gprojection;if(0<f){c=!1;break}d=d.next}if(c){for(d=b.polygon.edges.head;null!=
d;){e=d.elt;f=1.0E100;for(h=a.polygon.gverts.next;null!=h;)m=h,m=e.gnormx*m.x+e.gnormy*m.y,m<f&&(f=m),h=h.next;f-=e.gprojection;if(0<f){c=!1;break}d=d.next}return c}}else{d=c=null;e=!0;f=-1.0E100;h=b.polygon.gverts.next;for(m=b.polygon.edges.head;null!=m;){var g=m.elt,j=g.gnormx*a.circle.worldCOMx+g.gnormy*a.circle.worldCOMy-g.gprojection-a.circle.radius;if(0<j){e=!1;break}j>f&&(f=j,c=g,d=h);h=h.next;m=m.next}if(e){e=d;d=null==d.next?b.polygon.gverts.next:d.next;f=a.circle.worldCOMy*c.gnormx-a.circle.worldCOMx*
c.gnormy;if(f<=e.y*c.gnormx-e.x*c.gnormy)return c=a.circle.radius,f=d=0,d=e.x-a.circle.worldCOMx,f=e.y-a.circle.worldCOMy,d*d+f*f<=c*c;return f>=d.y*c.gnormx-d.x*c.gnormy?(c=a.circle.radius,f=e=0,e=d.x-a.circle.worldCOMx,f=d.y-a.circle.worldCOMy,e*e+f*f<=c*c):!0}}return!1}c=a.circle.radius+b.circle.radius;e=d=0;d=b.circle.worldCOMx-a.circle.worldCOMx;e=b.circle.worldCOMy-a.circle.worldCOMy;return d*d+e*e<=c*c};s.flowCollide=function(a,b,c){if(b.type==i.id_ShapeType_POLYGON){if(a.type==i.id_ShapeType_POLYGON){for(var d=
[],e=[],f=!0,h=!0,m=a.polygon.edges.head;null!=m;){for(var g=m.elt,j=1.0E100,v=0,A=b.polygon.gverts.next;null!=A;){var n=A,o=g.gnormx*n.x+g.gnormy*n.y;o<j&&(j=o);o>=g.gprojection+k.epsilon&&(e[v]=!0,h=!1);v++;A=A.next}j-=g.gprojection;if(0<j){f=!1;break}m=m.next}if(h)return b.polygon.validate_worldCOM(),c.overlap=b.polygon.area,c.centroidx=b.polygon.worldCOMx,c.centroidy=b.polygon.worldCOMy,null,!0;if(f){for(var h=!0,r=b.polygon.edges.head;null!=r;){for(var le=r.elt,y=1.0E100,F=0,t=a.polygon.gverts.next;null!=
t;){var E=t,C=le.gnormx*E.x+le.gnormy*E.y;C<y&&(y=C);C>=le.gprojection+k.epsilon&&(d[F]=!0,h=!1);F++;t=t.next}y-=le.gprojection;if(0<y){f=!1;break}r=r.next}if(h)return a.polygon.validate_worldCOM(),c.overlap=a.polygon.area,c.centroidx=a.polygon.worldCOMx,c.centroidy=a.polygon.worldCOMy,null,!0;if(f){for(;null!=s.flowpoly.head;){var H=s.flowpoly.pop_unsafe();if(!H._inuse){var z=H;null!=z.outer&&(z.outer.zpp_inner=null,z.outer=null);z._isimmutable=null;z._validate=null;z._invalidate=null;z.next=G.zpp_pool;
G.zpp_pool=z}}for(var u=null,D=!1,w=a.polygon.gverts.next,B=0,lb=b.polygon.gverts.next,O=0,J=0,M=b.polygon.edgeCnt;J<M;){var I=J++;if(e[I])lb=lb.next;else{O=I;break}}if(null==lb){for(var lb=b.polygon.gverts.next,D=!0,K=0,ha=a.polygon.edgeCnt;K<ha;){var aa=K++;if(d[aa])w=w.next;else{B=aa;break}}null==w?w=a.polygon.gverts.next:(s.flowpoly.add(w),u=s.flowpoly.head.elt)}else s.flowpoly.add(lb),u=s.flowpoly.head.elt;var R=1;if(null==s.flowpoly.head){for(var W=!0,ca=a.polygon.gverts.next,eb=ca,S=ca.next;null!=
S;){for(var ba=S,Oa=2,$=b.polygon.gverts.next,Q=$,ea=$.next;null!=ea;){var N=ea,ra=0;(function(){var a=0,b=0,a=eb.x-Q.x,b=eb.y-Q.y,c=0,d=0,c=ba.x-eb.x,d=ba.y-eb.y,e=0,f=0,e=N.x-Q.x,f=N.y-Q.y,h=d*e-c*f;h*h>k.epsilon*k.epsilon?(h=1/h,e=(f*a-e*b)*h,e>k.epsilon&&e<1-k.epsilon?(a=(d*a-c*b)*h,a>k.epsilon&&a<1-k.epsilon?(ra=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&ra<Oa&&(Oa=ra,lb=$);$=ea;Q=N;ea=ea.next}var ma=ea=b.polygon.gverts.next,gg=0;(function(){var a=0,b=0,a=eb.x-Q.x,b=eb.y-Q.y,c=0,d=0,c=ba.x-eb.x,
d=ba.y-eb.y,e=0,f=0,e=ma.x-Q.x,f=ma.y-Q.y,h=d*e-c*f;h*h>k.epsilon*k.epsilon?(h=1/h,e=(f*a-e*b)*h,e>k.epsilon&&e<1-k.epsilon?(a=(d*a-c*b)*h,a>k.epsilon&&a<1-k.epsilon?(gg=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&gg<Oa&&(Oa=gg,lb=$);if(2!=Oa){var Ja=0,za=0,ta=Oa,Ja=eb.x+(ba.x-eb.x)*ta,za=eb.y+(ba.y-eb.y)*ta,u=G.get(Ja,za,null);s.flowpoly.add(u);D=!0;w=ca;W=!1;break}ca=S;eb=ba;S=S.next}if(W){for(var U=S=a.polygon.gverts.next,p=2,Ba=b.polygon.gverts.next,X=Ba,Y=Ba.next;null!=Y;){var Sa=Y,da=0;(function(){var a=
0,b=0,a=eb.x-X.x,b=eb.y-X.y,c=0,d=0,c=U.x-eb.x,d=U.y-eb.y,e=0,f=0,e=Sa.x-X.x,f=Sa.y-X.y,h=d*e-c*f;h*h>k.epsilon*k.epsilon?(h=1/h,e=(f*a-e*b)*h,e>k.epsilon&&e<1-k.epsilon?(a=(d*a-c*b)*h,a>k.epsilon&&a<1-k.epsilon?(da=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&da<p&&(p=da,lb=Ba);Ba=Y;X=Sa;Y=Y.next}var ia=Y=b.polygon.gverts.next,na=0;(function(){var a=0,b=0,a=eb.x-X.x,b=eb.y-X.y,c=0,d=0,c=U.x-eb.x,d=U.y-eb.y,e=0,f=0,e=ia.x-X.x,f=ia.y-X.y,h=d*e-c*f;h*h>k.epsilon*k.epsilon?(h=1/h,e=(f*a-e*b)*h,e>k.epsilon&&
e<1-k.epsilon?(a=(d*a-c*b)*h,a>k.epsilon&&a<1-k.epsilon?(na=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&na<p&&(p=na,lb=Ba);if(2!=p){var ja=0,V=0,Pa=p,ja=eb.x+(U.x-eb.x)*Pa,V=eb.y+(U.y-eb.y)*Pa,u=G.get(ja,V,null);s.flowpoly.add(u);D=!0;w=ca}}R=2}for(;;)if(D)if(w=w.next,B++,null==w&&(w=a.polygon.gverts.next,B=0),d[B]){var T=s.flowpoly.head.elt,sb=w,ud=lb,tb=lb.next;null==tb&&(tb=b.polygon.gverts.next);var ne=-1,se=null,Ka=0,La=0,Ga=tb,Xb=tb;do{var Ea=Xb,ga=0;if(function(){var a=0,b=0,a=ud.x-T.x,b=ud.y-
T.y,c=0,d=0,c=Ea.x-ud.x,d=Ea.y-ud.y,e=0,f=0,e=sb.x-T.x,f=sb.y-T.y,h=d*e-c*f;h*h>k.epsilon*k.epsilon?(h=1/h,e=(f*a-e*b)*h,e>k.epsilon&&e<1-k.epsilon?(a=(d*a-c*b)*h,a>k.epsilon&&a<1-k.epsilon?(ga=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&ga>=ne)if(se=lb,Ka=O,++La==R){ne=ga;Xb=Ga;break}else ne=ga;ud=Ea;lb=Xb;O++;O>=b.polygon.edgeCnt&&(O=0);Xb=Xb.next;null==Xb&&(Xb=b.polygon.gverts.next)}while(0);for(;Xb!=Ga;){var Ya=Xb,Lf=0;if(function(){var a=0,b=0,a=ud.x-T.x,b=ud.y-T.y,c=0,d=0,c=Ya.x-ud.x,d=Ya.y-ud.y,
e=0,f=0,e=sb.x-T.x,f=sb.y-T.y,h=d*e-c*f;h*h>k.epsilon*k.epsilon?(h=1/h,e=(f*a-e*b)*h,e>k.epsilon&&e<1-k.epsilon?(a=(d*a-c*b)*h,a>k.epsilon&&a<1-k.epsilon?(Lf=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&Lf>=ne)if(se=lb,Ka=O,++La==R){ne=Lf;Xb=Ga;break}else ne=Lf;ud=Ya;lb=Xb;O++;O>=b.polygon.edgeCnt&&(O=0);Xb=Xb.next;null==Xb&&(Xb=b.polygon.gverts.next)}if(null==se)break;var Mf=se,hb=se.next;null==hb&&(hb=b.polygon.gverts.next);var kb=hb,Ia=0,oe=0,Ua=ne,Ia=Mf.x+(kb.x-Mf.x)*Ua,oe=Mf.y+(kb.y-Mf.y)*Ua;if(null!=
u&&Qa.vec_dsq(Ia,oe,u.x,u.y)<k.epsilon)break;s.flowpoly.add(G.get(Ia,oe,null));null==u&&(u=s.flowpoly.head.elt);lb=se;O=Ka;D=!D;R=2}else{var Va=w;if(null!=u&&Qa.vec_dsq(Va.x,Va.y,u.x,u.y)<k.epsilon)break;s.flowpoly.add(Va);null==u&&(u=s.flowpoly.head.elt);R=1}else if(lb=lb.next,O++,null==lb&&(lb=b.polygon.gverts.next,O=0),e[O]){var ke=s.flowpoly.head.elt,oa=lb,x=w,pa=w.next;null==pa&&(pa=a.polygon.gverts.next);var qa=-1,Z=null,Za=0,Ma=0,$a=pa,mb=pa;do{var Ra=mb,Ha=0;if(function(){var a=0,b=0,a=x.x-
ke.x,b=x.y-ke.y,c=0,d=0,c=Ra.x-x.x,d=Ra.y-x.y,e=0,f=0,e=oa.x-ke.x,f=oa.y-ke.y,h=d*e-c*f;h*h>k.epsilon*k.epsilon?(h=1/h,e=(f*a-e*b)*h,e>k.epsilon&&e<1-k.epsilon?(a=(d*a-c*b)*h,a>k.epsilon&&a<1-k.epsilon?(Ha=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&Ha>=qa)if(Z=w,Za=B,++Ma==R){qa=Ha;mb=$a;break}else qa=Ha;x=Ra;w=mb;B++;B>=a.polygon.edgeCnt&&(B=0);mb=mb.next;null==mb&&(mb=a.polygon.gverts.next)}while(0);for(;mb!=$a;){var Fa=mb,ab=0;if(function(){var a=0,b=0,a=x.x-ke.x,b=x.y-ke.y,c=0,d=0,c=Fa.x-x.x,d=
Fa.y-x.y,e=0,f=0,e=oa.x-ke.x,f=oa.y-ke.y,h=d*e-c*f;h*h>k.epsilon*k.epsilon?(h=1/h,e=(f*a-e*b)*h,e>k.epsilon&&e<1-k.epsilon?(a=(d*a-c*b)*h,a>k.epsilon&&a<1-k.epsilon?(ab=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&ab>=qa)if(Z=w,Za=B,++Ma==R){qa=ab;mb=$a;break}else qa=ab;x=Fa;w=mb;B++;B>=a.polygon.edgeCnt&&(B=0);mb=mb.next;null==mb&&(mb=a.polygon.gverts.next)}if(null==Z)break;var xa=Z,ya=Z.next;null==ya&&(ya=a.polygon.gverts.next);var ib=ya,hg=0,ig=0,ob=qa,hg=xa.x+(ib.x-xa.x)*ob,ig=xa.y+(ib.y-xa.y)*ob;
if(null!=u&&Qa.vec_dsq(hg,ig,u.x,u.y)<k.epsilon)break;s.flowpoly.add(G.get(hg,ig,null));null==u&&(u=s.flowpoly.head.elt);w=Z;B=Za;D=!D;R=2}else{var Da=lb;if(null!=u&&Qa.vec_dsq(Da.x,Da.y,u.x,u.y)<k.epsilon)break;s.flowpoly.add(Da);null==u&&(u=s.flowpoly.head.elt);R=1}if(null!=s.flowpoly.head&&null!=s.flowpoly.head.next&&null!=s.flowpoly.head.next.next){for(var wb=0,vd=0,wd=0,wb=wd=vd=0,ub=s.flowpoly.head,wa=ub.elt,ub=ub.next,Aa=ub.elt,ub=ub.next;null!=ub;)var te=ub.elt,wb=wb+Aa.x*(te.y-wa.y),Bb=te.y*
Aa.x-te.x*Aa.y,vd=vd+(Aa.x+te.x)*Bb,wd=wd+(Aa.y+te.y)*Bb,wa=Aa,Aa=te,ub=ub.next;var ub=s.flowpoly.head,xd=ub.elt,wb=wb+Aa.x*(xd.y-wa.y),mg=xd.y*Aa.x-xd.x*Aa.y,vd=vd+(Aa.x+xd.x)*mg,wd=wd+(Aa.y+xd.y)*mg,wa=Aa,Aa=xd,ub=ub.next,gb=ub.elt,wb=wb+Aa.x*(gb.y-wa.y),Cb=gb.y*Aa.x-gb.x*Aa.y,vd=vd+(Aa.x+gb.x)*Cb,wd=wd+(Aa.y+gb.y)*Cb,wb=0.5*wb,Fb=1/(6*wb),vd=vd*Fb,wd=wd*Fb;c.overlap=-wb;c.centroidx=vd;c.centroidy=wd;null;return!0}}}return!1}for(var db=[],Hb=!0,L=null,sa=null,Kb=-1.0E100,Lb=!0,fb=b.polygon.gverts.next,
Qb=0,ua=b.polygon.edges.head;null!=ua;){var bb=ua.elt,va=bb.gnormx*a.circle.worldCOMx+bb.gnormy*a.circle.worldCOMy;if(va>bb.gprojection+a.circle.radius){Lb=!1;break}else va+a.circle.radius>bb.gprojection+k.epsilon&&(Hb=!1,db[Qb]=!0);va-=bb.gprojection+a.circle.radius;va>Kb&&(Kb=va,L=bb,sa=fb);fb=fb.next;Qb++;ua=ua.next}if(Lb){if(Hb)return c.overlap=a.circle.area,c.centroidx=a.circle.worldCOMx,c.centroidy=a.circle.worldCOMy,null,!0;var Ta=sa,Wa;Wa=null==sa.next?b.polygon.gverts.next:sa.next;var Zb=
a.circle.worldCOMy*L.gnormx-a.circle.worldCOMx*L.gnormy;if(Zb<=Ta.y*L.gnormx-Ta.x*L.gnormy?function(){var b=a.circle.radius,c=0,d=0,c=Ta.x-a.circle.worldCOMx,d=Ta.y-a.circle.worldCOMy;return c*c+d*d<=b*b}(this):Zb>=Wa.y*L.gnormx-Wa.x*L.gnormy?function(){var b=a.circle.radius,c=0,d=0,c=Wa.x-a.circle.worldCOMx,d=Wa.y-a.circle.worldCOMy;return c*c+d*d<=b*b}(this):1){for(var nb=[],Rb=0,bc=!0,Jb=null,ka=0,cb=b.polygon.gverts.next;null!=cb;){var cc=cb,qc=Qa.vec_dsq(cc.x,cc.y,a.circle.worldCOMx,a.circle.worldCOMy);
(nb[Rb]=qc<=a.circle.radius*a.circle.radius)?(ka=Rb,Jb=cb):bc=!1;Rb++;cb=cb.next}if(bc)return b.polygon.validate_worldCOM(),c.overlap=b.polygon.area,c.centroidx=b.polygon.worldCOMx,c.centroidy=b.polygon.worldCOMy,null,!0;for(;null!=s.flowpoly.head;){var dc=s.flowpoly.pop_unsafe();if(!dc._inuse){var fa=dc;null!=fa.outer&&(fa.outer.zpp_inner=null,fa.outer=null);fa._isimmutable=null;fa._validate=null;fa._invalidate=null;fa.next=G.zpp_pool;G.zpp_pool=fa}}s.flowsegs.clear();var xb=null,Nc=1;null==Jb?(Jb=
b.polygon.gverts.next,Nc=2):s.flowpoly.add(xb=Jb);for(;0!=Nc;)if(1==Nc)if(Jb=Jb.next,null==Jb&&(Jb=b.polygon.gverts.next),ka++,ka>=b.polygon.edgeCnt&&(ka=0),nb[ka]){if(Qa.vec_dsq(xb.x,xb.y,Jb.x,Jb.y)<k.epsilon)break;s.flowpoly.add(Jb)}else{var la=s.flowpoly.head.elt,Db=Jb,pb=0,jb=0,pb=Db.x-la.x,jb=Db.y-la.y,vb=0,Gb=0,vb=la.x-a.circle.worldCOMx,Gb=la.y-a.circle.worldCOMy,Xa=pb*pb+jb*jb,Ib=2*(vb*pb+Gb*jb),ec=Math.sqrt(Ib*Ib-4*Xa*(vb*vb+Gb*Gb-a.circle.radius*a.circle.radius)),Xa=1/(2*Xa),fc=(-Ib-ec)*
Xa,Wb=0,$b=0,kc=fc<k.epsilon?(-Ib+ec)*Xa:fc,Wb=la.x+(Db.x-la.x)*kc,$b=la.y+(Db.y-la.y)*kc;if(Qa.vec_dsq(xb.x,xb.y,Wb,$b)<k.epsilon)break;s.flowpoly.add(G.get(Wb,$b,null));Nc=2}else if(2==Nc){var Mb=Jb.next;null==Mb&&(Mb=b.polygon.gverts.next);var P=Jb,Nc=0,Na=Mb,yb=Mb;do{var Ca=yb,Ob=ka+1;Ob==b.polygon.edgeCnt&&(Ob=0);if(db[ka])if(nb[Ob]){var Pb=0,Sb=0,Pb=Ca.x-P.x,Sb=Ca.y-P.y,Tb=0,Ub=0,Tb=P.x-a.circle.worldCOMx,Ub=P.y-a.circle.worldCOMy,rb=Pb*Pb+Sb*Sb,Vb=2*(Tb*Pb+Ub*Sb),tc=Math.sqrt(Vb*Vb-4*rb*(Tb*
Tb+Ub*Ub-a.circle.radius*a.circle.radius)),rb=1/(2*rb),Fc=(-Vb-tc)*rb,pc=0,uc=0,Ic=Fc<k.epsilon?(-Vb+tc)*rb:Fc,pc=P.x+(Ca.x-P.x)*Ic,uc=P.y+(Ca.y-P.y)*Ic;if(Qa.vec_dsq(xb.x,xb.y,pc,uc)<k.epsilon){Nc=0;yb=Na;break}var Jc=G.get(pc,uc,null);s.flowsegs.add(s.flowpoly.head.elt);s.flowsegs.add(Jc);s.flowpoly.add(Jc);Nc=1;yb=Na;break}else{var gc=0,hc=0,xc,ic=0,jc=0,ic=Ca.x-P.x,jc=Ca.y-P.y,lc=0,mc=0,lc=P.x-a.circle.worldCOMx,mc=P.y-a.circle.worldCOMy,Nb=ic*ic+jc*jc,ac=2*(lc*ic+mc*jc),qb=ac*ac-4*Nb*(lc*lc+
mc*mc-a.circle.radius*a.circle.radius);qb*qb<k.epsilon?(gc=0>qb?10:hc=-ac/(2*Nb),xc=!1):(qb=Math.sqrt(qb),Nb=1/(2*Nb),gc=(-ac-qb)*Nb,hc=(-ac+qb)*Nb,xc=!0);if(gc<1-k.epsilon&&hc>k.epsilon){var zc=0,Cc=0,Uc=gc,zc=P.x+(Ca.x-P.x)*Uc,Cc=P.y+(Ca.y-P.y)*Uc;if(null!=xb&&Qa.vec_dsq(xb.x,xb.y,zc,Cc)<k.epsilon){Nc=0;yb=Na;break}var Wc=G.get(zc,Cc,null);null!=s.flowpoly.head&&(s.flowsegs.add(s.flowpoly.head.elt),s.flowsegs.add(Wc));s.flowpoly.add(Wc);null==xb&&(xb=s.flowpoly.head.elt);if(xc){var Xc=0,Zc=0,bd=
hc,Xc=P.x+(Ca.x-P.x)*bd,Zc=P.y+(Ca.y-P.y)*bd;s.flowpoly.add(G.get(Xc,Zc,null))}}}P=Ca;Jb=yb;ka=Ob;yb=yb.next;null==yb&&(yb=b.polygon.gverts.next)}while(0);for(;yb!=Na;){var dd=yb,sc=ka+1;sc==b.polygon.edgeCnt&&(sc=0);if(db[ka])if(nb[sc]){var vc=0,yc=0,vc=dd.x-P.x,yc=dd.y-P.y,Ac=0,Bc=0,Ac=P.x-a.circle.worldCOMx,Bc=P.y-a.circle.worldCOMy,oc=vc*vc+yc*yc,Ec=2*(Ac*vc+Bc*yc),ed=Math.sqrt(Ec*Ec-4*oc*(Ac*Ac+Bc*Bc-a.circle.radius*a.circle.radius)),oc=1/(2*oc),gd=(-Ec-ed)*oc,Sc=0,Tc=0,ld=gd<k.epsilon?(-Ec+
ed)*oc:gd,Sc=P.x+(dd.x-P.x)*ld,Tc=P.y+(dd.y-P.y)*ld;if(Qa.vec_dsq(xb.x,xb.y,Sc,Tc)<k.epsilon){Nc=0;yb=Na;break}var od=G.get(Sc,Tc,null);s.flowsegs.add(s.flowpoly.head.elt);s.flowsegs.add(od);s.flowpoly.add(od);Nc=1;yb=Na;break}else{var Gc=0,Hc=0,cd,Kc=0,Mc=0,Kc=dd.x-P.x,Mc=dd.y-P.y,Pc=0,Qc=0,Pc=P.x-a.circle.worldCOMx,Qc=P.y-a.circle.worldCOMy,nc=Kc*Kc+Mc*Mc,Dc=2*(Pc*Kc+Qc*Mc),pe=Dc*Dc-4*nc*(Pc*Pc+Qc*Qc-a.circle.radius*a.circle.radius);pe*pe<k.epsilon?(Gc=0>pe?10:Hc=-Dc/(2*nc),cd=!1):(pe=Math.sqrt(pe),
nc=1/(2*nc),Gc=(-Dc-pe)*nc,Hc=(-Dc+pe)*nc,cd=!0);if(Gc<1-k.epsilon&&Hc>k.epsilon){var id=0,jd=0,Dd=Gc,id=P.x+(dd.x-P.x)*Dd,jd=P.y+(dd.y-P.y)*Dd;if(null!=xb&&Qa.vec_dsq(xb.x,xb.y,id,jd)<k.epsilon){Nc=0;yb=Na;break}var Ed=G.get(id,jd,null);null!=s.flowpoly.head&&(s.flowsegs.add(s.flowpoly.head.elt),s.flowsegs.add(Ed));s.flowpoly.add(Ed);null==xb&&(xb=s.flowpoly.head.elt);if(cd){var Fd=0,Gd=0,Hd=Hc,Fd=P.x+(dd.x-P.x)*Hd,Gd=P.y+(dd.y-P.y)*Hd;s.flowpoly.add(G.get(Fd,Gd,null))}}}P=dd;Jb=yb;ka=sc;yb=yb.next;
null==yb&&(yb=b.polygon.gverts.next)}}if(null==s.flowpoly.head)return!1;if(null==s.flowpoly.head.next){for(var Id=!0,Yc=b.polygon.edges.head;null!=Yc;){var sd=Yc.elt;if(sd.gnormx*a.circle.worldCOMx+sd.gnormy*a.circle.worldCOMy>sd.gprojection){Id=!1;break}Yc=Yc.next}return Id?(c.overlap=a.circle.area,c.centroidx=a.circle.worldCOMx,c.centroidy=a.circle.worldCOMy,null,!0):!1}var qe=0,re=0,rc=0;if(null!=s.flowpoly.head.next.next){for(var Oc=0,yd=0,zd=0,Oc=zd=yd=0,Yb=s.flowpoly.head,Lc=Yb.elt,Yb=Yb.next,
zb=Yb.elt,Yb=Yb.next;null!=Yb;)var wc=Yb.elt,Oc=Oc+zb.x*(wc.y-Lc.y),Pd=wc.y*zb.x-wc.x*zb.y,yd=yd+(zb.x+wc.x)*Pd,zd=zd+(zb.y+wc.y)*Pd,Lc=zb,zb=wc,Yb=Yb.next;var Yb=s.flowpoly.head,ue=Yb.elt,Oc=Oc+zb.x*(ue.y-Lc.y),Qd=ue.y*zb.x-ue.x*zb.y,yd=yd+(zb.x+ue.x)*Qd,zd=zd+(zb.y+ue.y)*Qd,Lc=zb,zb=ue,Yb=Yb.next,Rc=Yb.elt,Oc=Oc+zb.x*(Rc.y-Lc.y),Rd=Rc.y*zb.x-Rc.x*zb.y,yd=yd+(zb.x+Rc.x)*Rd,zd=zd+(zb.y+Rc.y)*Rd,Oc=0.5*Oc,Sd=1/(6*Oc),yd=yd*Sd,zd=zd*Sd,Td=-Oc,qe=qe+yd*Td,re=re+zd*Td,rc=rc-Oc}else s.flowsegs.add(s.flowpoly.head.elt),
s.flowsegs.add(s.flowpoly.head.next.elt);for(;null!=s.flowsegs.head;)var fd=s.flowsegs.pop_unsafe(),hd=s.flowsegs.pop_unsafe(),Ud=0,Vd=0,Ud=hd.x-fd.x,Vd=hd.y-fd.y,Nd=0,Od=0,Nd=Ud,Od=Vd,Wd=1/Math.sqrt(Nd*Nd+Od*Od),Nd=Nd*Wd,Od=Od*Wd,me=Nd,Nd=-Od,Od=me,Ad=0,Bd=0,Ad=fd.x+hd.x,Bd=fd.y+hd.y,Ad=0.5*Ad,Bd=0.5*Bd,Ad=Ad-1*a.circle.worldCOMx,Bd=Bd-1*a.circle.worldCOMy,Cd=0,Xd=0,Yd=Nd*Ad+Od*Bd,kd=Yd/a.circle.radius,Vc=Math.sqrt(1-kd*kd),Zd=Math.acos(kd),Cd=a.circle.radius*(a.circle.radius*Zd-Yd*Vc),Xd=0.6666666666666666*
a.circle.radius*Vc*Vc*Vc/(Zd-kd*Vc),Ad=a.circle.worldCOMx,Bd=a.circle.worldCOMy,$d=Xd,Ad=Ad+Nd*$d,Bd=Bd+Od*$d,ae=Cd,qe=qe+Ad*ae,re=re+Bd*ae,rc=rc+Cd;var be=1/rc,qe=qe*be,re=re*be;c.overlap=rc;c.centroidx=qe;c.centroidy=re;null;return!0}}return!1}var Ab=a.circle,Eb=b.circle,md=0,nd=0,md=Eb.worldCOMx-Ab.worldCOMx,nd=Eb.worldCOMy-Ab.worldCOMy,ce=Ab.radius+Eb.radius,Jd=md*md+nd*nd;if(Jd>ce*ce)return!1;if(Jd<k.epsilon*k.epsilon)Ab.radius<Eb.radius?(c.overlap=Ab.area,c.centroidx=Ab.worldCOMx,c.centroidy=
Ab.worldCOMy):(c.overlap=Eb.area,c.centroidx=Eb.worldCOMx,c.centroidy=Eb.worldCOMy);else{var pd=Math.sqrt(Jd),de=1/pd,qd=0.5*(pd-(Eb.radius*Eb.radius-Ab.radius*Ab.radius)*de);if(qd<=-Ab.radius)c.overlap=Ab.area,c.centroidx=Ab.worldCOMx,c.centroidy=Ab.worldCOMy;else{var Kd=pd-qd;if(Kd<=-Eb.radius)c.overlap=Eb.area,c.centroidx=Eb.worldCOMx,c.centroidy=Eb.worldCOMy;else{var Ld=0,ee=0,Md=0,fe=0,rd=qd/Ab.radius,$c=Math.sqrt(1-rd*rd),ge=Math.acos(rd),Ld=Ab.radius*(Ab.radius*ge-qd*$c),ee=0.6666666666666666*
Ab.radius*$c*$c*$c/(ge-rd*$c),td=Kd/Eb.radius,ad=Math.sqrt(1-td*td),he=Math.acos(td),Md=Eb.radius*(Eb.radius*he-Kd*ad),fe=0.6666666666666666*Eb.radius*ad*ad*ad/(he-td*ad),ie=Ld+Md,je=(ee*Ld+(pd-fe)*Md)/ie*de;c.overlap=ie;c.centroidx=Ab.worldCOMx+md*je;c.centroidy=Ab.worldCOMy+nd*je}}}null;return!0};var rc=function(){};rc.__name__=!0;rc.isinner=function(a,b,c){var d=0,e=0,d=a.x-b.x,e=a.y-b.y,f=a=0,a=c.x-b.x,f=c.y-b.y;return 0<=f*d-a*e};rc.optimise=function(a){var b=a.vertices,c=a.vertices;if(null!=
b){do b.sort(),b=b.next;while(b!=c)}a=c=a.vertices;if(null!=c){do{for(var b=c,d=b.prev,e=null,f=b.diagonals.head;null!=f;){var h=f.elt;if(rc.isinner(null==f.next?b.next:f.next.elt,b,d)){for(var m=!0,g=h,i=g.prev,j=null,k=g.diagonals.head;null!=k;){var n=k.elt;if(n==b){m=rc.isinner(null==k.next?g.next:k.next.elt,g,i);break}i=n;j=k;k=k.next}m?(f=b.diagonals.erase(e),g.diagonals.erase(j)):(d=h,e=f,f=f.next)}else e=f,d=h,f=f.next}c=c.next}while(c!=a)}};var V=function(){this.forced=!1;this.prev=this.next=
null;this.x=this.y=0};V.__name__=!0;V.get=function(a,b){var c;null==V.zpp_pool?c=new V:(c=V.zpp_pool,V.zpp_pool=c.next,c.next=null);c.forced=!1;c.x=a;c.y=b;return c};V.prototype={__class__:V};var yf=function(a){this.outer=this.vertices=null;this.outer=a};yf.__name__=!0;yf.prototype={__class__:yf};var z=function(){};z.__name__=!0;z.bisector=function(a){var b=a.prev,c=a.next,d=0,e=0,d=a.x-b.x,e=a.y-b.y,f=b=0,b=c.x-a.x,f=c.y-a.y,a=G.get(-e-f,d+b,null),c=1/Math.sqrt(a.x*a.x+a.y*a.y);a.x*=c;a.y*=c;0>f*
d-b*e&&(a.x=-a.x,a.y=-a.y);return a};z.below=function(a,b){if(a.y<b.y)return!0;if(a.y>b.y)return!1;if(a.x<b.x)return!0;if(a.x>b.x)return!1;var c=z.bisector(a),d=z.bisector(b);c.x+=1*a.x;c.y+=1*a.y;d.x+=1*b.x;d.y+=1*b.y;var e=c.x<d.x||c.x==d.x&&c.y<d.y;null!=c.outer&&(c.outer.zpp_inner=null,c.outer=null);c._isimmutable=null;c._validate=null;c._invalidate=null;c.next=G.zpp_pool;G.zpp_pool=c;null!=d.outer&&(d.outer.zpp_inner=null,d.outer=null);d._isimmutable=null;d._validate=null;d._invalidate=null;
d.next=G.zpp_pool;G.zpp_pool=d;return e};z.above=function(a,b){return z.below(b,a)};z.left_vertex=function(a){var b=a.prev;return b.y>a.y||b.y==a.y&&a.next.y<a.y};z.decompose=function(a,b){null==b?b=new T(a):b.init(a);if(null==b.vertices)return b;null==z.queue&&(z.queue=new Pc);var c=b.vertices,d=b.vertices;if(null!=c){do{var e=c;z.queue.add(e);var f=0,h=0,f=e.next.x-e.x,h=e.next.y-e.y,m=0,g=0,m=e.prev.x-e.x,g=e.prev.y-e.y,f=0<g*f-m*h;e.type=z.below(e.prev,e)?z.below(e.next,e)?f?0:3:4:z.below(e,e.next)?
f?1:2:4;c=c.next}while(c!=d)}d=z.queue;if(null!=d.head&&null!=d.head.next){var c=d.head,m=h=f=e=null,g=1,i,v,k;do{i=0;f=c;for(e=c=null;null!=f;){i++;h=f;v=0;for(k=g;null!=h&&v<g;)v++,h=h.next;for(;0<v||0<k&&null!=h;)0==v?(m=h,h=h.next,k--):0==k||null==h?(m=f,f=f.next,v--):z.above(f.elt,h.elt)?(m=f,f=f.next,v--):(m=h,h=h.next,k--),null!=e?e.next=m:c=m,e=m;f=h}e.next=null;g<<=1}while(1<i);d.head=c;d.modified=!0;d.pushmod=!0}null==z.edges&&(null==L.zpp_pool?z.edges=new L:(z.edges=L.zpp_pool,L.zpp_pool=
z.edges.next,z.edges.next=null),null,z.edges.lt=y.edge_lt,z.edges.swapped=y.edge_swap);for(;null!=z.queue.head;)switch(d=z.queue.pop_unsafe(),d.type){case 0:d.helper=d;d.node=z.edges.insert(d);break;case 1:c=d.prev;if(null==c.helper)throw new j("Fatal error (1): Polygon is not weakly-simple and clockwise");2==c.helper.type&&b.add_diagonal(d,c.helper);z.edges.remove_node(c.node);c.helper=null;break;case 3:c=null;if(!z.edges.empty()){for(e=z.edges.parent;null!=e.prev;)e=e.prev;for(;null!=e;){f=e.data;
if(!y.vert_lt(f,d)){c=f;break}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}if(null!=c){if(null==c.helper)throw new j("Fatal error (2): Polygon is not weakly-simple and clockwise");b.add_diagonal(d,c.helper);c.helper=d}d.node=z.edges.insert(d);d.helper=d;break;case 2:c=d.prev;if(null==c.helper)throw new j("Fatal error (3): Polygon is not weakly-simple and clockwise");2==c.helper.type&&b.add_diagonal(d,c.helper);z.edges.remove_node(c.node);
c=c.helper=null;if(!z.edges.empty()){for(e=z.edges.parent;null!=e.prev;)e=e.prev;for(;null!=e;){f=e.data;if(!y.vert_lt(f,d)){c=f;break}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}if(null!=c){if(null==c.helper)throw new j("Fatal error (4): Polygon is not weakly-simple and clockwise");2==c.helper.type&&b.add_diagonal(d,c.helper);c.helper=d}break;case 4:if(c=d.prev,z.left_vertex(d)){if(null==c.helper)throw new j("Fatal error (5): Polygon is not weakly-simple and clockwise");
2==c.helper.type&&b.add_diagonal(d,c.helper);z.edges.remove_node(c.node);c.helper=null;d.node=z.edges.insert(d);d.helper=d}else{c=null;if(!z.edges.empty()){for(e=z.edges.parent;null!=e.prev;)e=e.prev;for(;null!=e;){f=e.data;if(!y.vert_lt(f,d)){c=f;break}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}if(null==c||null==c.helper)throw new j("Fatal error (6): Polygon is not weakly-simple and clockwise");2==c.helper.type&&b.add_diagonal(d,
c.helper);c.helper=d}}return b};var y=function(){this.next=this.prev=this.node=null;this.rightchain=!1;this.helper=null;this.type=0;this.diagonals=null;this.forced=!1;this.id=this.mag=this.x=this.y=0;this.id=y.nextId++;this.diagonals=new Pc};y.__name__=!0;y.get=function(a){var b;null==y.zpp_pool?b=new y:(b=y.zpp_pool,y.zpp_pool=b.next,b.next=null);null;b.x=a.x;b.y=a.y;return b};y.rightdistance=function(a,b){var c=a.next.y>a.y,d=0,e=0,d=a.next.x-a.x,e=a.next.y-a.y,f=0,h=0,f=b.x-a.x,h=b.y-a.y;return(c?
-1:1)*(h*d-f*e)};y.vert_lt=function(a,b){var c;if(b==a||b==a.next)c=!0;else if(a.y==a.next.y){c=a.x;var d=a.next.x;c=(c<d?c:d)<=b.x}else c=0>=y.rightdistance(a,b);return c};y.edge_swap=function(a,b){var c=a.node;a.node=b.node;b.node=c};y.edge_lt=function(a,b){if(a==b&&a.next==b.next)return!1;if(a==b.next)return!y.vert_lt(a,b);if(b==a.next)return y.vert_lt(b,a);if(a.y==a.next.y)return b.y==b.next.y?function(){var b=a.x,c=a.next.x;return b>c?b:c}(this)>function(){var a=b.x,c=b.next.x;return a>c?a:c}(this):
0<y.rightdistance(b,a)||0<y.rightdistance(b,a.next);var c=y.rightdistance(a,b),d=y.rightdistance(a,b.next);if(0==c&&0==d)return function(){var b=a.x,c=a.next.x;return b>c?b:c}(this)>function(){var a=b.x,c=b.next.x;return a>c?a:c}(this);if(0<=c*d)return 0>c||0>d;c=y.rightdistance(b,a);d=y.rightdistance(b,a.next);return 0<=c*d?0<c||0<d:!1};y.prototype={copy:function(){var a;null==y.zpp_pool?a=new y:(a=y.zpp_pool,y.zpp_pool=a.next,a.next=null);null;a.x=this.x;a.y=this.y;a.forced=this.forced;return a},
sort:function(){var a=0,b=0,c=0,d=0,e,a=this.prev.x-this.x,b=this.prev.y-this.y,c=this.next.x-this.x,d=this.next.y-this.y;e=d*a-c*b;e=0<e?-1:0==e?0:1;var f=this.diagonals;if(null!=f.head&&null!=f.head.next){var h=f.head,m=null,g=null,i=null,j=null,k=1,n,o,s;do{n=0;g=h;for(m=h=null;null!=g;){n++;i=g;o=0;for(s=k;null!=i&&o<k;)o++,i=i.next;for(;0<o||0<s&&null!=i;)0==o?(j=i,i=i.next,s--):0==s||null==i?(j=g,g=g.next,o--):(1==e?1==function(e){a=g.elt.x-e.x;b=g.elt.y-e.y;c=i.elt.x-e.x;d=i.elt.y-e.y;e=d*
a-c*b;return 0<e?-1:0==e?0:1}(this):function(e){var f;a=e.prev.x-e.x;b=e.prev.y-e.y;c=g.elt.x-e.x;d=g.elt.y-e.y;f=d*a-c*b;f=0<f?-1:0==f?0:1;var h;a=e.prev.x-e.x;b=e.prev.y-e.y;c=i.elt.x-e.x;d=i.elt.y-e.y;h=d*a-c*b;h=0<h?-1:0==h?0:1;return 1==f*h||0==f*h&&(1==f||1==h)?1==function(e){a=g.elt.x-e.x;b=g.elt.y-e.y;c=i.elt.x-e.x;d=i.elt.y-e.y;e=d*a-c*b;return 0<e?-1:0==e?0:1}(e):-1==f||-1==h?-1==h:0==f&&0==h?function(e){a=e.x-e.prev.x;b=e.y-e.prev.y;c=g.elt.x-e.x;d=g.elt.y-e.y;var f=a*c+b*d;c=i.elt.x-e.x;
d=i.elt.y-e.y;e=a*c+b*d;return 0>f&&0<e?!0:0>e&&0<f?!1:!0}(e):!0}(this))?(j=g,g=g.next,o--):(j=i,i=i.next,s--),null!=m?m.next=j:h=j,m=j;g=i}m.next=null;k<<=1}while(1<n);f.head=h;f.modified=!0;f.pushmod=!0}},__class__:y};var T=function(a){this.vertices=this.next=null;this.init(a)};T.__name__=!0;T.prototype={eq:function(a,b){return Qa.vec_dsq(a.x,a.y,b.x,b.y)<k.epsilon*k.epsilon},init:function(a){if(null!=a){var b;b=0;if(null!=a){var c=a;do{var d=c;b+=d.x*(d.next.y-d.prev.y);c=c.next}while(c!=a)}b=
0<0.5*b;c=a;do b?(d=y.get(c),null==this.vertices?this.vertices=d.prev=d.next=d:(d.prev=this.vertices,d.next=this.vertices.next,this.vertices.next.prev=d,this.vertices.next=d)):(d=y.get(c),null==this.vertices?this.vertices=d.prev=d.next=d:(d.next=this.vertices,d.prev=this.vertices.prev,this.vertices.prev.next=d,this.vertices.prev=d)),this.vertices=d,this.vertices.forced=c.forced,c=c.next;while(c!=a);this.remove_collinear_vertices()}},remove_collinear_vertices:function(){for(var a=this.vertices,b=!0;b||
a!=this.vertices;)if(b=!1,this.eq(a,a.next)){a==this.vertices&&(this.vertices=a.next,b=!0);a.forced&&(a.next.forced=!0);if(null!=a&&a.prev==a)a.next=a.prev=null,a.helper=null,null,a.next=y.zpp_pool,y.zpp_pool=a,a=a=null;else{var c=a.next;a.prev.next=a.next;a.next.prev=a.prev;a.next=a.prev=null;a.helper=null;null;a.next=y.zpp_pool;y.zpp_pool=a;a=c}if(null==a){this.vertices=null;break}}else a=a.next;if(null==this.vertices)return!0;do{c=!1;a=this.vertices;for(b=!0;b||a!=this.vertices;){var b=!1,d=a.prev,
e=0,f=0,e=a.x-d.x,f=a.y-d.y,h=d=0,d=a.next.x-a.x,h=a.next.y-a.y,e=h*e-d*f;if(e*e>=k.epsilon*k.epsilon)a=a.next;else if(a==this.vertices&&(this.vertices=a.next,b=!0),null!=a&&a.prev==a?(a.next=a.prev=null,a.helper=null,null,a.next=y.zpp_pool,y.zpp_pool=a,a=a=null):(c=a.next,a.prev.next=a.next,a.next.prev=a.prev,a.next=a.prev=null,a.helper=null,null,a.next=y.zpp_pool,y.zpp_pool=a,a=c),c=!0,null==a){c=!1;this.vertices=null;break}}}while(c);return null==this.vertices},add_diagonal:function(a,b){a.diagonals.add(b);
b.diagonals.add(a);a.forced=b.forced=!0},extract_partitions:function(a){null==a&&(a=new je);if(null!=this.vertices){var b=this.vertices,c=this.vertices;if(null!=b){do b.sort(),b=b.next;while(b!=c)}for(this.pull_partitions(this.vertices,a);null!=this.vertices;)null!=this.vertices&&this.vertices.prev==this.vertices?(this.vertices.next=this.vertices.prev=null,c=this.vertices,c.helper=null,null,c.next=y.zpp_pool,y.zpp_pool=c,this.vertices=this.vertices=null):(c=this.vertices.next,this.vertices.prev.next=
this.vertices.next,this.vertices.next.prev=this.vertices.prev,this.vertices.next=this.vertices.prev=null,b=this.vertices,b.helper=null,null,b.next=y.zpp_pool,y.zpp_pool=b,this.vertices=null,this.vertices=c);c=null;for(b=a.head;null!=b;)b.elt.remove_collinear_vertices()?a.erase(c):(c=b,b=b.next)}return a},pull_partitions:function(a,b){var c;null==T.zpp_pool?c=new T:(c=T.zpp_pool,T.zpp_pool=c.next,c.next=null);null;var d=a;do{var e=d.copy();null==c.vertices?c.vertices=e.prev=e.next=e:(e.prev=c.vertices,
e.next=c.vertices.next,c.vertices.next.prev=e,c.vertices.next=e);c.vertices=e;c.vertices.forced=d.forced;if(null!=d.diagonals.head)if(d.diagonals.inlined_pop_unsafe()==a)break;else d=this.pull_partitions(d,b);else d=d.next}while(d!=a);var e=0,f=c.vertices,h=c.vertices;if(null!=f){do var g=f,e=e+g.x*(g.next.y-g.prev.y),f=f.next;while(f!=h)}0!=0.5*e&&b.add(c);return d},extract:function(a){null==a&&(a=new ve);if(null!=this.vertices){var b=this.vertices,c=this.vertices;if(null!=b){do b.sort(),b=b.next;
while(b!=c)}for(this.pull(this.vertices,a);null!=this.vertices;)null!=this.vertices&&this.vertices.prev==this.vertices?(this.vertices.next=this.vertices.prev=null,c=this.vertices,c.helper=null,null,c.next=y.zpp_pool,y.zpp_pool=c,this.vertices=this.vertices=null):(c=this.vertices.next,this.vertices.prev.next=this.vertices.next,this.vertices.next.prev=this.vertices.prev,this.vertices.next=this.vertices.prev=null,b=this.vertices,b.helper=null,null,b.next=y.zpp_pool,y.zpp_pool=b,this.vertices=null,this.vertices=
c)}return a},pull:function(a,b){var c=null,d=a;do{var e=V.get(d.x,d.y);null==c?e.prev=e.next=e:(e.prev=c,e.next=c.next,c.next.prev=e,c.next=e);c=e;c.forced=d.forced;if(null!=d.diagonals.head)if(d.diagonals.inlined_pop_unsafe()==a)break;else d=this.pull(d,b);else d=d.next}while(d!=a);var e=0,f=c,h=c;if(null!=f){do var g=f,e=e+g.x*(g.next.y-g.prev.y),f=f.next;while(f!=h)}e*=0.5;if(e*e>=k.epsilon*k.epsilon){e=c;for(h=!0;h||e!=c;)if(h=!1,Qa.vec_dsq(e.x,e.y,e.next.x,e.next.y)<k.epsilon*k.epsilon){if(e==
c&&(c=e.next,h=!0),e.forced&&(e.next.forced=!0),null!=e&&e.prev==e?e=e=e.next=e.prev=null:(f=e.next,e.prev.next=e.next,e.next.prev=e.prev,e.next=e.prev=null,e=f),null==e){c=null;break}}else e=e.next;if(null!=c){do{f=!1;e=c;for(h=!0;h||e!=c;){var h=!1,i=e.prev,j=g=0,g=e.x-i.x,j=e.y-i.y,v=i=0,i=e.next.x-e.x,v=e.next.y-e.y,g=v*g-i*j;if(g*g>=k.epsilon*k.epsilon)e=e.next;else if(e==c&&(c=e.next,h=!0),null!=e&&e.prev==e?e=e=e.next=e.prev=null:(f=e.next,e.prev.next=e.next,e.next.prev=e.prev,e.next=e.prev=
null,e=f),f=!0,null==e){f=!1;c=null;break}}}while(f)}null==c||b.add(c)}return d},__class__:T};var sa=function(){this.flag=this.forced=!1;this.next=this.prev=null;this.x=this.y=0};sa.__name__=!0;sa.get=function(a){var b;null==sa.zpp_pool?b=new sa:(b=sa.zpp_pool,sa.zpp_pool=b.next,b.next=null);null;b.x=a.x;b.y=a.y;b.flag=!1;return b};sa.prototype={__class__:sa};var ta=function(){this.next=this.min=this.max=null};ta.__name__=!0;ta.get=function(a,b){var c;null==ta.zpp_pool?c=new ta:(c=ta.zpp_pool,ta.zpp_pool=
c.next,c.next=null);null;c.min=a;c.max=b;return c};ta.prototype={__class__:ta};var za=function(){};za.__name__=!0;za.distance=function(a,b,c){var d=0,e=0,d=c.x-b.x,e=c.y-b.y,f=0,h=0,f=a.x-b.x,h=a.y-b.y;if(0==d*d+e*e)return f*f+h*h;b=(f*d+h*e)/(d*d+e*e);if(0>=b)return f*f+h*h;if(1<=b)return Qa.vec_dsq(a.x,a.y,c.x,c.y);f-=d*b;h-=e*b;return f*f+h*h};za.simplify=function(a,b){var c=null,d=null,e=null,b=b*b;null==za.stack&&(za.stack=new Nf);var f=null,h=null,g=a;do{var i=sa.get(g);i.forced=g.forced;i.forced&&
(i.flag=!0,null!=f?za.stack.add(ta.get(f,i)):h=i,f=i);null==c?i.prev=i.next=i:(i.prev=c,i.next=c.next,c.next.prev=i,c.next=i);c=i;null==d?e=d=c:(0>c.x-d.x+(c.y-d.y)&&(d=c),0>e.x-c.x+(e.y-c.y)&&(e=c));g=g.next}while(g!=a);null==za.stack.head?null==h?(d.flag=e.flag=!0,za.stack.add(ta.get(d,e)),za.stack.add(ta.get(e,d))):(f=d.x-h.x+(d.y-h.y),0>f&&(f=-f),g=e.x-h.x+(e.y-h.y),0>g&&(g=-g),f>g?(d.flag=h.flag=!0,za.stack.add(ta.get(d,h)),za.stack.add(ta.get(h,d))):(e.flag=h.flag=!0,za.stack.add(ta.get(e,h)),
za.stack.add(ta.get(h,e)))):za.stack.add(ta.get(f,h));for(;null!=za.stack.head;){h=za.stack.pop_unsafe();d=h.min;e=h.max;h.min=h.max=null;h.next=ta.zpp_pool;ta.zpp_pool=h;h=b;f=null;for(g=d.next;g!=e;)i=za.distance(g,d,e),i>h&&(h=i,f=g),g=g.next;null!=f&&(f.flag=!0,za.stack.add(ta.get(d,f)),za.stack.add(ta.get(f,e)))}for(d=null;null!=c;)c.flag&&(e=V.get(c.x,c.y),null==d?e.prev=e.next=e:(e.prev=d,e.next=d.next,d.next.prev=e,d.next=e),d=e,d.forced=c.forced),null!=c&&c.prev==c?(c.next=c.prev=null,c.next=
sa.zpp_pool,sa.zpp_pool=c,c=c=null):(e=c.next,c.prev.next=c.next,c.next.prev=c.prev,c.next=c.prev=null,c.next=sa.zpp_pool,sa.zpp_pool=c,c=e);return d};var Ba=function(){this.slipped=this.failed=this.kinematic=!1;this.c1=this.c2=this.axis=null;this.frozen1=this.frozen2=!1;this.s1=this.s2=this.arbiter=null;this.toi=0;this.next=null;this.c1=new G;this.c2=new G;this.axis=new G};Ba.__name__=!0;Ba.prototype={__class__:Ba};var Zb=function(){};Zb.__name__=!0;Zb.dynamicSweep=function(a,b,c,d,e){null==e&&(e=
!1);var f=a.s1,h=a.s2,g=f.body,i=h.body,j=0,v=0,j=i.velx-g.velx,v=i.vely-g.vely,n=g.angvel;0>n&&(n=-n);var q=i.angvel;0>q&&(q=-q);var o=f.sweepCoef*n+h.sweepCoef*q;if(!e&&!a.kinematic&&j*j+v*v<k.dynamicSweepLinearThreshold*k.dynamicSweepLinearThreshold&&o<k.dynamicSweepAngularThreshold)a.toi=-1,a.failed=!0;else{for(var s=a.c1,n=a.c2,q=a.axis,r=0;;){g.sweepIntegrate(c*b);g.sweepValidate(f);i.sweepIntegrate(c*b);i.sweepValidate(h);var u=Zb.distance(f,h,s,n,q,null)+d,w=j*q.x+v*q.y;if(u<k.distanceThresholdCCD){if(e)break;
var t=0,y=0,t=s.x-g.posx,y=s.y-g.posy,z=0,B=0,z=n.x-i.posx,B=n.y-i.posy,t=w-g.sweep_angvel*(q.y*t-q.x*y)+i.sweep_angvel*(q.y*z-q.x*B);0<t&&(a.slipped=!0);if(0>=t||u<0.5*k.distanceThresholdCCD)break}w=(o-w)*b;if(0>=w){c=-1;break}w=u/w;1.0E-6>w&&(w=1.0E-6);c+=w;if(1<=c){c=1;g.sweepIntegrate(c*b);g.sweepValidate(f);i.sweepIntegrate(c*b);i.sweepValidate(h);b=Zb.distance(f,h,s,n,q,null)+d;j=j*q.x+v*q.y;if(b<k.distanceThresholdCCD){if(e)break;v=e=0;e=s.x-g.posx;v=s.y-g.posy;d=s=0;s=n.x-i.posx;d=n.y-i.posy;
g=j-g.sweep_angvel*(q.y*e-q.x*v)+i.sweep_angvel*(q.y*s-q.x*d);0<g&&(a.slipped=!0);if(0>=g||b<0.5*k.distanceThresholdCCD)break}c=-1;break}if(40<=++r){u>d&&(a.failed=!0);break}}a.toi=c}};Zb.staticSweep=function(a,b,c,d){var e=a.s1,f=a.s2,h=e.body,g=0,i=0,g=-h.velx,i=-h.vely,j=h.sweep_angvel;0>j&&(j=-j);for(var v=e.sweepCoef*j,j=a.c1,n=a.c2,q=a.axis,o=0;;){h.sweepIntegrate(c*b);h.sweepValidate(e);var s=Zb.distance(e,f,j,n,q,null)+d,r=g*q.x+i*q.y;if(s<k.distanceThresholdCCD){var u=0,w=0,u=j.x-h.posx,
w=j.y-h.posy,u=r-h.sweep_angvel*(q.y*u-q.x*w);0<u&&(a.slipped=!0);if(0>=u||s<0.5*k.distanceThresholdCCD)break}r=(v-r)*b;if(0>=r){c=-1;break}r=s/r;1.0E-6>r&&(r=1.0E-6);c+=r;if(1<=c){c=1;h.sweepIntegrate(c*b);h.sweepValidate(e);b=Zb.distance(e,f,j,n,q,null)+d;g=g*q.x+i*q.y;if(b<k.distanceThresholdCCD&&(d=i=0,i=j.x-h.posx,d=j.y-h.posy,h=g-h.sweep_angvel*(q.y*i-q.x*d),0<h&&(a.slipped=!0),0>=h||b<0.5*k.distanceThresholdCCD))break;c=-1;break}if(40<=++o){s>d&&(a.failed=!0);break}}a.toi=c};Zb.distance=function(a,
b,c,d,e,f){null==f&&(f=1.0E100);if(a.type==i.id_ShapeType_CIRCLE&&b.type==i.id_ShapeType_CIRCLE){var h=a.circle,g=b.circle,l,j=0,v=0,j=g.worldCOMx-h.worldCOMx,v=g.worldCOMy-h.worldCOMy,n=Math.sqrt(j*j+v*v);l=n-(h.radius+g.radius);if(l<f){if(0==n)j=1,v=0;else var q=1/n,j=j*q,v=v*q;var o=h.radius;c.x=h.worldCOMx+j*o;c.y=h.worldCOMy+v*o;var s=-g.radius;d.x=g.worldCOMx+j*s;d.y=g.worldCOMy+v*s;e.x=j;e.y=v}return l}var r=!1;if(a.type==i.id_ShapeType_CIRCLE&&b.type==i.id_ShapeType_POLYGON)var u=a,a=b,b=
u,w=c,c=d,d=w,r=!0;if(a.type==i.id_ShapeType_POLYGON&&b.type==i.id_ShapeType_CIRCLE){for(var t=b.circle,y=-1.0E100,z=null,B=a.polygon.edges.head;null!=B;){var D=B.elt,F=D.gnormx*t.worldCOMx+D.gnormy*t.worldCOMy-D.gprojection-t.radius;if(F>f){y=F;break}0<F?F>y&&(y=F,z=D):0>y&&F>y&&(y=F,z=D);B=B.next}if(y<f){var E=z.gp0,C=z.gp1,H=t.worldCOMy*z.gnormx-t.worldCOMx*z.gnormy;if(H<=E.y*z.gnormx-E.x*z.gnormy){var G=0,O=0,G=t.worldCOMx-E.x,O=t.worldCOMy-E.y,J=Math.sqrt(G*G+O*O),y=J-t.radius;if(y<f){if(0==
J)G=1,O=0;else var M=1/J,G=G*M,O=O*M;c.x=E.x+0*G;c.y=E.y+0*O;var R=-t.radius;d.x=t.worldCOMx+G*R;d.y=t.worldCOMy+O*R;e.x=G;e.y=O}}else if(H>=C.y*z.gnormx-C.x*z.gnormy){var I=0,K=0,I=t.worldCOMx-C.x,K=t.worldCOMy-C.y,Q=Math.sqrt(I*I+K*K),y=Q-t.radius;if(y<f){if(0==Q)I=1,K=0;else var S=1/Q,I=I*S,K=K*S;c.x=C.x+0*I;c.y=C.y+0*K;var ba=-t.radius;d.x=t.worldCOMx+I*ba;d.y=t.worldCOMy+K*ba;e.x=I;e.y=K}}else{var ha=-t.radius;d.x=t.worldCOMx+z.gnormx*ha;d.y=t.worldCOMy+z.gnormy*ha;var ca=-y;c.x=d.x+z.gnormx*
ca;c.y=d.y+z.gnormy*ca;e.x=z.gnormx;e.y=z.gnormy}}r&&(e.x=-e.x,e.y=-e.y);return y}for(var aa=a.polygon,$=b.polygon,Oa=-1.0E100,ea=null,X=null,W=0,U=aa.edges.head;null!=U;){for(var T=U.elt,N=1.0E100,Y=$.gverts.next;null!=Y;){var ra=Y,Ba=T.gnormx*ra.x+T.gnormy*ra.y;Ba<N&&(N=Ba);Y=Y.next}N-=T.gprojection;if(N>f){Oa=N;break}0<N?N>Oa&&(Oa=N,ea=T,W=1):0>Oa&&N>Oa&&(Oa=N,ea=T,W=1);U=U.next}if(Oa<f){for(var ma=$.edges.head;null!=ma;){for(var ka=ma.elt,p=1.0E100,Ja=aa.gverts.next;null!=Ja;){var za=Ja,qa=ka.gnormx*
za.x+ka.gnormy*za.y;qa<p&&(p=qa);Ja=Ja.next}p-=ka.gprojection;if(p>f){Oa=p;break}0<p?p>Oa&&(Oa=p,X=ka,W=2):0>Oa&&p>Oa&&(Oa=p,X=ka,W=2);ma=ma.next}if(Oa<f){var ta,da;if(1==W)ta=$,da=ea;else{ta=aa;da=X;var Ca=c,c=d,d=Ca,r=!r}for(var Z=null,Sa=1.0E100,na=ta.edges.head;null!=na;){var Pa=na.elt,Ka=da.gnormx*Pa.gnormx+da.gnormy*Pa.gnormy;Ka<Sa&&(Sa=Ka,Z=Pa);na=na.next}r?(e.x=-da.gnormx,e.y=-da.gnormy):(e.x=da.gnormx,e.y=da.gnormy);if(0<=Oa){var sb=da.gp0,ga=da.gp1,tb=Z.gp0,L=Z.gp1,Ga=0,ia=0,ja=0,fa=0,Ga=
ga.x-sb.x,ia=ga.y-sb.y,ja=L.x-tb.x,fa=L.y-tb.y,la=1/(Ga*Ga+ia*ia),V=1/(ja*ja+fa*fa),oa=-(Ga*(sb.x-tb.x)+ia*(sb.y-tb.y))*la,pa=-(Ga*(sb.x-L.x)+ia*(sb.y-L.y))*la,Ea=-(ja*(tb.x-sb.x)+fa*(tb.y-sb.y))*V,Ya=-(ja*(tb.x-ga.x)+fa*(tb.y-ga.y))*V;0>oa?oa=0:1<oa&&(oa=1);0>pa?pa=0:1<pa&&(pa=1);0>Ea?Ea=0:1<Ea&&(Ea=1);0>Ya?Ya=0:1<Ya&&(Ya=1);var hb=0,La=0,Ha=oa,hb=sb.x+Ga*Ha,La=sb.y+ia*Ha,oe=0,ab=0,bb=pa,oe=sb.x+Ga*bb,ab=sb.y+ia*bb,Ia=0,va=0,x=Ea,Ia=tb.x+ja*x,va=tb.y+fa*x,wa=0,xa=0,gb=Ya,wa=tb.x+ja*gb,xa=tb.y+fa*
gb,Va=Qa.vec_dsq(hb,La,tb.x,tb.y),kb=Qa.vec_dsq(oe,ab,L.x,L.y),Za=Qa.vec_dsq(Ia,va,sb.x,sb.y),mb=Qa.vec_dsq(wa,xa,ga.x,ga.y),$a=0,Na=0,Fa=null;Va<kb?($a=hb,Na=La,Fa=tb):($a=oe,Na=ab,Fa=L,Va=kb);var Ra=0,Ua=0,ya=null;Za<mb?(Ra=Ia,Ua=va,ya=sb):(Ra=wa,Ua=xa,ya=ga,Za=mb);Va<Za?(c.x=$a,c.y=Na,d.x=Fa.x,d.y=Fa.y,Oa=Math.sqrt(Va)):(d.x=Ra,d.y=Ua,c.x=ya.x,c.y=ya.y,Oa=Math.sqrt(Za));if(0!=Oa){e.x=d.x-c.x;e.y=d.y-c.y;var Wa=1/Oa;e.x*=Wa;e.y*=Wa;r&&(e.x=-e.x,e.y=-e.y)}return Oa}var sa=0,Ma=0,sa=Z.gp0.x,Ma=Z.gp0.y,
ua=0,Da=0,ua=Z.gp1.x,Da=Z.gp1.y,wb=0,Ta=0,wb=ua-sa,Ta=Da-Ma,cb=da.gnormy*sa-da.gnormx*Ma,ub=da.gnormy*ua-da.gnormx*Da,db=1/(ub-cb),Aa=(-da.tp1-cb)*db;Aa>k.epsilon&&(sa+=wb*Aa,Ma+=Ta*Aa);var Xa=(-da.tp0-ub)*db;Xa<-k.epsilon&&(ua+=wb*Xa,Da+=Ta*Xa);var ib=sa*da.gnormx+Ma*da.gnormy-da.gprojection,xd=ua*da.gnormx+Da*da.gnormy-da.gprojection;if(ib<xd){d.x=sa;d.y=Ma;var nb=-ib;c.x=d.x+da.gnormx*nb;c.y=d.y+da.gnormy*nb;return ib}d.x=ua;d.y=Da;var fb=-xd;c.x=d.x+da.gnormx*fb;c.y=d.y+da.gnormy*fb;return xd}}return f};
var ma=function(){this.node=null;this.id=this.di=0;this.a=this.b=null;this.length=0;this._inuse=this.modified=this.pushmod=!1;this.next=null};ma.__name__=!0;ma.get=function(a,b){var c;null==ma.zpp_pool?c=new ma:(c=ma.zpp_pool,ma.zpp_pool=c.next,c.next=null);null;c.a=a;c.b=b;a.id<b.id?(c.id=a.id,c.di=b.id):(c.id=b.id,c.di=a.id);return c};ma.edge_swap=function(a,b){var c=a.node;a.node=b.node;b.node=c};ma.edge_lt=function(a,b){return a.id<b.id||a.id==b.id&&a.di<b.di};ma.prototype={add:function(a){return this.inlined_add(a)},
inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.next;this.pop();return a},__class__:ma};var F=function(){};F.__name__=!0;F.right_turn=function(a,b,c){var d=0,e=0,d=c.x-b.x,e=c.y-
b.y,f=c=0,c=b.x-a.x,f=b.y-a.y;return f*d-c*e};F.delaunay=function(a,b,c,d){var e=0,f=0,h=0,g=0,e=c.x-b.x,f=c.y-b.y,h=b.x-a.x,g=b.y-a.y;if(!(e=0<=g*e-h*f))if(e=d.x-c.x,f=d.y-c.y,h=c.x-b.x,g=c.y-b.y,!(e=0<=g*e-h*f))if(e=a.x-d.x,f=a.y-d.y,h=d.x-c.x,g=d.y-c.y,!(e=0<=g*e-h*f))e=b.x-a.x,f=b.y-a.y,h=a.x-d.x,g=a.y-d.y,e=0<=g*e-h*f;return e?!0:0<b.x*(c.y*d.mag-c.mag*d.y)-c.x*(b.y*d.mag-b.mag*d.y)+d.x*(b.y*c.mag-b.mag*c.y)-(a.x*(c.y*d.mag-c.mag*d.y)-c.x*(a.y*d.mag-a.mag*d.y)+d.x*(a.y*c.mag-a.mag*c.y))+(a.x*
(b.y*d.mag-b.mag*d.y)-b.x*(a.y*d.mag-a.mag*d.y)+d.x*(a.y*b.mag-a.mag*b.y))-(a.x*(b.y*c.mag-b.mag*c.y)-b.x*(a.y*c.mag-a.mag*c.y)+c.x*(a.y*b.mag-a.mag*b.y))};F.optimise=function(a){var b=a.vertices,c=a.vertices;if(null!=b){do{var d=b;d.sort();d.mag=d.x*d.x+d.y*d.y;b=b.next}while(b!=c)}null==F.edgeSet&&(null==Kb.zpp_pool?F.edgeSet=new Kb:(F.edgeSet=Kb.zpp_pool,Kb.zpp_pool=F.edgeSet.next,F.edgeSet.next=null),null,F.edgeSet.lt=ma.edge_lt,F.edgeSet.swapped=ma.edge_swap);null==ma.zpp_pool?c=new ma:(c=ma.zpp_pool,
ma.zpp_pool=c.next,c.next=null);null;a=b=a.vertices;if(null!=b){do{var d=b,e=d.next;d.diagonals.reverse();for(var f=d.diagonals.head;null!=f;){var h=f.elt;if(!(h.id<d.id)&&!F.delaunay(d,e,h,null==f.next?d.prev:f.next.elt))e=ma.get(d,h),c.add(e),e.node=F.edgeSet.insert(e);e=h;f=f.next}b=b.next}while(b!=a)}for(;null!=c.next;){a=c.pop_unsafe();b=a.a;h=a.b;d=b.next;f=null;for(e=b.diagonals.head;null!=e;){var g=e.elt;if(g==h){e=e.next;f=null==e?b.prev:e.elt;break}d=g;e=e.next}b.diagonals.remove(h);h.diagonals.remove(b);
if(h==d.next)d.diagonals.add(f);else for(e=d.diagonals.head;null!=e;){if(e.elt==h){d.diagonals.insert(e,f);break}e=e.next}if(b==f.next)f.diagonals.add(d);else for(h=f.diagonals.head;null!=h;){if(h.elt==b){f.diagonals.insert(h,d);break}h=h.next}F.edgeSet.remove_node(a.node);a.a=a.b=null;a.node=null;a.next=ma.zpp_pool;ma.zpp_pool=a}c.a=c.b=null;c.node=null;c.next=ma.zpp_pool;ma.zpp_pool=c};F.triangulate=function(a){var b=a.vertices,c=a.vertices,d=a.vertices.next,e=a.vertices;if(null!=d){do{var f=d;
if(f.y<b.y||f.y==b.y&&f.x<b.x)b=f;if(c.y<f.y||c.y==f.y&&c.x<f.x)c=f;d=d.next}while(d!=e)}null==F.queue&&(F.queue=new Pc);e=c.prev;d=c.next;for(F.queue.add(c);e!=b||d!=b;)e==b||d!=b&&(e.y<d.y||e.y==d.y&&e.x<d.x)?(F.queue.add(d),d.rightchain=!1,d=d.next):(F.queue.add(e),e.rightchain=!0,e=e.prev);F.queue.add(b);null==F.stack&&(F.stack=new Pc);F.stack.add(F.queue.pop_unsafe());e=F.queue.pop_unsafe();for(F.stack.add(e);;){b=F.queue.pop_unsafe();if(null==F.queue.head)break;if(b.rightchain!=F.stack.head.elt.rightchain)for(;;){d=
F.stack.pop_unsafe();if(null==F.stack.head)break;a.add_diagonal(d,b)}else for(e=F.stack.pop_unsafe();null!=F.stack.head;){d=F.stack.head.elt;f=F.right_turn(d,e,b);if(b.rightchain&&0<=f||!b.rightchain&&0>=f)break;a.add_diagonal(d,b);e=d;F.stack.pop()}F.stack.add(e);F.stack.add(b);e=b}if(null!=F.stack.head)for(F.stack.pop();null!=F.stack.head;){b=F.stack.pop_unsafe();if(null==F.stack.head)break;a.add_diagonal(c,b)}return a};var G=function(){this.length=this.x=this.y=0;this._inuse=this.modified=this.pushmod=
!1;this.next=null;this.weak=!1;this._isimmutable=this.outer=null;this._immutable=!1;this._invalidate=this._validate=null};G.__name__=!0;G.get=function(a,b,c){null==c&&(c=!1);var d;null==G.zpp_pool?d=new G:(d=G.zpp_pool,G.zpp_pool=d.next,d.next=null);d.weak=!1;d._immutable=c;d.x=a;d.y=b;return d};G.prototype={validate:function(){null!=this._validate&&this._validate()},invalidate:function(){null!=this._invalidate&&this._invalidate(this)},immutable:function(){if(this._immutable)throw new j("Error: Vec2 is immutable");
null!=this._isimmutable&&this._isimmutable()},wrapper:function(){if(null==this.outer){this.outer=new K;var a=this.outer.zpp_inner;null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=G.zpp_pool;G.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},add:function(a){return this.inlined_add(a)},inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,
b)},inlined_insert:function(a,b){b._inuse=!0;null==a?(b.next=this.next,this.next=b):(b.next=a.next,a.next=b);this.pushmod=this.modified=!0;this.length++;return b},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},reverse:function(){for(var a=this.next,b=null;null!=a;){var c=
a.next;a.next=b;b=this.next=a;a=c}this.pushmod=this.modified=!0},iterator_at:function(a){for(var b=this.next;0<a--&&null!=b;)b=b.next;return b},toString:function(){return"{ x: "+this.x+" y: "+this.y+" }"},__class__:G};var Qa=function(){};Qa.__name__=!0;Qa.vec_dsq=function(a,b,c,d){var e=0,f=0,e=a-c,f=b-d;return e*e+f*f};var ha=function(){this.ishape=this.ibody=this.icompound=this.cbsets=this.group=this.cbTypes=this.cbSet=null;this.id=0;this.outer_i=null;this.id=db.Interactor();this.cbsets=new Of;
this.cbTypes=new vc};ha.__name__=!0;ha.get=function(a,b){var c;c=a.id<b.id?a.id:b.id;var d;d=a.id<b.id?b.id:a.id;for(var e=null,f=(a.cbsets.length<b.cbsets.length?a.cbsets:b.cbsets).head;null!=f;){var h=f.elt;if(h.id==c&&h.di==d){e=h;break}f=f.next}return e};ha.int_callback=function(a,b,c){var d=a.int1,a=a.int2;b.options1.compatible(d.cbTypes)&&b.options2.compatible(a.cbTypes)?(c.int1=d,c.int2=a):(c.int1=a,c.int2=d)};ha.prototype={__iaddedToSpace:function(){null!=this.group&&this.group.interactors.add(this);
for(var a=this.cbTypes.head;null!=a;)a.elt.interactors.add(this),a=a.next;this.alloc_cbSet()},__iremovedFromSpace:function(){null!=this.group&&this.group.interactors.remove(this);for(var a=this.cbTypes.head;null!=a;)a.elt.interactors.remove(this),a=a.next;this.dealloc_cbSet()},wake:function(){if(null!=this.ishape){var a=this.ishape.body;null!=a&&null!=a.space&&a.space.non_inlined_wake(a);!0}else null!=this.ibody?null!=this.ibody.space?this.ibody.space.non_inlined_wake(this.ibody):!1:(null!=this.icompound.space&&
this.icompound.space.wakeCompound(this.icompound),!0)},insert_cbtype:function(a){if(!this.cbTypes.has(a)){var b;b=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space;null!=b&&(this.dealloc_cbSet(),a.interactors.add(this));for(var c=null,d=this.cbTypes.head;null!=d&&!(a.id<d.elt.id);){c=d;d=d.next}this.cbTypes.inlined_insert(c,a);null!=b&&(this.alloc_cbSet(),this.wake())}},alloc_cbSet:function(){var a;a=null!=this.ishape?null==
this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space;if(null!=(this.cbSet=a.cbsets.get(this.cbTypes)))this.cbSet.count++,this.cbSet.interactors.add(this),this.cbSet.validate(),a.freshInteractorType(this)},dealloc_cbSet:function(){var a;a=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space;null!=this.cbSet&&(this.cbSet.interactors.remove(this),a.nullInteractorType(this),0==--this.cbSet.count&&
(a.cbsets.remove(this.cbSet),a=this.cbSet,a.free(),a.next=aa.zpp_pool,aa.zpp_pool=a),this.cbSet=null)},immutable_midstep:function(a){null!=this.ibody?this.ibody.__immutable_midstep(a):null!=this.ishape?this.ishape.__immutable_midstep(a):this.icompound.__imutable_midstep(a)},lookup_group:function(){for(var a=this;null!=a&&null==a.group;)a=null!=a.ishape?a.ishape.body:null!=a.icompound?a.icompound.compound:a.ibody.compound;return null==a?null:a.group},__class__:ha};var rb=function(){this.wrap_localCOM=
this.wrap_worldCOM=null;this.zip_worldCOM=!1;this.worldCOMx=this.worldCOMy=0;this.zip_localCOM=!1;this.localCOMx=this.localCOMy=0;this.zip_aabb=!1;this.aabb=null;this.norotate=!1;this.cinertia=this.iinertia=this.sinertia=0;this.zip_inertia=!1;this.inertiaMode=this.inertia=0;this.zip_gravMassScale=!1;this.gravMassMode=this.gravMassScale=0;this.zip_gravMass=!1;this.gravMass=0;this.nomove=!1;this.massMode=this.imass=this.smass=this.cmass=0;this.zip_mass=!1;this.mass=0;this.zip_axis=!1;this.forcex=this.forcey=
this.kinvelx=this.kinvely=this.svelx=this.svely=this.angvel=this.torque=this.kinangvel=this.pre_rot=this.rot=this.axisx=this.axisy=0;this.wrap_vel=null;this.velx=this.vely=0;this.wrap_pos=null;this.pre_posx=this.pre_posy=this.posx=this.posy=0;this.bullet=this.bulletEnabled=this.disableCCD=!1;this.sweepRadius=0;this.sweepFrozen=!1;this.sweepTime=this.sweep_angvel=0;this.compound=this.shapes=this.wrap_shapes=this.space=this.arbiters=this.constraints=this.component=null;this.type=0;this.world=!1;this.outer=
null;ha.call(this);this.ibody=this;this.bulletEnabled=this.world=!1;this.sweep_angvel=this.sweepTime=0;this.disableCCD=this.norotate=this.nomove=!1;this.axisx=this.rot=this.posy=this.posx=0;this.axisy=1;this.torque=this.angvel=this.kinangvel=this.forcey=this.forcex=this.kinvely=this.kinvelx=this.vely=this.velx=this.svely=this.svelx=0;this.pre_rot=this.pre_posy=this.pre_posx=Infinity;this.worldCOMy=this.worldCOMx=this.localCOMy=this.localCOMx=0;this.zip_aabb=!0;this.aabb=ra.get(0,0,0,0);this.aabb._immutable=
!0;this.aabb._validate=E(this,this.aabb_validate);this.massMode=i.id_MassMode_DEFAULT;this.gravMassMode=i.id_GravMassMode_DEFAULT;this.gravMassScale=1;this.inertiaMode=i.id_InertiaMode_DEFAULT;this.arbiters=new Pd;this.constraints=new Ic;this.shapes=new Mc;this.wrap_shapes=tc.get(this.shapes);this.wrap_shapes.zpp_inner.adder=E(this,this.shapes_adder);this.wrap_shapes.zpp_inner.subber=E(this,this.shapes_subber);this.wrap_shapes.zpp_inner._invalidate=E(this,this.shapes_invalidate);this.wrap_shapes.zpp_inner._modifiable=
E(this,this.shapes_modifiable);this.kinematicDelaySleep=!1};rb.__name__=!0;rb.__static=function(){var a=Bc;null==i.BodyType_STATIC&&(i.internal=!0,i.BodyType_STATIC=new ab,i.internal=!1);var a=new a(i.BodyType_STATIC),b=a.zpp_inner;b.world=!0;b.wrap_shapes.zpp_inner.immutable=!0;b.smass=b.imass=b.cmass=b.mass=b.gravMass=0;b.sinertia=b.iinertia=b.cinertia=b.inertia=0;b.cbTypes.clear();return a};rb.__super__=ha;rb.prototype=r(ha.prototype,{invalidate_type:function(){this.invalidate_mass();this.invalidate_inertia()},
invalidate_shapes:function(){this.zip_worldCOM=this.zip_localCOM=this.zip_aabb=!0;this.invalidate_mass();this.invalidate_inertia()},atRest:function(a){if(this.type!=i.id_BodyType_DYNAMIC)return this.component.sleeping;var b=k.linearSleepThreshold,b=b*b;if(this.velx*this.velx+this.vely*this.vely>b)a=!1;else if(Qa.vec_dsq(this.posx,this.posy,this.pre_posx,this.pre_posy)>0.25*b*a*a)a=!1;else{var c=b=0,b=this.aabb.maxx-this.aabb.minx,c=this.aabb.maxy-this.aabb.miny,b=b*b+c*c,c=k.angularSleepThreshold,
c=c*c;if(4*this.angvel*this.angvel*b>c)a=!1;else var d=this.rot-this.pre_rot,a=d*d*b>c*a*a?!1:!0}a||(this.component.waket=this.space.stamp);return this.component.waket+k.sleepDelay<this.space.stamp},refreshArbiters:function(){for(var a=this.arbiters.head;null!=a;)a.elt.invalidated=!0,a=a.next},sweepIntegrate:function(a){var b=a-this.sweepTime;0!=b&&(this.sweepTime=a,this.posx+=this.velx*b,this.posy+=this.vely*b,0!=this.angvel&&this.delta_rot(this.sweep_angvel*b))},sweepValidate:function(a){if(a.type==
i.id_ShapeType_CIRCLE)a.worldCOMx=this.posx+(this.axisy*a.localCOMx-this.axisx*a.localCOMy),a.worldCOMy=this.posy+(a.localCOMx*this.axisx+a.localCOMy*this.axisy);else{for(var a=a.polygon,b=a.lverts.next,c=a.gverts.next;null!=c;){var d=c,e=b,b=b.next;d.x=this.posx+(this.axisy*e.x-this.axisx*e.y);d.y=this.posy+(e.x*this.axisx+e.y*this.axisy);c=c.next}c=a.edges.head;b=d=a.gverts.next;for(d=d.next;null!=d;){var e=d,f=c.elt,c=c.next;f.gnormx=this.axisy*f.lnormx-this.axisx*f.lnormy;f.gnormy=f.lnormx*this.axisx+
f.lnormy*this.axisy;f.gprojection=this.posx*f.gnormx+this.posy*f.gnormy+f.lprojection;f.tp0=b.y*f.gnormx-b.x*f.gnormy;f.tp1=e.y*f.gnormx-e.x*f.gnormy;b=e;d=d.next}a=a.gverts.next;c=c.elt;c.gnormx=this.axisy*c.lnormx-this.axisx*c.lnormy;c.gnormy=c.lnormx*this.axisx+c.lnormy*this.axisy;c.gprojection=this.posx*c.gnormx+this.posy*c.gnormy+c.lprojection;c.tp0=b.y*c.gnormx-b.x*c.gnormy;c.tp1=a.y*c.gnormx-a.x*c.gnormy}},invalidate_pos:function(){for(var a=this.shapes.head;null!=a;){var b=a.elt;b.type==i.id_ShapeType_POLYGON&&
(b.polygon.invalidate_gverts(),b.polygon.invalidate_gaxi());b.invalidate_worldCOM();a=a.next}this.zip_worldCOM=!0},pos_invalidate:function(a){this.immutable_midstep("Body::position");if(this.type==i.id_BodyType_STATIC&&null!=this.space)throw new j("Error: Cannot move a static object once inside a Space");this.posx==a.x&&this.posy==a.y||(this.posx=a.x,this.posy=a.y,this.invalidate_pos(),this.wake())},pos_validate:function(){this.wrap_pos.zpp_inner.x=this.posx;this.wrap_pos.zpp_inner.y=this.posy},vel_invalidate:function(a){if(this.type==
i.id_BodyType_STATIC)throw new j("Error: Static body cannot have its velocity set.");this.velx=a.x;this.vely=a.y;this.wake()},vel_validate:function(){this.wrap_vel.zpp_inner.x=this.velx;this.wrap_vel.zpp_inner.y=this.vely},setupPosition:function(){this.wrap_pos=K.get(this.posx,this.posy,null);this.wrap_pos.zpp_inner._inuse=!0;this.world?this.wrap_pos.zpp_inner._immutable=!0:(this.wrap_pos.zpp_inner._invalidate=E(this,this.pos_invalidate),this.wrap_pos.zpp_inner._validate=E(this,this.pos_validate))},
setupVelocity:function(){this.wrap_vel=K.get(this.velx,this.vely,null);this.wrap_vel.zpp_inner._inuse=!0;this.world?this.wrap_vel.zpp_inner._immutable=!0:(this.wrap_vel.zpp_inner._invalidate=E(this,this.vel_invalidate),this.wrap_vel.zpp_inner._validate=E(this,this.vel_validate))},invalidate_rot:function(){this.zip_axis=!0;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.type==i.id_ShapeType_POLYGON&&(b.polygon.invalidate_gverts(),b.polygon.invalidate_gaxi());b.invalidate_worldCOM();a=a.next}this.zip_worldCOM=
!0},validate_axis:function(){this.zip_axis&&(this.zip_axis=!1,this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot),null)},delta_rot:function(a){this.rot+=a;if(1.0E-4<a*a)this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot),null;else{var b=a*a,c=1-0.5*b,b=1-b*b/8,d=(c*this.axisx+a*this.axisy)*b;this.axisy=(c*this.axisy-a*this.axisx)*b;this.axisx=d}},invalidate_mass:function(){this.zip_mass=!0;this.invalidate_gravMass()},validate_mass:function(){if(this.zip_mass){this.zip_mass=!1;if(this.massMode==
i.id_MassMode_DEFAULT){this.cmass=0;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.refmaterial.density=b.material.density;b.validate_area_inertia();this.cmass+=b.area*b.material.density;a=a.next}}this.type==i.id_BodyType_DYNAMIC&&!this.nomove?(this.mass=this.cmass,this.imass=this.smass=1/this.mass):(this.mass=Infinity,this.imass=this.smass=0)}},invalidate_gravMass:function(){this.gravMassMode!=i.id_GravMassMode_FIXED&&(this.zip_gravMass=!0);this.gravMassMode!=i.id_GravMassMode_SCALED&&(this.zip_gravMassScale=
!0);this.wake()},validate_gravMass:function(){this.zip_gravMass&&(this.zip_gravMass=!1,this.validate_mass(),this.gravMassMode==i.id_GravMassMode_DEFAULT?(this.validate_mass(),this.gravMass=this.cmass):this.gravMassMode==i.id_GravMassMode_SCALED&&(this.validate_mass(),this.gravMass=this.cmass*this.gravMassScale))},invalidate_inertia:function(){this.zip_inertia=!0;this.wake()},validate_inertia:function(){if(this.zip_inertia){this.zip_inertia=!1;if(this.inertiaMode==i.id_InertiaMode_DEFAULT){this.cinertia=
0;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.refmaterial.density=b.material.density;b.validate_area_inertia();this.cinertia+=b.inertia*b.area*b.material.density;a=a.next}}this.type==i.id_BodyType_DYNAMIC&&!this.norotate?(this.inertia=this.cinertia,this.sinertia=this.iinertia=1/this.inertia):(this.inertia=Infinity,this.sinertia=this.iinertia=0)}},validate_aabb:function(){if(null==this.shapes.head)throw new j("Error: Body bounds only makes sense if it contains shapes");if(this.zip_aabb){this.zip_aabb=
!1;this.aabb.minx=Infinity;this.aabb.miny=Infinity;this.aabb.maxx=-Infinity;this.aabb.maxy=-Infinity;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.zip_aabb&&null!=b.body&&(b.zip_aabb=!1,b.type==i.id_ShapeType_CIRCLE?b.circle.__validate_aabb():b.polygon.__validate_aabb());this.aabb.combine(b.aabb);a=a.next}}},invalidate_localCOM:function(){this.zip_worldCOM=this.zip_localCOM=!0},validate_localCOM:function(){if(this.zip_localCOM){this.zip_localCOM=!1;for(var a=0,b=0,c=0,d=this.shapes.head;null!=
d;){var e=d.elt;e.zip_localCOM&&(e.zip_localCOM=!1,e.type==i.id_ShapeType_POLYGON&&e.polygon.__validate_localCOM(),null!=e.wrap_localCOM&&(e.wrap_localCOM.zpp_inner.x=e.localCOMx,e.wrap_localCOM.zpp_inner.y=e.localCOMy));e.validate_area_inertia();var f=e.area*e.material.density,a=a+e.localCOMx*f,b=b+e.localCOMy*f,c=c+e.area*e.material.density,d=d.next}0!=c&&(d=1/c,this.localCOMx=a*d,this.localCOMy=b*d);null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=
this.localCOMy);this.zip_mass&&this.massMode==i.id_MassMode_DEFAULT&&(this.zip_mass=!1,this.cmass=c,this.type==i.id_BodyType_DYNAMIC?(this.mass=this.cmass,this.imass=this.smass=1/this.mass):(this.mass=Infinity,this.imass=this.smass=0))}},validate_worldCOM:function(){this.zip_worldCOM&&(this.zip_worldCOM=!1,this.validate_localCOM(),this.zip_axis&&(this.zip_axis=!1,this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot),null),this.worldCOMx=this.posx+(this.axisy*this.localCOMx-this.axisx*this.localCOMy),
this.worldCOMy=this.posy+(this.localCOMx*this.axisx+this.localCOMy*this.axisy),null!=this.wrap_worldCOM&&(this.wrap_worldCOM.zpp_inner.x=this.worldCOMx,this.wrap_worldCOM.zpp_inner.y=this.worldCOMy))},__immutable_midstep:function(a){if(null!=this.space&&this.space.midstep)throw new j("Error: "+a+" cannot be set during a space step()");},aabb_validate:function(){if(null==this.shapes.head)throw new j("Error: bounds only makes sense when Body has shapes");this.validate_aabb()},shapes_adder:function(a){return a.zpp_inner.body!=
this?(null!=a.zpp_inner.body&&a.zpp_inner.body.wrap_shapes.remove(a),a.zpp_inner.body=this,a.zpp_inner.addedToBody(),null!=this.space&&this.space.added_shape(a.zpp_inner,null),a.zpp_inner.type==i.id_ShapeType_POLYGON&&(a.zpp_inner.polygon.invalidate_gaxi(),a.zpp_inner.polygon.invalidate_gverts()),!0):!1},shapes_subber:function(a){null!=this.space&&this.space.removed_shape(a.zpp_inner);a.zpp_inner.body=null;a.zpp_inner.removedFromBody()},shapes_invalidate:function(){this.invalidate_shapes()},shapes_modifiable:function(){this.immutable_midstep("Body::shapes");
if(this.type==i.id_BodyType_STATIC&&null!=this.space)throw new j("Error: Cannot modifiy shapes of static object once added to Space");},addedToSpace:function(){null==gc.zpp_pool?this.component=new gc:(this.component=gc.zpp_pool,gc.zpp_pool=this.component.next,this.component.next=null);null;this.component.isBody=!0;this.component.body=this;this.__iaddedToSpace()},removedFromSpace:function(){for(;null!=this.arbiters.head;){var a=this.arbiters.pop_unsafe();a.cleared=!0;a.b2==this&&a.b1.arbiters.inlined_try_remove(a);
a.b1==this&&a.b2.arbiters.inlined_try_remove(a);null!=a.pair&&(a.pair.arb=null,a.pair=null);a.active=!1;this.space.f_arbiters.modified=!0}a=this.component;a.body=null;a.constraint=null;null;a.next=gc.zpp_pool;gc.zpp_pool=a;this.component=null;this.__iremovedFromSpace()},__class__:rb});var Pf=function(){this.compound=this.space=null;this.depth=0;this.outer=this.bodies=this.constraints=this.compounds=this.wrap_constraints=null};Pf.__name__=!0;Pf.__super__=ha;Pf.prototype=r(ha.prototype,{__imutable_midstep:function(a){if(null!=
this.space&&this.space.midstep)throw new j("Error: "+a+" cannot be set during space step()");},addedToSpace:function(){this.__iaddedToSpace()},removedFromSpace:function(){this.__iremovedFromSpace()},__class__:Pf});var M=function(){this.dynamicFriction=this.staticFriction=this.density=this.elasticity=this.rollingFriction=0;this.next=this.outer=this.shapes=null;this.shapes=new Mc;this.elasticity=0;this.dynamicFriction=1;this.staticFriction=2;this.density=0.001;this.rollingFriction=0.01};M.__name__=
!0;M.prototype={wrapper:function(){if(null==this.outer){this.outer=new Df;var a=this.outer.zpp_inner;a.outer=null;a.next=M.zpp_pool;M.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},set:function(a){this.dynamicFriction=a.dynamicFriction;this.staticFriction=a.staticFriction;this.density=a.density;this.elasticity=a.elasticity;this.rollingFriction=a.rollingFriction},invalidate:function(a){for(var b=this.shapes.head;null!=b;)b.elt.invalidate_material(a),b=b.next},__class__:M};var hc=function(a){this.zip_aabb=
!1;this.sweep=this.node=this.pairs=this.aabb=null;this.fluidEnabled=this.sensorEnabled=!1;this.circle=this.polygon=this.refmaterial=this.material=this.filter=this.fluidProperties=null;this.sweepCoef=0;this.zip_sweepRadius=!1;this.sweepRadius=0;this.wrap_localCOM=null;this.zip_worldCOM=!1;this.worldCOMx=this.worldCOMy=0;this.zip_localCOM=!1;this.localCOMx=this.localCOMy=0;this.zip_angDrag=!1;this.inertia=this.angDrag=0;this.zip_area_inertia=!1;this.type=this.area=0;this.outer=this.body=null;ha.call(this);
this.pairs=new Qf;this.ishape=this;this.type=a;this.aabb=ra.get(0,0,0,0);this.aabb._immutable=!0;this.aabb._validate=E(this,this.aabb_validate);this.zip_area_inertia=this.zip_angDrag=this.zip_localCOM=this.zip_sweepRadius=!0;this.worldCOMy=this.worldCOMx=this.localCOMy=this.localCOMx=0;this.sensorEnabled=this.fluidEnabled=!1;this.body=this.fluidProperties=null;this.refmaterial=new M;this.sweepRadius=this.sweepCoef=0};hc.__name__=!0;hc.__super__=ha;hc.prototype=r(ha.prototype,{validate_sweepRadius:function(){this.zip_sweepRadius&&
(this.zip_sweepRadius=!1,this.type==i.id_ShapeType_CIRCLE?this.circle.__validate_sweepRadius():this.polygon.__validate_sweepRadius())},validate_area_inertia:function(){this.zip_area_inertia&&(this.zip_area_inertia=!1,this.type==i.id_ShapeType_CIRCLE?this.circle.__validate_area_inertia():this.polygon.__validate_area_inertia())},validate_angDrag:function(){if(this.zip_angDrag||this.refmaterial.dynamicFriction!=this.material.dynamicFriction)this.zip_angDrag=!1,this.refmaterial.dynamicFriction=this.material.dynamicFriction,
this.type==i.id_ShapeType_CIRCLE?this.circle.__validate_angDrag():this.polygon.__validate_angDrag()},validate_worldCOM:function(){this.zip_worldCOM&&null!=this.body&&(this.zip_worldCOM=!1,this.zip_localCOM&&(this.zip_localCOM=!1,this.type==i.id_ShapeType_POLYGON&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)),this.body.validate_axis(),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-
this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy))},invalidate_area_inertia:function(){this.zip_area_inertia=!0;null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),this.body.invalidate_inertia())},invalidate_angDrag:function(){this.zip_angDrag=!0},invalidate_localCOM:function(){this.zip_localCOM=!0;this.invalidate_area_inertia();this.type==i.id_ShapeType_CIRCLE&&(this.zip_sweepRadius=!0);this.invalidate_angDrag();
this.invalidate_worldCOM();null!=this.body&&this.body.invalidate_localCOM()},invalidate_worldCOM:function(){this.zip_aabb=this.zip_worldCOM=!0;null!=this.body&&(this.body.zip_aabb=!0)},invalidate_material:function(a){0!=(a&M.WAKE)&&this.wake();0!=(a&M.ARBITERS)&&null!=this.body&&this.body.refreshArbiters();0!=(a&M.PROPS)&&null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),this.body.invalidate_inertia());0!=(a&M.ANGDRAG)&&this.invalidate_angDrag();this.refmaterial.set(this.material)},
invalidate_filter:function(){this.wake()},aabb_validate:function(){if(null==this.body)throw new j("Error: bounds only makes sense when Shape belongs to a Body");this.zip_aabb&&null!=this.body&&(this.zip_aabb=!1,this.type==i.id_ShapeType_CIRCLE?this.circle.__validate_aabb():this.polygon.__validate_aabb())},setMaterial:function(a){this.material!=a&&(null!=this.body&&null!=this.body.space&&null!=this.material&&this.material.shapes.remove(this),this.material=a,null!=this.body&&null!=this.body.space&&
a.shapes.add(this),this.wake(),null!=this.body&&this.body.refreshArbiters())},setFilter:function(a){this.filter!=a&&(null!=this.body&&null!=this.body.space&&null!=this.filter&&this.filter.shapes.remove(this),this.filter=a,null!=this.body&&null!=this.body.space&&a.shapes.add(this),this.wake())},__immutable_midstep:function(a){if(null!=this.body&&null!=this.body.space&&this.body.space.midstep)throw new j("Error: "+a+" cannot be set during a space step()");},addedToBody:function(){this.invalidate_worldCOM();
this.zip_aabb=!0;null!=this.body&&(this.body.zip_aabb=!0)},removedFromBody:function(){},addedToSpace:function(){this.__iaddedToSpace();this.material.shapes.add(this);this.filter.shapes.add(this);null!=this.fluidProperties&&this.fluidProperties.shapes.add(this)},removedFromSpace:function(){this.__iremovedFromSpace();this.material.shapes.remove(this);this.filter.shapes.remove(this);null!=this.fluidProperties&&this.fluidProperties.shapes.remove(this)},__class__:hc});var Rf=function(){this.radius=0};
Rf.__name__=!0;Rf.__super__=hc;Rf.prototype=r(hc.prototype,{__validate_aabb:function(){this.zip_worldCOM&&null!=this.body&&(this.zip_worldCOM=!1,this.zip_localCOM&&(this.zip_localCOM=!1,this.type==i.id_ShapeType_POLYGON&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)),this.body.validate_axis(),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=
this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy));var a=this.radius,b=this.radius;this.aabb.minx=this.worldCOMx-a;this.aabb.miny=this.worldCOMy-b;this.aabb.maxx=this.worldCOMx+a;this.aabb.maxy=this.worldCOMy+b},_force_validate_aabb:function(){this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy);this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy);this.aabb.minx=this.worldCOMx-this.radius;
this.aabb.miny=this.worldCOMy-this.radius;this.aabb.maxx=this.worldCOMx+this.radius;this.aabb.maxy=this.worldCOMy+this.radius},__validate_sweepRadius:function(){this.sweepCoef=Math.sqrt(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy);this.sweepRadius=this.sweepCoef+this.radius},__validate_area_inertia:function(){var a=this.radius*this.radius;this.area=a*Math.PI;this.inertia=0.5*a+(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy)},__validate_angDrag:function(){var a=this.localCOMx*
this.localCOMx+this.localCOMy*this.localCOMy,b=this.radius*this.radius;this.angDrag=(a+2*b)*this.material.dynamicFriction*k.fluidAngularDragFriction+0.5*k.fluidAngularDrag*(1+k.fluidVacuumDrag)*a;this.angDrag/=2*(a+0.5*b)},__translate:function(a,b){this.localCOMx+=1*a;this.localCOMy+=1*b;this.invalidate_localCOM()},__class__:Rf});var R=function(){this.tp0=this.tp1=0;this.lp0=this.gp0=this.lp1=this.gp1=null;this.length=this.lprojection=this.gprojection=0;this.wrap_gnorm=null;this.gnormx=this.gnormy=
0;this.wrap_lnorm=null;this.lnormx=this.lnormy=0;this.next=this.polygon=this.outer=null;this.gprojection=this.lprojection=this.length=this.gnormy=this.gnormx=this.lnormy=this.lnormx=0};R.__name__=!0;R.prototype={wrapper:function(){null==this.outer&&(R.internal=!0,this.outer=new Ff,R.internal=!1,this.outer.zpp_inner=this);return this.outer},__class__:R};var we=function(){this.reverse_flag=this.zip_lverts=this.zip_laxi=this.zip_gverts=this.zip_gaxi=this.zip_valid=this.zip_sanitation=!1;this.edgeCnt=
0;this.outer_zn=this.lverts=this.wrap_lverts=this.gverts=this.wrap_gverts=this.edges=this.wrap_edges=null;hc.call(this,i.id_ShapeType_POLYGON);this.polygon=this;this.lverts=new G;this.gverts=new G;this.edges=new Sf;this.edgeCnt=0};we.__name__=!0;we.__super__=hc;we.prototype=r(hc.prototype,{lverts_pa_invalidate:function(){this.invalidate_lverts()},lverts_pa_immutable:function(){if(null!=this.body&&this.body.type==i.id_BodyType_STATIC&&null!=this.body.space)throw new j("Error: Cannot modify local vertex of Polygon added to a static body whilst within a Space");
},gverts_pa_validate:function(){if(null==this.body)throw new j("Error: World vertex only makes sense when Polygon is contained in a rigid body");this.validate_gverts()},lverts_post_adder:function(a){a.zpp_inner._invalidate=E(this,this.lverts_pa_invalidate);a.zpp_inner._isimmutable=E(this,this.lverts_pa_immutable);for(var b=null,c=null,d=this.lverts.next;null!=d&&!(d==a.zpp_inner);){b=null==b?this.gverts.next:b.next,c=null==c?this.edges.head:c.next;d=d.next}a=G.get(0,0,!0);this.gverts.insert(b,a);
null!=this.lverts.next.next&&(null==this.lverts.next.next.next?(null==R.zpp_pool?c=new R:(c=R.zpp_pool,R.zpp_pool=c.next,c.next=null),null,c.polygon=this,this.edges.add(c),null==R.zpp_pool?c=new R:(c=R.zpp_pool,R.zpp_pool=c.next,c.next=null),null,c.polygon=this,this.edges.add(c),this.edgeCnt+=2):(null==R.zpp_pool?b=new R:(b=R.zpp_pool,R.zpp_pool=b.next,b.next=null),null,b.polygon=this,this.edges.insert(c,b),this.edgeCnt++));a._validate=E(this,this.gverts_pa_validate)},lverts_subber:function(a){this.cleanup_lvert(a.zpp_inner)},
lverts_invalidate:function(){this.invalidate_lverts()},lverts_validate:function(){this.validate_lverts()},lverts_modifiable:function(){this.immutable_midstep("Polygon::localVerts");if(null!=this.body&&this.body.type==i.id_BodyType_STATIC&&null!=this.body.space)throw new j("Error: Cannot modifiy shapes of static object once added to Space");},getlverts:function(){this.wrap_lverts=Qc.get(this.lverts);this.wrap_lverts.zpp_inner.post_adder=E(this,this.lverts_post_adder);this.wrap_lverts.zpp_inner.subber=
E(this,this.lverts_subber);this.wrap_lverts.zpp_inner._invalidate=E(this,this.lverts_invalidate);this.wrap_lverts.zpp_inner._validate=E(this,this.lverts_validate);this.wrap_lverts.zpp_inner._modifiable=E(this,this.lverts_modifiable);this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag},invalidate_lverts:function(){this.invalidate_laxi();this.invalidate_area_inertia();this.invalidate_angDrag();this.invalidate_localCOM();this.invalidate_gverts();this.zip_sanitation=this.zip_valid=this.zip_lverts=
!0;null!=this.body&&this.body.wake()},invalidate_laxi:function(){this.invalidate_gaxi();this.zip_laxi=this.zip_sweepRadius=!0},invalidate_gverts:function(){this.zip_aabb=!0;null!=this.body&&(this.body.zip_aabb=!0);this.zip_gverts=!0},invalidate_gaxi:function(){this.zip_gaxi=!0},valid:function(){if(this.zip_valid){this.zip_valid=!1;this.zip_sanitation&&(this.zip_sanitation=!1,this.splice_collinear_real());if(3>this.lverts.length)return null==i.ValidationResult_DEGENERATE&&(i.internal=!0,i.ValidationResult_DEGENERATE=
new pa,i.internal=!1),this.validation=i.ValidationResult_DEGENERATE;this.validate_lverts();this.validate_area_inertia();if(this.area<k.epsilon)return null==i.ValidationResult_DEGENERATE&&(i.internal=!0,i.ValidationResult_DEGENERATE=new pa,i.internal=!1),this.validation=i.ValidationResult_DEGENERATE;for(var a=!1,b=!1,c=!0,d=this.lverts.next,e=d,f=d=d.next,d=d.next;null!=d;){var h=d,g=0,l=0,g=h.x-f.x,l=h.y-f.y,j=0,v=0,j=f.x-e.x,v=f.y-e.y,g=v*g-j*l;g>k.epsilon?b=!0:g<-k.epsilon&&(a=!0);if(b&&a){c=!1;
break}e=f;f=h;d=d.next}c&&(h=d=this.lverts.next,l=g=0,g=h.x-f.x,l=h.y-f.y,v=j=0,j=f.x-e.x,v=f.y-e.y,e=v*g-j*l,e>k.epsilon?b=!0:e<-k.epsilon&&(a=!0),b&&a&&(c=!1),c&&(e=f,f=h,h=d=d.next,d=c=0,c=h.x-f.x,d=h.y-f.y,g=h=0,h=f.x-e.x,g=f.y-e.y,f=g*c-h*d,f>k.epsilon?b=!0:f<-k.epsilon&&(a=!0)));if(b&&a)return null==i.ValidationResult_CONCAVE&&(i.internal=!0,i.ValidationResult_CONCAVE=new pa,i.internal=!1),this.validation=i.ValidationResult_CONCAVE;f=a=!0;b=e=this.lverts.next;for(e=e.next;null!=e;){c=e;if(!a){f=
!1;break}h=!0;d=g=this.lverts.next;for(g=g.next;null!=g;){l=g;if(!(b==d||b==l||c==d||c==l)){var v=j=0,j=b.x-d.x,v=b.y-d.y,n=0,q=0,n=c.x-b.x,q=c.y-b.y,o=0,s=0,o=l.x-d.x,s=l.y-d.y,r=q*o-n*s;if(r*r>k.epsilon&&(r=1/r,o=(s*j-o*v)*r,o>k.epsilon&&o<1-k.epsilon&&(j=(q*j-n*v)*r,j>k.epsilon&&j<1-k.epsilon))){h=a=!1;break}}d=l;g=g.next}h&&(v=this.lverts.next,b==d||b==v||c==d||c==v||(g=h=0,h=b.x-d.x,g=b.y-d.y,j=l=0,l=c.x-b.x,j=c.y-b.y,n=b=0,b=v.x-d.x,n=v.y-d.y,d=j*b-l*n,d*d>k.epsilon&&(d=1/d,b=(n*h-b*g)*d,b>
k.epsilon&&b<1-k.epsilon&&(b=(j*h-l*g)*d,b>k.epsilon&&b<1-k.epsilon&&(a=!1)))));b=c;e=e.next}if(f){do if(e=this.lverts.next,a){c=!0;f=d=this.lverts.next;for(d=d.next;null!=d;){h=d;if(!(b==f||b==h||e==f||e==h))if(l=g=0,g=b.x-f.x,l=b.y-f.y,v=j=0,j=e.x-b.x,v=e.y-b.y,r=q=0,q=h.x-f.x,r=h.y-f.y,n=v*q-j*r,n*n>k.epsilon&&(n=1/n,q=(r*g-q*l)*n,q>k.epsilon&&q<1-k.epsilon&&(g=(v*g-j*l)*n,g>k.epsilon&&g<1-k.epsilon))){c=a=!1;break}f=h;d=d.next}c&&(l=this.lverts.next,b==f||b==l||e==f||e==l||(d=c=0,c=b.x-f.x,d=
b.y-f.y,g=h=0,h=e.x-b.x,g=e.y-b.y,j=e=0,e=l.x-f.x,j=l.y-f.y,f=g*e-h*j,f*f>k.epsilon&&(f=1/f,e=(j*c-e*d)*f,e>k.epsilon&&e<1-k.epsilon&&(f*=g*c-h*d,f>k.epsilon&&f<1-k.epsilon&&(a=!1)))))}while(0)}if(a)return null==i.ValidationResult_VALID&&(i.internal=!0,i.ValidationResult_VALID=new pa,i.internal=!1),this.validation=i.ValidationResult_VALID;null==i.ValidationResult_SELF_INTERSECTING&&(i.internal=!0,i.ValidationResult_SELF_INTERSECTING=new pa,i.internal=!1);return this.validation=i.ValidationResult_SELF_INTERSECTING}return this.validation},
validate_lverts:function(){this.zip_lverts&&(this.zip_lverts=!1,2<this.lverts.length&&(this.validate_area_inertia(),0>this.area&&(this.reverse_vertices(),this.area=-this.area)))},cleanup_lvert:function(a){for(var b=null,c=null,d=this.lverts.next;null!=d&&!(d==a);){b=null==b?this.gverts.next:b.next,c=null==c?this.edges.head:c.next;d=d.next}a=null==b?this.gverts.next:b.next;this.gverts.erase(b);null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;
a.next=G.zpp_pool;G.zpp_pool=a;2==this.edgeCnt?(c=this.edges.pop_unsafe(),c.polygon=null,c.next=R.zpp_pool,R.zpp_pool=c,c=this.edges.pop_unsafe(),c.polygon=null,c.next=R.zpp_pool,R.zpp_pool=c,this.edgeCnt=0):0!=this.edgeCnt&&(b=null==c?this.edges.head.elt:c.next.elt,this.edges.erase(c),b.polygon=null,b.next=R.zpp_pool,R.zpp_pool=b,this.edgeCnt--)},splice_collinear:function(){this.zip_sanitation&&(this.zip_sanitation=!1,this.splice_collinear_real())},splice_collinear_real:function(){if(!(null==this.lverts.next||
null==this.lverts.next.next)&&null!=this.lverts.next.next.next){for(var a=null,b=this.lverts.next;null!=b;){var c=b,d=null==b.next?this.lverts.next:b.next;Qa.vec_dsq(c.x,c.y,d.x,d.y)<k.epsilon*k.epsilon?(this.cleanup_lvert(b),b=this.lverts.erase(a)):(a=b,b=b.next)}if(null!=this.lverts.next){do{a=!1;for(b=this.lverts.next;null!=b;){var c=null==b.next?this.lverts.next:b.next,e=b,d=c,f=null==c.next?this.lverts.next:c.next,h=0,g=0,h=d.x-e.x,g=d.y-e.y,i=e=0,e=f.x-d.x,i=f.y-d.y,d=i*h-e*g;d*d>=k.epsilon*
k.epsilon||(this.cleanup_lvert(c),this.lverts.erase(null==b.next?null:b),a=!0);b=b.next}}while(a)}}},reverse_vertices:function(){this.lverts.reverse();this.gverts.reverse();this.edges.reverse();var a=this.edges.iterator_at(this.edgeCnt-1),b=this.edges.pop_unsafe();this.edges.insert(a,b);this.reverse_flag=!this.reverse_flag;null!=this.wrap_lverts&&(this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag);null!=this.wrap_gverts&&(this.wrap_gverts.zpp_inner.reverse_flag=this.reverse_flag);null!=this.wrap_edges&&
(this.wrap_edges.zpp_inner.reverse_flag=this.reverse_flag)},validate_laxi:function(){if(this.zip_laxi){this.zip_laxi=!1;this.validate_lverts();for(var a=this.edges.head,b=this.lverts.next,c=b,b=b.next;null!=b;){var d=b,e=a.elt,a=a.next;e.lp0=c;e.lp1=d;var f=0,h=0,f=c.x-d.x,h=c.y-d.y,g=Math.sqrt(f*f+h*h);e.length=g;g=1/g;f*=g;h*=g;g=f;f=-h;h=g;e.lprojection=f*c.x+h*c.y;e.lnormx=f;e.lnormy=h;null!=e.wrap_lnorm&&(e.wrap_lnorm.zpp_inner.x=f,e.wrap_lnorm.zpp_inner.y=h);c=d;b=b.next}e=this.lverts.next;
a=a.elt;a.lp0=c;a.lp1=e;d=b=0;b=c.x-e.x;d=c.y-e.y;e=Math.sqrt(b*b+d*d);a.length=e;e=1/e;f=b*e;b=-(d*e);d=f;a.lprojection=b*c.x+d*c.y;a.lnormx=b;a.lnormy=d;null!=a.wrap_lnorm&&(a.wrap_lnorm.zpp_inner.x=b,a.wrap_lnorm.zpp_inner.y=d)}},validate_gverts:function(){if(this.zip_gverts&&null!=this.body){this.zip_gverts=!1;this.validate_lverts();this.body.validate_axis();for(var a=this.lverts.next,b=this.gverts.next;null!=b;){var c=b,d=a,a=a.next;c.x=this.body.posx+(this.body.axisy*d.x-this.body.axisx*d.y);
c.y=this.body.posy+(d.x*this.body.axisx+d.y*this.body.axisy);b=b.next}}},validate_gaxi:function(){if(this.zip_gaxi&&null!=this.body){this.zip_gaxi=!1;this.validate_laxi();this.body.validate_axis();this.validate_gverts();for(var a=this.edges.head,b=this.gverts.next,c=b,b=b.next;null!=b;){var d=b,e=a.elt,a=a.next;e.gp0=c;e.gp1=d;e.gnormx=this.body.axisy*e.lnormx-this.body.axisx*e.lnormy;e.gnormy=e.lnormx*this.body.axisx+e.lnormy*this.body.axisy;e.gprojection=this.body.posx*e.gnormx+this.body.posy*e.gnormy+
e.lprojection;null!=e.wrap_gnorm&&(e.wrap_gnorm.zpp_inner.x=e.gnormx,e.wrap_gnorm.zpp_inner.y=e.gnormy);e.tp0=e.gp0.y*e.gnormx-e.gp0.x*e.gnormy;e.tp1=e.gp1.y*e.gnormx-e.gp1.x*e.gnormy;c=d;b=b.next}b=this.gverts.next;a=a.elt;a.gp0=c;a.gp1=b;a.gnormx=this.body.axisy*a.lnormx-this.body.axisx*a.lnormy;a.gnormy=a.lnormx*this.body.axisx+a.lnormy*this.body.axisy;a.gprojection=this.body.posx*a.gnormx+this.body.posy*a.gnormy+a.lprojection;null!=a.wrap_gnorm&&(a.wrap_gnorm.zpp_inner.x=a.gnormx,a.wrap_gnorm.zpp_inner.y=
a.gnormy);a.tp0=a.gp0.y*a.gnormx-a.gp0.x*a.gnormy;a.tp1=a.gp1.y*a.gnormx-a.gp1.x*a.gnormy}},__validate_aabb:function(){this.validate_gverts();if(null==this.lverts.next)throw new j("Error: An empty polygon has no meaningful bounds");var a=this.gverts.next;this.aabb.minx=a.x;this.aabb.miny=a.y;this.aabb.maxx=a.x;this.aabb.maxy=a.y;for(a=this.gverts.next.next;null!=a;){var b=a;b.x<this.aabb.minx&&(this.aabb.minx=b.x);b.x>this.aabb.maxx&&(this.aabb.maxx=b.x);b.y<this.aabb.miny&&(this.aabb.miny=b.y);b.y>
this.aabb.maxy&&(this.aabb.maxy=b.y);a=a.next}},_force_validate_aabb:function(){var a=this.lverts.next,b=this.gverts.next,c=a,a=a.next;b.x=this.body.posx+(this.body.axisy*c.x-this.body.axisx*c.y);b.y=this.body.posy+(c.x*this.body.axisx+c.y*this.body.axisy);this.aabb.minx=b.x;this.aabb.miny=b.y;this.aabb.maxx=b.x;this.aabb.maxy=b.y;for(b=this.gverts.next.next;null!=b;){var c=b,d=a,a=a.next;c.x=this.body.posx+(this.body.axisy*d.x-this.body.axisx*d.y);c.y=this.body.posy+(d.x*this.body.axisx+d.y*this.body.axisy);
c.x<this.aabb.minx&&(this.aabb.minx=c.x);c.x>this.aabb.maxx&&(this.aabb.maxx=c.x);c.y<this.aabb.miny&&(this.aabb.miny=c.y);c.y>this.aabb.maxy&&(this.aabb.maxy=c.y);b=b.next}},__validate_sweepRadius:function(){var a=0,b=0;this.validate_laxi();for(var c=this.lverts.next;null!=c;){var d=c,d=d.x*d.x+d.y*d.y;d>a&&(a=d);c=c.next}for(c=this.edges.head;null!=c;){d=c.elt;if(d.lprojection<b&&(b=d.lprojection,0>b))break;c=c.next}0>b&&(b=0);this.sweepRadius=Math.sqrt(a);this.sweepCoef=this.sweepRadius-b},__validate_area_inertia:function(){if(null==
this.lverts.next||null==this.lverts.next.next||null==this.lverts.next.next.next)this.inertia=this.area=0;else{for(var a=this.area=0,b=0,c=this.lverts.next,d=c,e=c=c.next,c=c.next;null!=c;){var f=c,h=e.y*d.x-e.x*d.y,a=a+h*(e.x*e.x+e.y*e.y+(e.x*d.x+e.y*d.y)+(d.x*d.x+d.y*d.y)),b=b+h;this.area+=e.x*(f.y-d.y);d=e;e=f;c=c.next}h=c=this.lverts.next;f=e.y*d.x-e.x*d.y;a+=f*(e.x*e.x+e.y*e.y+(e.x*d.x+e.y*d.y)+(d.x*d.x+d.y*d.y));this.area+=e.x*(h.y-d.y);d=e;e=h;c=c.next;h=e.y*d.x-e.x*d.y;a+=h*(e.x*e.x+e.y*e.y+
(e.x*d.x+e.y*d.y)+(d.x*d.x+d.y*d.y));this.area+=e.x*(c.y-d.y);this.inertia=a/(6*(b+f+h));this.area*=0.5;0>this.area&&(this.area=-this.area,this.reverse_vertices())}},__validate_angDrag:function(){if(3>this.lverts.length)throw new j("Error: Polygon's with less than 3 vertices have no meaningful angDrag");this.validate_area_inertia();this.validate_laxi();for(var a=0,b=this.edges.head,c=0,d=this.lverts.next,e=d,d=d.next;null!=d;){var f=d,h=b.elt,b=b.next,c=c+h.length,g=0,i=0,g=f.x-e.x,i=f.y-e.y,a=a+
h.length*k.fluidAngularDragFriction*this.material.dynamicFriction*h.lprojection*h.lprojection,n=-(e.y*h.lnormx-e.x*h.lnormy)/(i*h.lnormx-g*h.lnormy);if(0<n){var v;v=1<n?1:n;var A=0,q=0,A=e.x,q=e.y,o=v,A=A+g*o,q=q+i*o,o=h.lnormy*e.x-h.lnormx*e.y,A=h.lnormy*A-h.lnormx*q,a=a+(A*A*A-o*o*o)/(3*(A-o))*v*h.length*k.fluidAngularDrag}1>n&&(n=0>n?0:n,A=v=0,v=e.x,A=e.y,e=n,v+=g*e,A+=i*e,e=h.lnormy*v-h.lnormx*A,g=h.lnormy*f.x-h.lnormx*f.y,a+=(g*g*g-e*e*e)/(3*(g-e))*k.fluidVacuumDrag*(1-n)*h.length*k.fluidAngularDrag);
e=f;d=d.next}d=this.lverts.next;b=b.elt;c+=b.length;h=f=0;f=d.x-e.x;h=d.y-e.y;a+=b.length*k.fluidAngularDragFriction*this.material.dynamicFriction*b.lprojection*b.lprojection;g=-(e.y*b.lnormx-e.x*b.lnormy)/(h*b.lnormx-f*b.lnormy);0<g&&(i=1<g?1:g,A=v=0,v=e.x,A=e.y,n=b.lnormy*e.x-b.lnormx*e.y,v=b.lnormy*(v+f*i)-b.lnormx*(A+h*i),a+=(v*v*v-n*n*n)/(3*(v-n))*i*b.length*k.fluidAngularDrag);1>g&&(g=0>g?0:g,n=i=0,i=e.x,n=e.y,e=b.lnormy*(i+f*g)-b.lnormx*(n+h*g),d=b.lnormy*d.x-b.lnormx*d.y,a+=(d*d*d-e*e*e)/
(3*(d-e))*k.fluidVacuumDrag*(1-g)*b.length*k.fluidAngularDrag);this.angDrag=a/(this.inertia*c)},__validate_localCOM:function(){if(null==this.lverts.next)throw new j("Error: An empty polygon has no meaningful localCOM");if(null==this.lverts.next.next)this.localCOMx=this.lverts.next.x,this.localCOMy=this.lverts.next.y;else if(null==this.lverts.next.next.next)this.localCOMx=this.lverts.next.x,this.localCOMy=this.lverts.next.y,this.localCOMx+=1*this.lverts.next.next.x,this.localCOMy+=1*this.lverts.next.next.y,
this.localCOMx*=0.5,this.localCOMy*=0.5;else{for(var a=this.localCOMy=this.localCOMx=0,b=this.lverts.next,c=b,d=b=b.next,b=b.next;null!=b;){var e=b,a=a+d.x*(e.y-c.y),c=e.y*d.x-e.x*d.y;this.localCOMx+=(d.x+e.x)*c;this.localCOMy+=(d.y+e.y)*c;c=d;d=e;b=b.next}e=b=this.lverts.next;a+=d.x*(e.y-c.y);c=e.y*d.x-e.x*d.y;this.localCOMx+=(d.x+e.x)*c;this.localCOMy+=(d.y+e.y)*c;c=d;d=e;b=b.next;a+=d.x*(b.y-c.y);c=b.y*d.x-b.x*d.y;this.localCOMx+=(d.x+b.x)*c;this.localCOMy+=(d.y+b.y)*c;a=1/(3*a);this.localCOMx*=
a;this.localCOMy*=a}},__translate:function(a,b){for(var c=this.lverts.next;null!=c;){var d=c;d.x+=1*a;d.y+=1*b;c=c.next}this.invalidate_lverts()},__class__:we});var xc=function(){this.sweep=this.dynab=null;this.is_sweep=!1;this.space=null};xc.__name__=!0;xc.prototype={insert:function(a){this.is_sweep?this.sweep.__insert(a):this.dynab.__insert(a)},remove:function(a){this.is_sweep?this.sweep.__remove(a):this.dynab.__remove(a)},sync:function(a){this.is_sweep?!this.sweep.space.continuous&&a.zip_aabb&&
null!=a.body&&(a.zip_aabb=!1,a.type==i.id_ShapeType_CIRCLE?a.circle.__validate_aabb():a.polygon.__validate_aabb()):this.dynab.__sync(a)},broadphase:function(){},__class__:xc};var La=function(){this.synced=this.first_sync=!1;this.snext=null;this.moved=!1;this.next=this.mnext=null;this.height=0;this.parent=this.child1=this.child2=null;this.dyn=!1;this.aabb=this.shape=null;this.height=-1};La.__name__=!0;La.prototype={free:function(){this.height=-1;var a=this.aabb;null!=a.outer&&(a.outer.zpp_inner=null,
a.outer=null);a.wrap_min=a.wrap_max=null;a._invalidate=null;a._validate=null;a.next=ra.zpp_pool;ra.zpp_pool=a;this.mnext=this.snext=this.next=this.child1=this.child2=this.parent=null},__class__:La};var W=function(){this.arb=this.next=null;this.id=this.di=0;this.first=this.sleeping=!1;this.n1=this.n2=null};W.__name__=!0;W.prototype={__class__:W};var ib=function(){this.root=null};ib.__name__=!0;ib.prototype={inlined_insertLeaf:function(a){if(null==this.root)this.root=a,this.root.parent=null;else{for(var b=
a.aabb,c=this.root;null!=c.child1;){var d=c.child1,e=c.child2,f=c.aabb.perimeter();ib.tmpaabb.setCombine(c.aabb,b);var h=ib.tmpaabb.perimeter(),g=2*h,f=2*(h-f);ib.tmpaabb.setCombine(b,d.aabb);null==d.child1?h=ib.tmpaabb.perimeter()+f:(h=d.aabb.perimeter(),h=ib.tmpaabb.perimeter()-h+f);ib.tmpaabb.setCombine(b,e.aabb);if(null==e.child1)f=ib.tmpaabb.perimeter()+f;else var i=e.aabb.perimeter(),f=ib.tmpaabb.perimeter()-i+f;if(g<h&&g<f)break;else c=h<f?d:e}d=c.parent;null==La.zpp_pool?e=new La:(e=La.zpp_pool,
La.zpp_pool=e.next,e.next=null);null==ra.zpp_pool?e.aabb=new ra:(e.aabb=ra.zpp_pool,ra.zpp_pool=e.aabb.next,e.aabb.next=null);null;e.moved=!1;e.synced=!1;e.first_sync=!1;e.parent=d;e.aabb.setCombine(b,c.aabb);e.height=c.height+1;null!=d?(d.child1==c?d.child1=e:d.child2=e,e.child1=c,e.child2=a,c.parent=e,a.parent=e):(e.child1=c,e.child2=a,c.parent=e,this.root=a.parent=e);for(c=a.parent;null!=c;)c=this.balance(c),a=c.child1,b=c.child2,d=a.height,e=b.height,c.height=1+(d>e?d:e),c.aabb.setCombine(a.aabb,
b.aabb),c=c.parent}},removeLeaf:function(a){this.inlined_removeLeaf(a)},inlined_removeLeaf:function(a){if(a==this.root)this.root=null;else{var b=a.parent,c=b.parent,a=b.child1==a?b.child2:b.child1;if(null!=c){c.child1==b?c.child1=a:c.child2=a;a.parent=c;b.free();b.next=La.zpp_pool;La.zpp_pool=b;for(b=c;null!=b;)b=this.balance(b),a=b.child1,c=b.child2,b.aabb.setCombine(a.aabb,c.aabb),a=a.height,c=c.height,b.height=1+(a>c?a:c),b=b.parent}else this.root=a,a.parent=null,b.free(),b.next=La.zpp_pool,La.zpp_pool=
b}},balance:function(a){if(null==a.child1||2>a.height)return a;var b=a.child1,c=a.child2,d=c.height-b.height;if(1<d){var e=c.child1,f=c.child2;c.child1=a;c.parent=a.parent;a.parent=c;null!=c.parent?c.parent.child1==a?c.parent.child1=c:c.parent.child2=c:this.root=c;e.height>f.height?(c.child2=e,a.child2=f,f.parent=a,a.aabb.setCombine(b.aabb,f.aabb),c.aabb.setCombine(a.aabb,e.aabb),a.height=1+function(){var a=b.height,c=f.height;return a>c?a:c}(this),c.height=1+function(){var b=a.height,c=e.height;
return b>c?b:c}(this)):(c.child2=f,a.child2=e,e.parent=a,a.aabb.setCombine(b.aabb,e.aabb),c.aabb.setCombine(a.aabb,f.aabb),a.height=1+function(){var a=b.height,c=e.height;return a>c?a:c}(this),c.height=1+function(){var b=a.height,c=f.height;return b>c?b:c}(this));return c}if(-1>d){var h=b.child1,g=b.child2;b.child1=a;b.parent=a.parent;a.parent=b;null!=b.parent?b.parent.child1==a?b.parent.child1=b:b.parent.child2=b:this.root=b;h.height>g.height?(b.child2=h,a.child1=g,g.parent=a,a.aabb.setCombine(c.aabb,
g.aabb),b.aabb.setCombine(a.aabb,h.aabb),a.height=1+function(){var a=c.height,b=g.height;return a>b?a:b}(this),b.height=1+function(){var b=a.height,c=h.height;return b>c?b:c}(this)):(b.child2=g,a.child1=h,h.parent=a,a.aabb.setCombine(c.aabb,h.aabb),b.aabb.setCombine(a.aabb,g.aabb),a.height=1+function(){var a=c.height,b=h.height;return a>b?a:b}(this),b.height=1+function(){var b=a.height,c=g.height;return b>c?b:c}(this));return b}return a},__class__:ib};var Ee=function(a){this.stree=this.dtree=this.pairs=
this.syncs=this.moves=null;xc.call(this);this.space=a;this.is_sweep=!1;this.dynab=this;this.stree=new ib;this.dtree=new ib};Ee.__name__=!0;Ee.__super__=xc;Ee.prototype=r(xc.prototype,{__insert:function(a){var b;null==La.zpp_pool?b=new La:(b=La.zpp_pool,La.zpp_pool=b.next,b.next=null);null==ra.zpp_pool?b.aabb=new ra:(b.aabb=ra.zpp_pool,ra.zpp_pool=b.aabb.next,b.aabb.next=null);null;b.moved=!1;b.synced=!1;b.first_sync=!1;b.shape=a;a.node=b;b.synced=!0;b.first_sync=!0;b.snext=this.syncs;this.syncs=b},
__remove:function(a){var b=a.node;b.first_sync||(b.dyn?this.dtree.removeLeaf(b):this.stree.removeLeaf(b));a.node=null;if(b.synced){for(var c=null,d=this.syncs;null!=d&&!(d==b);){c=d;d=d.snext}null==c?this.syncs=d.snext:c.snext=d.snext;d.snext=null;b.synced=!1}if(b.moved){c=null;for(d=this.moves;null!=d&&!(d==b);){c=d;d=d.mnext}null==c?this.moves=d.mnext:c.mnext=d.mnext;d.mnext=null;b.moved=!1}for(var c=null,e=this.pairs;null!=e;)d=e.next,e.n1==b||e.n2==b?(null==c?this.pairs=d:c.next=d,null!=e.arb&&
(e.arb.pair=null),e.arb=null,e.n1.shape.pairs.remove(e),e.n2.shape.pairs.remove(e),e.n1=e.n2=null,e.sleeping=!1,e.next=W.zpp_pool,W.zpp_pool=e):c=e,e=d;for(;null!=a.pairs.head;)c=a.pairs.pop_unsafe(),c.n1==b?c.n2.shape.pairs.remove(c):c.n1.shape.pairs.remove(c),null!=c.arb&&(c.arb.pair=null),c.arb=null,c.n1=c.n2=null,c.sleeping=!1,c.next=W.zpp_pool,W.zpp_pool=c;b.free();b.next=La.zpp_pool;La.zpp_pool=b},__sync:function(a){var b=a.node;if(!b.synced&&(!this.space.continuous&&a.zip_aabb&&null!=a.body&&
(a.zip_aabb=!1,a.type==i.id_ShapeType_CIRCLE?a.circle.__validate_aabb():a.polygon.__validate_aabb()),b.dyn!=(a.body.type==i.id_BodyType_STATIC?!1:!a.body.component.sleeping)||!b.aabb.contains(a.aabb)))b.synced=!0,b.snext=this.syncs,this.syncs=b},broadphase:function(a,b){for(var c=this.syncs;null!=c;){var d=c.shape;c.first_sync?c.first_sync=!1:(c.dyn?this.dtree:this.stree).inlined_removeLeaf(c);var e=c.aabb;!a.continuous&&d.zip_aabb&&null!=d.body&&(d.zip_aabb=!1,d.type==i.id_ShapeType_CIRCLE?d.circle.__validate_aabb():
d.polygon.__validate_aabb());e.setExpand(d.aabb,3);((d.body.type==i.id_BodyType_STATIC?c.dyn=!1:c.dyn=!d.body.component.sleeping)?this.dtree:this.stree).inlined_insertLeaf(c);c.synced=!1;c=c.snext}for(;null!=this.syncs;)if(c=this.syncs,this.syncs=c.snext,c.snext=null,!c.moved&&(c.moved=!1,d=c.shape,!d.body.component.sleeping)){var e=c.aabb,f=null;null!=this.dtree.root&&(this.dtree.root.next=f,f=this.dtree.root);for(;null!=f;){var h;h=f;f=h.next;h.next=null;if(h!=c)if(null==h.child1){var g=h.shape;
if(g.body!=d.body&&!(g.body.type==i.id_BodyType_STATIC&&d.body.type==i.id_BodyType_STATIC)&&e.intersect(h.aabb)){var l,j;d.id<g.id?(l=d.id,j=g.id):(l=g.id,j=d.id);for(var k=null,n=(d.pairs.length<g.pairs.length?d:g).pairs.head;null!=n;){var q=n.elt;if(q.id==l&&q.di==j){k=q;break}n=n.next}null!=k?k.sleeping&&(k.sleeping=!1,k.next=this.pairs,this.pairs=k,k.first=!0):(null==W.zpp_pool?k=new W:(k=W.zpp_pool,W.zpp_pool=k.next,k.next=null),null,k.n1=c,k.n2=h,k.id=l,k.di=j,k.next=this.pairs,this.pairs=k,
k.first=!0,d.pairs.inlined_add(k),g.pairs.inlined_add(k))}}else e.intersect(h.aabb)&&(null!=h.child1&&(h.child1.next=f,f=h.child1),null!=h.child2&&(h.child2.next=f,f=h.child2))}null!=this.stree.root&&(this.stree.root.next=f,f=this.stree.root);for(;null!=f;)if(h=f,f=h.next,h.next=null,h!=c)if(null==h.child1){if(g=h.shape,g.body!=d.body&&!(g.body.type==i.id_BodyType_STATIC&&d.body.type==i.id_BodyType_STATIC)&&e.intersect(h.aabb)){d.id<g.id?(l=d.id,j=g.id):(l=g.id,j=d.id);k=null;for(n=(d.pairs.length<
g.pairs.length?d:g).pairs.head;null!=n;){q=n.elt;if(q.id==l&&q.di==j){k=q;break}n=n.next}null!=k?k.sleeping&&(k.sleeping=!1,k.next=this.pairs,this.pairs=k,k.first=!0):(null==W.zpp_pool?k=new W:(k=W.zpp_pool,W.zpp_pool=k.next,k.next=null),null,k.n1=c,k.n2=h,k.id=l,k.di=j,k.next=this.pairs,this.pairs=k,k.first=!0,d.pairs.inlined_add(k),g.pairs.inlined_add(k))}}else e.intersect(h.aabb)&&(null!=h.child1&&(h.child1.next=f,f=h.child1),null!=h.child2&&(h.child2.next=f,f=h.child2))}for(;null!=this.moves;)if(c=
this.moves,this.moves=c.mnext,c.mnext=null,c.moved=!1,d=c.shape,!d.body.component.sleeping){e=c.aabb;f=null;null!=this.dtree.root&&(this.dtree.root.next=f,f=this.dtree.root);for(;null!=f;)if(h=f,f=h.next,h.next=null,h!=c)if(null==h.child1){if(g=h.shape,g.body!=d.body&&!(g.body.type==i.id_BodyType_STATIC&&d.body.type==i.id_BodyType_STATIC)&&e.intersect(h.aabb)){d.id<g.id?(l=d.id,j=g.id):(l=g.id,j=d.id);k=null;for(n=(d.pairs.length<g.pairs.length?d:g).pairs.head;null!=n;){q=n.elt;if(q.id==l&&q.di==
j){k=q;break}n=n.next}null!=k?k.sleeping&&(k.sleeping=!1,k.next=this.pairs,this.pairs=k,k.first=!0):(null==W.zpp_pool?k=new W:(k=W.zpp_pool,W.zpp_pool=k.next,k.next=null),null,k.n1=c,k.n2=h,k.id=l,k.di=j,k.next=this.pairs,this.pairs=k,k.first=!0,d.pairs.inlined_add(k),g.pairs.inlined_add(k))}}else e.intersect(h.aabb)&&(null!=h.child1&&(h.child1.next=f,f=h.child1),null!=h.child2&&(h.child2.next=f,f=h.child2));null!=this.stree.root&&(this.stree.root.next=f,f=this.stree.root);for(;null!=f;)if(h=f,f=
h.next,h.next=null,h!=c)if(null==h.child1){if(g=h.shape,g.body!=d.body&&!(g.body.type==i.id_BodyType_STATIC&&d.body.type==i.id_BodyType_STATIC)&&e.intersect(h.aabb)){d.id<g.id?(l=d.id,j=g.id):(l=g.id,j=d.id);k=null;for(n=(d.pairs.length<g.pairs.length?d:g).pairs.head;null!=n;){q=n.elt;if(q.id==l&&q.di==j){k=q;break}n=n.next}null!=k?k.sleeping&&(k.sleeping=!1,k.next=this.pairs,this.pairs=k,k.first=!0):(null==W.zpp_pool?k=new W:(k=W.zpp_pool,W.zpp_pool=k.next,k.next=null),null,k.n1=c,k.n2=h,k.id=l,
k.di=j,k.next=this.pairs,this.pairs=k,k.first=!0,d.pairs.inlined_add(k),g.pairs.inlined_add(k))}}else e.intersect(h.aabb)&&(null!=h.child1&&(h.child1.next=f,f=h.child1),null!=h.child2&&(h.child2.next=f,f=h.child2))}c=null;for(d=this.pairs;null!=d;)!d.first&&!d.n1.aabb.intersect(d.n2.aabb)?(null==c?this.pairs=d.next:c.next=d.next,d.n1.shape.pairs.inlined_try_remove(d),d.n2.shape.pairs.inlined_try_remove(d),e=d.next,null!=d.arb&&(d.arb.pair=null),d.arb=null,d.n1=d.n2=null,d.sleeping=!1,d.next=W.zpp_pool,
W.zpp_pool=d,d=e):(e=d.n1.shape,f=e.body,h=d.n2.shape,g=h.body,!d.first&&(f.component.sleeping||f.type==i.id_BodyType_STATIC)&&(g.component.sleeping||g.type==i.id_BodyType_STATIC)?(d.sleeping=!0,null==c?this.pairs=d.next:c.next=d.next):(d.first=!1,e.aabb.intersect(h.aabb)&&(c=d.arb,d.arb=b?a.narrowPhase(e,h,f.type!=i.id_BodyType_DYNAMIC||g.type!=i.id_BodyType_DYNAMIC,d.arb,!1):a.continuousEvent(e,h,f.type!=i.id_BodyType_DYNAMIC||g.type!=i.id_BodyType_DYNAMIC,d.arb,!1),null==d.arb?null!=c&&(c.pair=
null):d.arb.pair=d),c=d),d=d.next)},__class__:Ee});var nb=function(){this.waket=0;this.sleep=!1;this.comps=null;this.length=0;this._inuse=this.modified=this.pushmod=!1;this.next=null;this.comps=new Tf};nb.__name__=!0;nb.prototype={inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},
inlined_pop_unsafe:function(){var a=this.next;this.pop();return a},__class__:nb};var gc=function(){this.woken=!1;this.waket=0;this.sleeping=!1;this.body=this.constraint=this.island=null;this.isBody=!1;this.rank=0;this.next=this.parent=null;this.sleeping=!1;this.island=null;this.parent=this;this.rank=0;this.woken=!1};gc.__name__=!0;gc.prototype={__class__:gc};var Ga=function(){this.freed=this.lazydel=!1;this.length=0;this._inuse=this.modified=this.pushmod=!1;this.int1=this.int2=this.next=null;this.id=
this.di=0;this.arbiters=new Pd};Ga.__name__=!0;Ga.get=function(a,b){var c;null==Ga.zpp_pool?c=new Ga:(c=Ga.zpp_pool,Ga.zpp_pool=c.next,c.next=null);c.freed=!1;c.lazydel=!1;c.COLLISIONstate=i.id_PreFlag_ACCEPT;c.COLLISIONstamp=0;c.SENSORstate=i.id_PreFlag_ACCEPT;c.SENSORstamp=0;c.FLUIDstate=i.id_PreFlag_ACCEPT;c.FLUIDstamp=0;a.id<b.id?(c.int1=a,c.int2=b):(c.int1=b,c.int2=a);c.id=c.int1.id;c.di=c.int2.id;return c};Ga.prototype={inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=
!0;this.length++;return a},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},remove_arb:function(a){this.arbiters.inlined_try_remove(a)},empty_arb:function(a){var b;b=!0;for(var c=this.arbiters.head;null!=c;)if(0==(c.elt.type&a))c=c.next;else{b=!1;break}return b},sleeping:function(){var a;a=!0;for(var b=this.arbiters.head;null!=
b;)if(b.elt.sleeping)b=b.next;else{a=!1;break}return a},__class__:Ga};var Uf=function(a){this.cbsets=this.space=null;null==Lb.zpp_pool?this.cbsets=new Lb:(this.cbsets=Lb.zpp_pool,Lb.zpp_pool=this.cbsets.next,this.cbsets.next=null);null;this.cbsets.lt=aa.setlt;this.space=a};Uf.__name__=!0;Uf.prototype={get:function(a){if(null==a.head)return null;var b;null==aa.zpp_pool?b=new aa:(b=aa.zpp_pool,aa.zpp_pool=b.next,b.next=null);null;var c=b.cbTypes;b.cbTypes=a;var d=this.cbsets.find_weak(b);null!=d?a=
d.data:(a=aa.get(a),this.cbsets.insert(a),a.manager=this);b.cbTypes=c;b.free();b.next=aa.zpp_pool;aa.zpp_pool=b;return a},remove:function(a){for(this.cbsets.remove(a);null!=a.cbpairs.head;){var b=a.cbpairs.pop_unsafe();b.a!=b.b&&(a==b.a?b.b.cbpairs.remove(b):b.a.cbpairs.remove(b));b.a=b.b=null;b.listeners.clear();b.next=Ea.zpp_pool;Ea.zpp_pool=b}a.manager=null},validate:function(){if(!this.cbsets.empty()){for(var a=this.cbsets.parent;null!=a.prev;)a=a.prev;for(;null!=a;)if(a.data.validate(),null!=
a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{for(;null!=a.parent&&a==a.parent.next;)a=a.parent;a=a.parent}}},pair:function(a,b){for(var c=null,d=(a.cbpairs.length<b.cbpairs.length?a.cbpairs:b.cbpairs).head;null!=d;){var e=d.elt;if(e.a==a&&e.b==b||e.a==b&&e.b==a){c=e;break}d=d.next}null==c&&(c=Ea.get(a,b),a.cbpairs.add(c),b!=a&&b.cbpairs.add(c));c.zip_listeners&&(c.zip_listeners=!1,c.__validate());return c},__class__:Uf};var Hf=function(a,b){this.precb=this.prelisteners=null;this.continuous=!1;
this.toiEvents=null;this.pre_dt=0;this.c_arbiters_true=this.c_arbiters_false=this.f_arbiters=this.s_arbiters=this.live=this.wrap_live=this.live_constraints=this.wrap_livecon=this.staticsleep=this.islands=this.listeners=this.wrap_listeners=this.callbacks=this.callbackset_list=this.cbsets=null;this.sortcontacts=!1;this.time=0;this.midstep=!1;this.global_lin_drag=this.global_ang_drag=this.stamp=0;this.bodies=this.wrap_bodies=this.compounds=this.wrap_compounds=this.constraints=this.wrap_constraints=this.kinematics=
this.bphase=this.__static=null;this.gravityx=this.gravityy=0;this.outer=null;this.toiEvents=new Vf;this.global_ang_drag=this.global_lin_drag=0.015;N.internal=!0;this.precb=new ad;this.precb.zpp_inner=new N;N.internal=!1;this.sortcontacts=!0;this.pre_dt=0;var c;if(!(c=null==b))null==i.Broadphase_DYNAMIC_AABB_TREE&&(i.internal=!0,i.Broadphase_DYNAMIC_AABB_TREE=new Hc,i.internal=!1),c=b==i.Broadphase_DYNAMIC_AABB_TREE;c?this.bphase=new Ee(this):(null==i.Broadphase_SWEEP_AND_PRUNE&&(i.internal=!0,i.Broadphase_SWEEP_AND_PRUNE=
new Hc,i.internal=!1),b==i.Broadphase_SWEEP_AND_PRUNE&&(this.bphase=new Fe(this)));this.time=0;null!=a?(this.gravityx=a.x,this.gravityy=a.y):this.gravityy=this.gravityx=0;this.bodies=new yc;this.wrap_bodies=pb.get(this.bodies);this.wrap_bodies.zpp_inner.adder=E(this,this.bodies_adder);this.wrap_bodies.zpp_inner.subber=E(this,this.bodies_subber);this.wrap_bodies.zpp_inner._modifiable=E(this,this.bodies_modifiable);this.compounds=new Ge;this.wrap_compounds=Vb.get(this.compounds);this.wrap_compounds.zpp_inner.adder=
E(this,this.compounds_adder);this.wrap_compounds.zpp_inner.subber=E(this,this.compounds_subber);this.wrap_compounds.zpp_inner._modifiable=E(this,this.compounds_modifiable);this.kinematics=new yc;this.c_arbiters_true=new He;this.c_arbiters_false=new He;this.f_arbiters=new Wf;this.s_arbiters=new Xf;this.islands=new nb;this.live=new yc;this.wrap_live=pb.get(this.live,!0);this.staticsleep=new yc;this.constraints=new Ic;this.wrap_constraints=dc.get(this.constraints);this.wrap_constraints.zpp_inner.adder=
E(this,this.constraints_adder);this.wrap_constraints.zpp_inner.subber=E(this,this.constraints_subber);this.wrap_constraints.zpp_inner._modifiable=E(this,this.constraints_modifiable);this.live_constraints=new Ic;this.wrap_livecon=dc.get(this.live_constraints,!0);this.__static=rb.__static();this.__static.zpp_inner.space=this;this.callbacks=new N;this.midstep=!1;this.listeners=new Ie;this.wrap_listeners=Sb.get(this.listeners);this.wrap_listeners.zpp_inner.adder=E(this,this.listeners_adder);this.wrap_listeners.zpp_inner.subber=
E(this,this.listeners_subber);this.wrap_listeners.zpp_inner._modifiable=E(this,this.listeners_modifiable);this.callbackset_list=new Ga;this.mrca1=new Jc;this.mrca2=new Jc;this.prelisteners=new cd;this.cbsets=new Uf(this)};Hf.__name__=!0;Hf.prototype={bodies_adder:function(a){if(null!=a.zpp_inner.compound)throw new j("Error: Cannot set the space of a Body belonging to a Compound, only the root Compound space can be set");return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.outer.zpp_inner.wrap_bodies.remove(a),
this.addBody(a.zpp_inner),!0):!1},bodies_subber:function(a){this.remBody(a.zpp_inner)},bodies_modifiable:function(){if(this.midstep)throw new j("Error: Space::bodies cannot be set during space step()");},compounds_adder:function(a){if(null!=a.zpp_inner.compound)throw new j("Error: Cannot set the space of an inner Compound, only the root Compound space can be set");return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.wrap_compounds.remove(a),this.addCompound(a.zpp_inner),!0):
!1},compounds_subber:function(a){this.remCompound(a.zpp_inner)},compounds_modifiable:function(){if(this.midstep)throw new j("Error: Space::compounds cannot be set during space step()");},constraints_adder:function(a){if(null!=a.zpp_inner.compound)throw new j("Error: Cannot set the space of a Constraint belonging to a Compound, only the root Compound space can be set");return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.outer.zpp_inner.wrap_constraints.remove(a),this.addConstraint(a.zpp_inner),
!0):!1},constraints_subber:function(a){this.remConstraint(a.zpp_inner)},constraints_modifiable:function(){if(this.midstep)throw new j("Error: Space::constraints cannot be set during space step()");},listeners_adder:function(a){return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.outer.zpp_inner.wrap_listeners.remove(a),this.addListener(a.zpp_inner),!0):!1},listeners_subber:function(a){this.remListener(a.zpp_inner)},listeners_modifiable:function(){if(this.midstep)throw new j("Error: Space::listeners cannot be set during space step()");
},addListener:function(a){a.space=this;a.addedToSpace();null!=a.interaction&&null},remListener:function(a){null!=a.interaction&&null;a.removedFromSpace();a.space=null},add_callbackset:function(a){a.int1.cbsets.inlined_add(a);a.int2.cbsets.inlined_add(a);this.callbackset_list.inlined_add(a)},remove_callbackset:function(a){a.lazydel=!0;a.int1.cbsets.inlined_try_remove(a);a.int2.cbsets.inlined_try_remove(a)},transmitType:function(a,b){a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==
i.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!1));a.type==i.id_BodyType_DYNAMIC?this.live.remove(a):a.type==i.id_BodyType_KINEMATIC?(this.kinematics.remove(a),this.staticsleep.remove(a)):a.type==i.id_BodyType_STATIC&&this.staticsleep.remove(a);a.type=b;a.type==i.id_BodyType_KINEMATIC&&this.kinematics.add(a);a.type==i.id_BodyType_STATIC&&this.static_validation(a);a.component.sleeping=!0;a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==
i.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0))},added_shape:function(a,b){null==b&&(b=!1);if(!b){var c=a.body;c.world||(c.component.waket=this.stamp+(this.midstep?0:1),c.type==i.id_BodyType_KINEMATIC&&(c.kinematicDelaySleep=!0),c.component.sleeping&&this.really_wake(c,!1))}this.bphase.insert(a);a.addedToSpace()},removed_shape:function(a,b){null==b&&(b=!1);var c=this,d=a.body;b||d.wake();for(var e=null,f=d.arbiters.head;null!=f;){var h=[f.elt];if(h[0].ws1==
a||h[0].ws2==a){if(0!=h[0].present){this.MRCA_chains(h[0].ws1,h[0].ws2);for(f=this.mrca1.head;null!=f;){for(var g=f.elt,l=this.mrca2.head;null!=l;){var j=l.elt,k=g.cbSet,n=j.cbSet;k.validate();n.validate();k.manager.pair(k,n).empty_intersection()||(j=[ha.get(g,j)],j[0].remove_arb(h[0]),h[0].present--,k.manager.pair(k,n).forall(i.id_CbEvent_END,function(a,b){return function(d){if(0!=(d.itype&b[0].type)&&a[0].empty_arb(d.itype)){var e=c.push_callback(d);e.event=i.id_CbEvent_END;ha.int_callback(a[0],
d,e);e.set=a[0]}}}(j,h)),null==j[0].arbiters.head&&this.remove_callbackset(j[0]));l=l.next}f=f.next}}h[0].b1!=d&&h[0].b1.type==i.id_BodyType_DYNAMIC&&(f=h[0].b1,f.world||(f.component.waket=this.stamp+(this.midstep?0:1),f.type==i.id_BodyType_KINEMATIC&&(f.kinematicDelaySleep=!0),f.component.sleeping&&this.really_wake(f,!1)));h[0].b2!=d&&h[0].b2.type==i.id_BodyType_DYNAMIC&&(f=h[0].b2,f.world||(f.component.waket=this.stamp+(this.midstep?0:1),f.type==i.id_BodyType_KINEMATIC&&(f.kinematicDelaySleep=!0),
f.component.sleeping&&this.really_wake(f,!1)));h[0].cleared=!0;(null==d||h[0].b2==d)&&h[0].b1.arbiters.inlined_try_remove(h[0]);(null==d||h[0].b1==d)&&h[0].b2.arbiters.inlined_try_remove(h[0]);null!=h[0].pair&&(h[0].pair.arb=null,h[0].pair=null);h[0].active=!1;this.f_arbiters.modified=!0;f=d.arbiters.erase(e)}else e=f,f=f.next}this.bphase.remove(a);a.removedFromSpace()},addConstraint:function(a){a.space=this;a.addedToSpace();a.active&&(a.component.sleeping=!0,this.wake_constraint(a,!0))},remConstraint:function(a){a.active&&
(this.wake_constraint(a,!0),this.live_constraints.remove(a));a.removedFromSpace();a.space=null},addCompound:function(a){a.space=this;a.addedToSpace();for(var b=a.bodies.head;null!=b;)this.addBody(b.elt),b=b.next;for(b=a.constraints.head;null!=b;)this.addConstraint(b.elt),b=b.next;for(a=a.compounds.head;null!=a;)this.addCompound(a.elt),a=a.next},remCompound:function(a){for(var b=a.bodies.head;null!=b;)this.remBody(b.elt),b=b.next;for(b=a.constraints.head;null!=b;)this.remConstraint(b.elt),b=b.next;
for(b=a.compounds.head;null!=b;)this.remCompound(b.elt),b=b.next;a.removedFromSpace();a.space=null},addBody:function(a,b){null==b&&(b=-1);a.space=this;a.addedToSpace();a.component.sleeping=!0;a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==i.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0));for(var c=a.shapes.head;null!=c;)this.added_shape(c.elt,!0),c=c.next;a.type==i.id_BodyType_STATIC?this.static_validation(a):a.type!=i.id_BodyType_DYNAMIC&&
b!=i.id_BodyType_KINEMATIC&&this.kinematics.add(a)},remBody:function(a,b){null==b&&(b=-1);a.type==i.id_BodyType_STATIC?(a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==i.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0)),this.staticsleep.remove(a)):a.type==i.id_BodyType_DYNAMIC?(a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==i.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,
!0)),this.live.remove(a)):(b!=i.id_BodyType_KINEMATIC&&this.kinematics.remove(a),a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==i.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0)),this.staticsleep.remove(a));for(var c=a.shapes.head;null!=c;)this.removed_shape(c.elt,!0),c=c.next;a.removedFromSpace();a.space=null},push_callback:function(a){var b;null==N.zpp_pool?b=new N:(b=N.zpp_pool,N.zpp_pool=b.next,b.next=null);null;this.callbacks.push(b);
b.listener=a;return b},step:function(a,b,c){var d=this;if(this.midstep)throw new j("Error: ... REALLY?? you're going to call space.step() inside of space.step()? COME ON!!");this.time+=a;this.pre_dt=a;this.midstep=!0;this.stamp++;this.validation();this.bphase.broadphase(this,!0);this.prestep(a);if(this.sortcontacts){var e=this.c_arbiters_false;if(null!=e.head&&null!=e.head.next){var f=e.head,h=null,g=null,l=null,k=null,n=1,o,q,s;do{o=0;g=f;for(h=f=null;null!=g;){o++;l=g;q=0;for(s=n;null!=l&&q<n;)q++,
l=l.next;for(;0<q||0<s&&null!=l;)0==q?(k=l,l=l.next,s--):0==s||null==l?(k=g,g=g.next,q--):(g.elt.active&&l.elt.active?g.elt.oc1.dist<l.elt.oc1.dist:1)?(k=g,g=g.next,q--):(k=l,l=l.next,s--),null!=h?h.next=k:f=k,h=k;g=l}h.next=null;n<<=1}while(1<o);e.head=f;e.modified=!0;e.pushmod=!0}}this.updateVel(a);this.warmStart();this.iterateVel(b);for(b=this.kinematics.head;null!=b;)e=b.elt,e.pre_posx=e.posx,e.pre_posy=e.posy,e.pre_rot=e.rot,b=b.next;for(b=this.live.head;null!=b;)e=b.elt,e.pre_posx=e.posx,e.pre_posy=
e.posy,e.pre_rot=e.rot,b=b.next;this.updatePos(a);this.continuous=!0;this.continuousCollisions(a);this.continuous=!1;this.iteratePos(c);for(c=this.kinematics.head;null!=c;)b=c.elt,e=b.pre_rot!=b.rot,!(b.posx==b.pre_posx&&b.posy==b.pre_posy)&&b.invalidate_pos(),e&&b.invalidate_rot(),c=c.next;for(c=this.live.head;null!=c;)b=c.elt,e=b.pre_rot!=b.rot,!(b.posx==b.pre_posx&&b.posy==b.pre_posy)&&b.invalidate_pos(),e&&b.invalidate_rot(),c=c.next;c=null;for(b=this.staticsleep.head;null!=b;)e=b.elt,e.type!=
i.id_BodyType_KINEMATIC||0==e.velx&&0==e.vely&&0==e.angvel?e.kinematicDelaySleep?(e.kinematicDelaySleep=!1,b=b.next):(e.component.sleeping=!0,b=this.staticsleep.inlined_erase(c)):(c=b,b=b.next);this.doForests(a);this.sleepArbiters();this.midstep=!1;c=null;for(a=this.callbackset_list.next;null!=a;)b=[a],null==b[0].arbiters.head?(a=this.callbackset_list.inlined_erase(c),b=b[0],b.int1=b.int2=null,b.id=b.di=-1,b.freed=!0,null,b.next=Ga.zpp_pool,Ga.zpp_pool=b):(c=[b[0].sleeping()],aa.find_all(b[0].int1.cbSet,
b[0].int2.cbSet,i.id_CbEvent_ONGOING,function(a,b){return function(c){if((!a[0]||c.allowSleepingCallbacks)&&!b[0].empty_arb(c.itype)){var e=d.push_callback(c);e.event=i.id_CbEvent_ONGOING;ha.int_callback(b[0],c,e);e.set=b[0]}}}(c,b)),c=a,a=a.next);for(;!this.callbacks.empty();)a=this.callbacks.pop(),a.listener.type==i.id_ListenerType_BODY?a.listener.body.handler(a.wrapper_body()):a.listener.type==i.id_ListenerType_CONSTRAINT?a.listener.constraint.handler(a.wrapper_con()):a.listener.type==i.id_ListenerType_INTERACTION&&
a.listener.interaction.handleri(a.wrapper_int()),a.int1=a.int2=null,a.body=null,a.constraint=null,a.listener=null,null!=a.wrap_arbiters&&(a.wrap_arbiters.zpp_inner.inner=null),a.set=null,a.next=N.zpp_pool,N.zpp_pool=a},continuousCollisions:function(a){var b=2*Math.PI/a;this.bphase.broadphase(this,!1);for(var c=0;1>c&&null!=this.toiEvents.head;){for(var d=null,c=2,e=!1,f=null,h=null,g=this.toiEvents.head;null!=g;){var l=g.elt,j=l.s1.body,n=l.s2.body;if(j.sweepFrozen&&n.sweepFrozen)if(0!=l.toi&&s.testCollide_safe(l.s1,
l.s2))l.toi=0;else{g=this.toiEvents.erase(h);l.next=Ba.zpp_pool;Ba.zpp_pool=l;continue}if(l.frozen1!=j.sweepFrozen||l.frozen2!=n.sweepFrozen)if(l.kinematic){g=this.toiEvents.erase(h);l.next=Ba.zpp_pool;Ba.zpp_pool=l;continue}else if(l.frozen1=j.sweepFrozen,l.frozen2=n.sweepFrozen,l.frozen1&&(j=l.s1,l.s1=l.s2,l.s2=j,l.frozen1=!1,l.frozen2=!0),Zb.staticSweep(l,a,0,k.collisionSlopCCD),0>l.toi){g=this.toiEvents.erase(h);l.next=Ba.zpp_pool;Ba.zpp_pool=l;continue}if(0<=l.toi&&(l.toi<c||!e&&l.kinematic))d=
l,c=l.toi,e=l.kinematic,f=h;h=g;g=g.next}if(null==d)break;this.toiEvents.erase(f);c=d.toi;e=d.s1.body;f=d.s2.body;e.sweepFrozen||(e.sweepIntegrate(c*a),e.sweepValidate(d.s1));f.sweepFrozen||(f.sweepIntegrate(c*a),f.sweepValidate(d.s2));h=this.narrowPhase(d.s1,d.s2,!0,d.arbiter,!0);null==h?null!=d.arbiter&&null!=d.arbiter.pair&&(d.arbiter.pair.arb=null,d.arbiter.pair=null):!this.presteparb(h,a,!0)&&h.type==D.COL&&h.active&&0!=(h.immState&i.id_ImmState_ACCEPT)&&(h.colarb.warmStart(),h.colarb.applyImpulseVel(),
h.colarb.applyImpulseVel(),h.colarb.applyImpulseVel(),h.colarb.applyImpulseVel(),e.sweep_angvel=e.angvel%b,f.sweep_angvel=f.angvel%b);null!=h&&h.active&&0!=(h.immState&i.id_ImmState_ACCEPT)&&h.type==D.COL&&(!e.sweepFrozen&&e.type!=i.id_BodyType_KINEMATIC&&(e.sweepFrozen=!0,e.angvel=d.failed?e.sweep_angvel=0:d.slipped?e.sweep_angvel*=k.angularCCDSlipScale:e.sweep_angvel),!f.sweepFrozen&&f.type!=i.id_BodyType_KINEMATIC&&(f.sweepFrozen=!0,f.angvel=d.failed?f.sweep_angvel=0:d.slipped?f.sweep_angvel*=
k.angularCCDSlipScale:f.sweep_angvel));d.next=Ba.zpp_pool;Ba.zpp_pool=d}for(;null!=this.toiEvents.head;)b=this.toiEvents.pop_unsafe(),b.next=Ba.zpp_pool,Ba.zpp_pool=b;for(b=this.kinematics.head;null!=b;)d=b.elt,d.sweepIntegrate(a),d.sweepTime=0,b=b.next;for(b=this.live.head;null!=b;)d=b.elt,d.sweepFrozen||d.sweepIntegrate(a),d.sweepTime=0,b=b.next},continuousEvent:function(a,b,c,d){if(a.body.sweepFrozen&&b.body.sweepFrozen||a.body.disableCCD||b.body.disableCCD||null!=d&&null==d.colarb||0>=this.interactionType(a,
b,a.body,b.body))return d;var e=a.body,f=b.body;if(c||e.bullet||f.bullet){var h;null==Ba.zpp_pool?h=new Ba:(h=Ba.zpp_pool,Ba.zpp_pool=h.next,h.next=null);h.failed=!1;h.s1=h.s2=null;h.arbiter=null;e=e.type==i.id_BodyType_KINEMATIC||f.type==i.id_BodyType_KINEMATIC;c&&!e?(a.body.type!=i.id_BodyType_DYNAMIC?(h.s2=a,h.s1=b):(h.s1=a,h.s2=b),h.kinematic=!1,Zb.staticSweep(h,this.pre_dt,0,k.collisionSlopCCD)):(h.s1=a,h.s2=b,h.kinematic=e,h.s1.body.sweepFrozen||h.s2.body.sweepFrozen?(h.s1.body.sweepFrozen&&
(a=h.s1,h.s1=h.s2,h.s2=a,h.frozen1=!1,h.frozen2=!0),Zb.staticSweep(h,this.pre_dt,0,k.collisionSlopCCD)):Zb.dynamicSweep(h,this.pre_dt,0,k.collisionSlopCCD));c&&0>h.toi||h.failed?(c=h,c.next=Ba.zpp_pool,Ba.zpp_pool=c):(this.toiEvents.add(h),h.frozen1=h.s1.body.sweepFrozen,h.frozen2=h.s2.body.sweepFrozen,h.arbiter=null!=d?d.colarb:null)}return d},bodyCbWake:function(a){if(a.type==i.id_BodyType_DYNAMIC&&null!=a.cbSet)if(this.midstep)for(var b=a.cbSet.bodylisteners.head;null!=b;){var c=b.elt;c.event==
i.id_CbEvent_WAKE&&(c=this.push_callback(c),c.event=i.id_CbEvent_WAKE,c.body=a);b=b.next}else a.component.woken=!0},bodyCbSleep:function(a){if(a.type==i.id_BodyType_DYNAMIC&&null!=a.cbSet)for(var b=a.cbSet.bodylisteners.head;null!=b;){var c=b.elt;c.event==i.id_CbEvent_SLEEP&&(c=this.push_callback(c),c.event=i.id_CbEvent_SLEEP,c.body=a);b=b.next}},constraintCbWake:function(a){if(null!=a.cbSet)if(this.midstep)for(var b=a.cbSet.conlisteners.head;null!=b;){var c=b.elt;c.event==i.id_CbEvent_WAKE&&(c=this.push_callback(c),
c.event=i.id_CbEvent_WAKE,c.constraint=a);b=b.next}else a.component.woken=!0},constraintCbSleep:function(a){if(null!=a.cbSet)for(var b=a.cbSet.conlisteners.head;null!=b;){var c=b.elt;c.event==i.id_CbEvent_SLEEP&&(c=this.push_callback(c),c.event=i.id_CbEvent_SLEEP,c.constraint=a);b=b.next}},constraintCbBreak:function(a){if(null!=a.cbSet)for(var b=a.cbSet.conlisteners.head;null!=b;){var c=b.elt;c.event==i.id_CbEvent_BREAK&&(c=this.push_callback(c),c.event=i.id_CbEvent_BREAK,c.constraint=a);b=b.next}},
nullListenerType:function(a,b){for(var c=new Jc,d=a.interactors.head;null!=d;)c.add(d.elt),d=d.next;if(a!=b)for(d=b.interactors.head;null!=d;)c.add(d.elt),d=d.next;for(;null!=c.head;)if(d=c.pop_unsafe(),null!=d.icompound){for(var d=d.icompound,e=d.bodies.head;null!=e;)c.add(e.elt),e=e.next;for(d=d.compounds.head;null!=d;)c.add(d.elt),d=d.next}else{e=null!=d.ibody?d.ibody:d.ishape.body;d=null!=d.ishape?d.ishape:null;for(e=e.arbiters.head;null!=e;){var f=e.elt;if(0!=f.present&&(null==d||f.ws1==d||f.ws2==
d)){this.MRCA_chains(f.ws1,f.ws2);for(f=this.mrca1.head;null!=f;){var h=f.elt;if(!(h.cbSet!=a&&h.cbSet!=b))for(var g=this.mrca2.head;null!=g;){var i=g.elt;if(!(h.cbSet==a&&i.cbSet!=b||h.cbSet==b&&i.cbSet!=a))if(i=ha.get(h,i),null!=i){for(;null!=i.arbiters.head;)i.arbiters.pop_unsafe().present--;this.remove_callbackset(i)}g=g.next}f=f.next}}e=e.next}}},nullInteractorType:function(a,b){null==b&&(b=a);if(null!=a.icompound){for(var c=a.icompound,d=c.bodies.head;null!=d;)this.nullInteractorType(d.elt,
b),d=d.next;for(c=c.compounds.head;null!=c;)this.nullInteractorType(c.elt,b),c=c.next}else{d=null!=a.ibody?a.ibody:a.ishape.body;c=null!=a.ishape?a.ishape:null;for(d=d.arbiters.head;null!=d;){var e=d.elt;if(0!=e.present&&(null==c||e.ws1==c||e.ws2==c)){this.MRCA_chains(e.ws1,e.ws2);for(var f=this.mrca1.head;null!=f;){for(var h=f.elt,g=this.mrca2.head;null!=g;){var i=g.elt;h!=b&&i!=b||(i=ha.get(h,i),null!=i&&(e.present--,i.remove_arb(e),null==i.arbiters.head&&this.remove_callbackset(i)));g=g.next}f=
f.next}}d=d.next}}},freshListenerType:function(a,b){for(var c=new Jc,d=a.interactors.head;null!=d;)c.add(d.elt),d=d.next;if(a!=b)for(d=b.interactors.head;null!=d;)c.add(d.elt),d=d.next;for(;null!=c.head;)if(d=c.pop_unsafe(),null!=d.icompound){for(var d=d.icompound,e=d.bodies.head;null!=e;)c.add(e.elt),e=e.next;for(d=d.compounds.head;null!=d;)c.add(d.elt),d=d.next}else{e=null!=d.ibody?d.ibody:d.ishape.body;d=null!=d.ishape?d.ishape:null;for(e=e.arbiters.head;null!=e;){var f=e.elt;if(f.presentable&&
(null==d||f.ws1==d||f.ws2==d)){this.MRCA_chains(f.ws1,f.ws2);for(var h=this.mrca1.head;null!=h;){var g=h.elt;if(!(g.cbSet!=a&&g.cbSet!=b))for(var i=this.mrca2.head;null!=i;){var j=i.elt;if(!(g.cbSet==a&&j.cbSet!=b||g.cbSet==b&&j.cbSet!=a)){var k=ha.get(g,j);null==k&&(k=Ga.get(g,j),this.add_callbackset(k));if(j=!k.arbiters.inlined_has(f))k.arbiters.inlined_add(f),j=!0;j&&f.present++}i=i.next}h=h.next}}e=e.next}}},freshInteractorType:function(a,b){null==b&&(b=a);if(null!=a.icompound){for(var c=a.icompound,
d=c.bodies.head;null!=d;)this.freshInteractorType(d.elt,b),d=d.next;for(c=c.compounds.head;null!=c;)this.freshInteractorType(c.elt,b),c=c.next}else{d=null!=a.ibody?a.ibody:a.ishape.body;c=null!=a.ishape?a.ishape:null;for(d=d.arbiters.head;null!=d;){var e=d.elt;if(e.presentable&&(null==c||e.ws1==c||e.ws2==c)){this.MRCA_chains(e.ws1,e.ws2);for(var f=this.mrca1.head;null!=f;){for(var h=f.elt,g=this.mrca2.head;null!=g;){var i=g.elt;if(!(h!=b&&i!=b)){var j=h.cbSet,k=i.cbSet;j.validate();k.validate();if(!j.manager.pair(j,
k).empty_intersection()){j=ha.get(h,i);null==j&&(j=Ga.get(h,i),this.add_callbackset(j));if(i=!j.arbiters.inlined_has(e))j.arbiters.inlined_add(e),i=!0;i&&e.present++}}g=g.next}f=f.next}}d=d.next}}},wakeCompound:function(a){for(var b=a.bodies.head;null!=b;){var c=b.elt;c.world||(c.component.waket=this.stamp+(this.midstep?0:1),c.type==i.id_BodyType_KINEMATIC&&(c.kinematicDelaySleep=!0),c.component.sleeping&&this.really_wake(c,!1));b=b.next}for(b=a.constraints.head;null!=b;)this.wake_constraint(b.elt),
b=b.next;for(a=a.compounds.head;null!=a;)this.wakeCompound(a.elt),a=a.next},wakeIsland:function(a){for(;null!=a.comps.head;){var b=a.comps.pop_unsafe();b.waket=this.stamp+(this.midstep?0:1);if(b.isBody){var c=b.body;this.live.add(c);for(var d=c.arbiters.head;null!=d;){var e=d.elt;e.sleeping&&(e.sleeping=!1,e.up_stamp+=this.stamp-e.sleep_stamp,e.type==D.COL?(e=e.colarb,e.stat?this.c_arbiters_true.inlined_add(e):this.c_arbiters_false.inlined_add(e)):e.type==D.FLUID?this.f_arbiters.inlined_add(e.fluidarb):
this.s_arbiters.inlined_add(e.sensorarb));d=d.next}this.bodyCbWake(c);b.sleeping=!1;b.island=null;b.parent=b;b.rank=0;if(c.type!=i.id_BodyType_STATIC)for(b=c.shapes.head;null!=b;)c=b.elt,null!=c.node&&this.bphase.sync(c),b=b.next}else c=b.constraint,this.live_constraints.inlined_add(c),this.constraintCbWake(c),b.sleeping=!1,b.island=null,b.parent=b,b.rank=0}a.next=nb.zpp_pool;nb.zpp_pool=a},non_inlined_wake:function(a,b){null==b&&(b=!1);a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==
i.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,b))},really_wake:function(a,b){null==b&&(b=!1);if(null==a.component.island){a.component.sleeping=!1;a.type==i.id_BodyType_KINEMATIC||a.type==i.id_BodyType_STATIC?this.staticsleep.inlined_add(a):this.live.inlined_add(a);for(var c=a.constraints.head;null!=c;){var d=c.elt;d.space==this&&this.wake_constraint(d);c=c.next}for(c=a.arbiters.head;null!=c;){d=c.elt;if(d.sleeping)if(d.sleeping=!1,d.up_stamp+=this.stamp+
(this.midstep?0:1)-d.sleep_stamp,d.type==D.COL){var e=d.colarb;e.stat?this.c_arbiters_true.inlined_add(e):this.c_arbiters_false.inlined_add(e)}else d.type==D.FLUID?this.f_arbiters.inlined_add(d.fluidarb):this.s_arbiters.inlined_add(d.sensorarb);d.type!=D.SENSOR&&!d.cleared&&d.up_stamp>=this.stamp&&0!=(d.immState&i.id_ImmState_ACCEPT)&&(d.b1.type==i.id_BodyType_DYNAMIC&&d.b1.component.sleeping&&(e=d.b1,e.world||(e.component.waket=this.stamp+(this.midstep?0:1),e.type==i.id_BodyType_KINEMATIC&&(e.kinematicDelaySleep=
!0),e.component.sleeping&&this.really_wake(e,!1))),d.b2.type==i.id_BodyType_DYNAMIC&&d.b2.component.sleeping&&(d=d.b2,d.world||(d.component.waket=this.stamp+(this.midstep?0:1),d.type==i.id_BodyType_KINEMATIC&&(d.kinematicDelaySleep=!0),d.component.sleeping&&this.really_wake(d,!1))));c=c.next}!b&&a.type==i.id_BodyType_DYNAMIC&&this.bodyCbWake(a);if(!b&&!this.bphase.is_sweep&&a.type!=i.id_BodyType_STATIC)for(c=a.shapes.head;null!=c;)d=c.elt,null!=d.node&&this.bphase.sync(d),c=c.next}else this.wakeIsland(a.component.island)},
wake_constraint:function(a,b){null==b&&(b=!1);return a.active&&(a.component.waket=this.stamp+(this.midstep?0:1),a.component.sleeping)?(null==a.component.island?(a.component.sleeping=!1,this.live_constraints.inlined_add(a),a.wake_connected(),b||this.constraintCbWake(a)):this.wakeIsland(a.component.island),!0):!1},doForests:function(a){for(var b=this.c_arbiters_false.head;null!=b;){var c=b.elt;if(!c.cleared&&c.up_stamp==this.stamp&&0!=(c.immState&i.id_ImmState_ACCEPT)&&c.b1.type==i.id_BodyType_DYNAMIC&&
c.b2.type==i.id_BodyType_DYNAMIC){var d;if(c.b1.component==c.b1.component.parent)d=c.b1.component;else{d=c.b1.component;for(var e=null;d!=d.parent;){var f=d.parent;d.parent=e;e=d;d=f}for(;null!=e;)f=e.parent,e.parent=d,e=f}if(c.b2.component==c.b2.component.parent)c=c.b2.component;else{c=c.b2.component;for(e=null;c!=c.parent;)f=c.parent,c.parent=e,e=c,c=f;for(;null!=e;)f=e.parent,e.parent=c,e=f}d!=c&&(d.rank<c.rank?d.parent=c:d.rank>c.rank?c.parent=d:(c.parent=d,d.rank++))}b=b.next}for(b=this.f_arbiters.head;null!=
b;){c=b.elt;if(!c.cleared&&c.up_stamp==this.stamp&&0!=(c.immState&i.id_ImmState_ACCEPT)&&c.b1.type==i.id_BodyType_DYNAMIC&&c.b2.type==i.id_BodyType_DYNAMIC){if(c.b1.component==c.b1.component.parent)d=c.b1.component;else{d=c.b1.component;for(e=null;d!=d.parent;)f=d.parent,d.parent=e,e=d,d=f;for(;null!=e;)f=e.parent,e.parent=d,e=f}if(c.b2.component==c.b2.component.parent)c=c.b2.component;else{c=c.b2.component;for(e=null;c!=c.parent;)f=c.parent,c.parent=e,e=c,c=f;for(;null!=e;)f=e.parent,e.parent=c,
e=f}d!=c&&(d.rank<c.rank?d.parent=c:d.rank>c.rank?c.parent=d:(c.parent=d,d.rank++))}b=b.next}for(b=this.live_constraints.head;null!=b;)b.elt.forest(),b=b.next;for(;null!=this.live.head;){d=this.live.inlined_pop_unsafe();b=d.component;if(b==b.parent)c=b;else{c=b;for(e=null;c!=c.parent;)f=c.parent,c.parent=e,e=c,c=f;for(;null!=e;)f=e.parent,e.parent=c,e=f}null==c.island&&(null==nb.zpp_pool?c.island=new nb:(c.island=nb.zpp_pool,nb.zpp_pool=c.island.next,c.island.next=null),c.island.waket=0,this.islands.inlined_add(c.island),
c.island.sleep=!0);b.island=c.island;b.island.comps.inlined_add(b);d=d.atRest(a);b.island.sleep=b.island.sleep&&d;b.waket>b.island.waket&&(b.island.waket=b.waket)}for(;null!=this.live_constraints.head;){a=this.live_constraints.inlined_pop_unsafe().component;if(a==a.parent)b=a;else{b=a;for(d=null;b!=b.parent;)c=b.parent,b.parent=d,d=b,b=c;for(;null!=d;)c=d.parent,d.parent=b,d=c}a.island=b.island;a.island.comps.inlined_add(a);a.waket>a.island.waket&&(a.island.waket=a.waket)}for(;null!=this.islands.next;)if(a=
this.islands.inlined_pop_unsafe(),a.sleep)for(a=a.comps.head;null!=a;){d=a.elt;if(d.isBody){b=d.body;b.velx=0;b.vely=0;b.angvel=0;d.sleeping=!0;for(d=b.shapes.head;null!=d;)this.bphase.sync(d.elt),d=d.next;this.bodyCbSleep(b)}else this.constraintCbSleep(d.constraint),d.sleeping=!0;a=a.next}else{for(;null!=a.comps.head;)b=a.comps.inlined_pop_unsafe(),b.waket=a.waket,b.isBody?this.live.inlined_add(b.body):this.live_constraints.inlined_add(b.constraint),b.sleeping=!1,b.island=null,b.parent=b,b.rank=
0;a.next=nb.zpp_pool;nb.zpp_pool=a}},sleepArbiters:function(){var a=null,b=this.c_arbiters_true,c=b.head,d=null!=this.c_arbiters_false;d&&null==c&&(d=!1,c=this.c_arbiters_false.head,b=this.c_arbiters_false,a=null);for(;null!=c;){var e=c.elt;e.b1.component.sleeping&&e.b2.component.sleeping?(e.sleep_stamp=this.stamp,e.sleeping=!0,c=b.inlined_erase(a)):(a=c,c=c.next);d&&null==c&&(d=!1,c=this.c_arbiters_false.head,b=this.c_arbiters_false,a=null)}a=null;b=this.f_arbiters;c=b.head;d=!1;for(;null!=c;)e=
c.elt,e.b1.component.sleeping&&e.b2.component.sleeping?(e.sleep_stamp=this.stamp,e.sleeping=!0,c=b.inlined_erase(a)):(a=c,c=c.next),d&&null==c&&(d=!1,a=b=null);a=null;b=this.s_arbiters;c=b.head;d=!1;for(;null!=c;)e=c.elt,e.b1.component.sleeping&&e.b2.component.sleeping?(e.sleep_stamp=this.stamp,e.sleeping=!0,c=b.inlined_erase(a)):(a=c,c=c.next),d&&null==c&&(d=!1,a=b=null)},static_validation:function(a){null!=a.shapes.head&&a.validate_aabb();a.validate_mass();a.validate_inertia();if(0!=a.velx||0!=
a.vely||0!=a.angvel)throw new j("Error: Static body cannot have any real velocity, only kinematic or surface velocities");for(var b=a.shapes.head;null!=b;){var c=b.elt;if(c.type==i.id_ShapeType_POLYGON){c.polygon.splice_collinear();var d=c.polygon.valid(),e=d;null==i.ValidationResult_VALID&&(i.internal=!0,i.ValidationResult_VALID=new pa,i.internal=!1);if(e!=i.ValidationResult_VALID)throw new j("Error: Cannot simulate with an invalid Polygon : "+c.polygon.outer.toString()+" is invalid : "+d.toString());
c.polygon.validate_gaxi()}b=b.next}a.sweepFrozen=!0},validation:function(){this.cbsets.validate();for(var a=this.live.head;null!=a;){var b=a.elt;b.sweepRadius=0;for(var c=b.shapes.head;null!=c;){var d=c.elt;if(d.type==i.id_ShapeType_POLYGON){d.polygon.splice_collinear();var e=d.polygon.valid(),f=e;null==i.ValidationResult_VALID&&(i.internal=!0,i.ValidationResult_VALID=new pa,i.internal=!1);if(f!=i.ValidationResult_VALID)throw new j("Error: Cannot simulate with an invalid Polygon : "+d.polygon.outer.toString()+
" is invalid : "+e.toString());d.polygon.validate_gaxi()}d.validate_sweepRadius();d.sweepRadius>b.sweepRadius&&(b.sweepRadius=d.sweepRadius);c=c.next}b.validate_mass();b.validate_inertia();null!=b.shapes.head&&(b.validate_aabb(),b.validate_worldCOM());b.validate_gravMass();b.zip_axis&&(b.zip_axis=!1,b.axisx=Math.sin(b.rot),b.axisy=Math.cos(b.rot),null);if(!b.nomove&&b.type==i.id_BodyType_DYNAMIC&&0==b.mass)throw new j("Error: Dynamic Body cannot be simulated with 0 mass unless allowMovement is false");
if(!b.norotate&&b.type==i.id_BodyType_DYNAMIC&&0==b.inertia)throw new j("Error: Dynamic Body cannot be simulated with 0 inertia unless allowRotation is false");if(b.component.woken&&null!=b.cbSet)for(c=b.cbSet.bodylisteners.head;null!=c;)d=c.elt,d.event==i.id_CbEvent_WAKE&&(d=this.push_callback(d),d.event=i.id_CbEvent_WAKE,d.body=b),c=c.next;b.component.woken=!1;for(b=b.shapes.head;null!=b;)this.bphase.sync(b.elt),b=b.next;a=a.next}for(a=this.kinematics.head;null!=a;){b=a.elt;b.sweepRadius=0;for(c=
b.shapes.head;null!=c;){d=c.elt;if(d.type==i.id_ShapeType_POLYGON){d.polygon.splice_collinear();f=e=d.polygon.valid();null==i.ValidationResult_VALID&&(i.internal=!0,i.ValidationResult_VALID=new pa,i.internal=!1);if(f!=i.ValidationResult_VALID)throw new j("Error: Cannot simulate with an invalid Polygon : "+d.polygon.outer.toString()+" is invalid : "+e.toString());d.polygon.validate_gaxi()}d.validate_sweepRadius();d.sweepRadius>b.sweepRadius&&(b.sweepRadius=d.sweepRadius);c=c.next}b.validate_mass();
b.validate_inertia();null!=b.shapes.head&&(b.validate_aabb(),b.validate_worldCOM());b.validate_gravMass();b.zip_axis&&(b.zip_axis=!1,b.axisx=Math.sin(b.rot),b.axisy=Math.cos(b.rot),null);if(!b.nomove&&b.type==i.id_BodyType_DYNAMIC&&0==b.mass)throw new j("Error: Dynamic Body cannot be simulated with 0 mass unless allowMovement is false");if(!b.norotate&&b.type==i.id_BodyType_DYNAMIC&&0==b.inertia)throw new j("Error: Dynamic Body cannot be simulated with 0 inertia unless allowRotation is false");for(b=
b.shapes.head;null!=b;)this.bphase.sync(b.elt),b=b.next;a=a.next}for(a=this.live_constraints.head;null!=a;){b=a.elt;if(b.active){b.validate();if(b.component.woken&&null!=b.cbSet)for(c=b.cbSet.conlisteners.head;null!=c;)d=c.elt,d.event==i.id_CbEvent_WAKE&&(d=this.push_callback(d),d.event=i.id_CbEvent_WAKE,d.constraint=b),c=c.next;b.component.woken=!1}a=a.next}},updateVel:function(a){for(var b=1-a*this.global_lin_drag,c=1-a*this.global_ang_drag,d=this.live.head;null!=d;){var e=d.elt;if(0!=e.smass){var f=
a*e.imass;e.velx=b*e.velx+(e.forcex+this.gravityx*e.gravMass)*f;e.vely=b*e.vely+(e.forcey+this.gravityy*e.gravMass)*f}if(0!=e.sinertia){var h=f=0,f=e.worldCOMx-e.posx,h=e.worldCOMy-e.posy;e.angvel=c*e.angvel+(e.torque+(this.gravityy*f-this.gravityx*h)*e.gravMass)*a*e.iinertia}d=d.next}},updatePos:function(a){for(var b=2*Math.PI/a,c=this.live.head;null!=c;){var d=c.elt;d.pre_posx=d.posx;d.pre_posy=d.posy;d.pre_rot=d.rot;d.sweepTime=0;d.sweep_angvel=d.angvel%b;d.sweepIntegrate(a);if(d.disableCCD)d.sweepFrozen=
!0,d.bullet=!1;else{var e=k.staticCCDLinearThreshold*d.sweepRadius,f=k.staticCCDAngularThreshold;if((d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>f*f||d.type==i.id_BodyType_KINEMATIC){e=d.sweep_angvel;0>e&&(e=-e);for(var f=1/e,h=d.shapes.head;null!=h;){var g=h.elt,j=g.aabb,n=j.minx,o=j.miny,s=j.maxx,q=j.maxy,r=0.008333333333333333*e*a*g.sweepCoef|0;8<r&&(r=8);var u=e*a/r;d.sweepIntegrate(a);g.type==i.id_ShapeType_CIRCLE?g.circle._force_validate_aabb():g.polygon._force_validate_aabb();
n<j.minx?j.minx=n:n=j.minx;o<j.miny?j.miny=o:o=j.miny;s>j.maxx?j.maxx=s:s=j.maxx;q>j.maxy?j.maxy=q:q=j.maxy;for(var w=1;w<r;){var y=w++;d.sweepIntegrate(u*y*f);g.type==i.id_ShapeType_CIRCLE?g.circle._force_validate_aabb():g.polygon._force_validate_aabb();n<j.minx?j.minx=n:n=j.minx;o<j.miny?j.miny=o:o=j.miny;s>j.maxx?j.maxx=s:s=j.maxx;q>j.maxy?j.maxy=q:q=j.maxy}this.bphase.sync(g);h=h.next}d.sweepFrozen=!1;if(d.type==i.id_BodyType_DYNAMIC&&d.bulletEnabled&&(e=k.bulletCCDLinearThreshold*d.sweepRadius,
f=k.bulletCCDAngularThreshold,(d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>f*f))d.bullet=!0}else d.sweepFrozen=!0,d.bullet=!1}c=c.next}for(c=this.kinematics.head;null!=c;){d=c.elt;d.pre_posx=d.posx;d.pre_posy=d.posy;d.pre_rot=d.rot;d.sweepTime=0;d.sweep_angvel=d.angvel%b;d.sweepIntegrate(a);if(d.disableCCD)d.sweepFrozen=!0,d.bullet=!1;else if(e=k.staticCCDLinearThreshold*d.sweepRadius,f=k.staticCCDAngularThreshold,(d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>f*f||d.type==
i.id_BodyType_KINEMATIC){e=d.sweep_angvel;0>e&&(e=-e);f=1/e;for(h=d.shapes.head;null!=h;){g=h.elt;j=g.aabb;n=j.minx;o=j.miny;s=j.maxx;q=j.maxy;r=0.008333333333333333*e*a*g.sweepCoef|0;8<r&&(r=8);u=e*a/r;d.sweepIntegrate(a);g.type==i.id_ShapeType_CIRCLE?g.circle._force_validate_aabb():g.polygon._force_validate_aabb();n<j.minx?j.minx=n:n=j.minx;o<j.miny?j.miny=o:o=j.miny;s>j.maxx?j.maxx=s:s=j.maxx;q>j.maxy?j.maxy=q:q=j.maxy;for(w=1;w<r;)y=w++,d.sweepIntegrate(u*y*f),g.type==i.id_ShapeType_CIRCLE?g.circle._force_validate_aabb():
g.polygon._force_validate_aabb(),n<j.minx?j.minx=n:n=j.minx,o<j.miny?j.miny=o:o=j.miny,s>j.maxx?j.maxx=s:s=j.maxx,q>j.maxy?j.maxy=q:q=j.maxy;this.bphase.sync(g);h=h.next}d.sweepFrozen=!1;if(d.type==i.id_BodyType_DYNAMIC&&d.bulletEnabled&&(e=k.bulletCCDLinearThreshold*d.sweepRadius,f=k.bulletCCDAngularThreshold,(d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>f*f))d.bullet=!0}else d.sweepFrozen=!0,d.bullet=!1;c=c.next}},presteparb:function(a,b,c){null==c&&(c=!1);var d=this;if(!a.cleared&&
a.b1.component.sleeping&&a.b2.component.sleeping)return a.sleep_stamp=this.stamp,a.sleeping=!0;if(!a.cleared||0!=a.present||a.intchange){var e=!c&&a.up_stamp==this.stamp-1&&!a.cleared&&!a.intchange,c=a.fresh&&!a.cleared&&!a.intchange;e&&(a.endGenerated=this.stamp);if(c||e||a.cleared||a.intchange){this.inlined_MRCA_chains(a.ws1,a.ws2);for(e=this.mrca1.head;null!=e;){for(var f=e.elt,g=this.mrca2.head;null!=g;){var j=g.elt,l=f.cbSet,n=j.cbSet;if(!l.manager.pair(l,n).empty_intersection()){var o=[ha.get(f,
j)];if(c||a.intchange){null==o[0]&&(o[0]=Ga.get(f,j),this.add_callbackset(o[0]));l.manager.pair(l,n).forall(i.id_CbEvent_BEGIN,function(b){return function(c){if(0!=(c.itype&a.type)&&b[0].empty_arb(c.itype)){var e=d.push_callback(c);e.event=i.id_CbEvent_BEGIN;ha.int_callback(b[0],c,e);e.set=b[0]}}}(o));if(j=!o[0].arbiters.inlined_has(a))o[0].arbiters.inlined_add(a),j=!0;j&&a.present++}else a.present--,o[0].remove_arb(a),l.manager.pair(l,n).forall(i.id_CbEvent_END,function(b){return function(c){if(0!=
(c.itype&a.type)&&b[0].empty_arb(c.itype)){var e=d.push_callback(c);e.event=i.id_CbEvent_END;ha.int_callback(b[0],c,e);e.set=b[0]}}}(o)),null==o[0].arbiters.head&&this.remove_callbackset(o[0])}g=g.next}e=e.next}}a.fresh=!1;a.intchange=!1}if(a.cleared||a.up_stamp+(a.type==D.COL?k.arbiterExpirationDelay:0)<this.stamp)return a.type==D.SENSOR?a.sensorarb.retire():a.type==D.FLUID?a.fluidarb.retire():a.colarb.retire(),!0;c=a.active;a.active=a.presentable=a.up_stamp==this.stamp;0!=(a.immState&i.id_ImmState_ACCEPT)?
a.active&&a.type!=D.SENSOR&&(null!=a.colarb?a.colarb.preStep(b)&&(a.active=!1):a.fluidarb.preStep(this,b)):null!=a.colarb&&a.colarb.cleanupContacts()&&(a.active=!1);c!=a.active&&(a.b1.arbiters.modified=!0,a.b2.arbiters.modified=!0,this.c_arbiters_true.modified=this.c_arbiters_false.modified=!0,this.s_arbiters.modified=this.f_arbiters.modified=!0);return!1},prestep:function(a){for(var b=null,c=this.live_constraints.head;null!=c;){var d=c.elt;d.preStep(a)?(c=this.live_constraints.erase(b),d.broken(),
this.constraintCbBreak(d),d.removeOnBreak?(d.component.sleeping=!0,this.midstep=!1,null!=d.compound?d.compound.wrap_constraints.remove(d.outer):this.wrap_constraints.remove(d.outer),this.midstep=!0):d.active=!1,d.clearcache()):(b=c,c=c.next)}var b=null,c=this.c_arbiters_true,d=c.head,e=null!=this.c_arbiters_false;e&&null==d&&(e=!1,d=this.c_arbiters_false.head,c=this.c_arbiters_false,b=null);for(;null!=d;)this.presteparb(d.elt,a)?d=c.inlined_erase(b):(b=d,d=d.next),e&&null==d&&(e=!1,d=this.c_arbiters_false.head,
c=this.c_arbiters_false,b=null);b=null;c=this.f_arbiters;d=c.head;e=!1;for(;null!=d;)this.presteparb(d.elt,a)?d=c.inlined_erase(b):(b=d,d=d.next),e&&null==d&&(e=!1,b=c=null);b=null;c=this.s_arbiters;d=c.head;e=!1;for(;null!=d;)this.presteparb(d.elt,a)?d=c.inlined_erase(b):(b=d,d=d.next),e&&null==d&&(e=!1,b=c=null)},warmStart:function(){for(var a=this.f_arbiters.head;null!=a;){var b=a.elt;b.active&&0!=(b.immState&i.id_ImmState_ACCEPT)&&b.warmStart();a=a.next}a=this.c_arbiters_false.head;b=!0;null==
a&&(a=this.c_arbiters_true.head,b=!1);for(;null!=a;){var c=a.elt;c.active&&0!=(c.immState&i.id_ImmState_ACCEPT)&&c.warmStart();a=a.next;b&&null==a&&(a=this.c_arbiters_true.head,b=!1)}for(a=this.live_constraints.head;null!=a;)a.elt.warmStart(),a=a.next},iterateVel:function(a){for(var b=0;b<a;){b++;for(var c=this.f_arbiters.head;null!=c;){var d=c.elt;d.active&&0!=(d.immState&i.id_ImmState_ACCEPT)&&d.applyImpulseVel();c=c.next}c=null;for(d=this.live_constraints.head;null!=d;){var e=d.elt;e.applyImpulseVel()?
(d=this.live_constraints.erase(c),e.broken(),this.constraintCbBreak(e),e.removeOnBreak?(e.component.sleeping=!0,this.midstep=!1,null!=e.compound?e.compound.wrap_constraints.remove(e.outer):this.wrap_constraints.remove(e.outer),this.midstep=!0):e.active=!1,e.clearcache()):(c=d,d=d.next)}c=this.c_arbiters_false.head;d=!0;null==c&&(c=this.c_arbiters_true.head,d=!1);for(;null!=c;)e=c.elt,e.active&&0!=(e.immState&i.id_ImmState_ACCEPT)&&e.applyImpulseVel(),c=c.next,d&&null==c&&(c=this.c_arbiters_true.head,
d=!1)}},iteratePos:function(a){for(var b=0;b<a;){b++;for(var c=null,d=this.live_constraints.head;null!=d;){var e=d.elt;!e.__velocity&&e.stiff&&e.applyImpulsePos()?(d=this.live_constraints.erase(c),e.broken(),this.constraintCbBreak(e),e.removeOnBreak?(e.component.sleeping=!0,this.midstep=!1,null!=e.compound?e.compound.wrap_constraints.remove(e.outer):this.wrap_constraints.remove(e.outer),this.midstep=!0):e.active=!1,e.clearcache()):(c=d,d=d.next)}c=this.c_arbiters_false.head;d=!0;null==c&&(c=this.c_arbiters_true.head,
d=!1);for(;null!=c;)e=c.elt,e.active&&0!=(e.immState&i.id_ImmState_ACCEPT)&&e.applyImpulsePos(),c=c.next,d&&null==c&&(c=this.c_arbiters_true.head,d=!1)}},group_ignore:function(a,b){var c=a.lookup_group();if(null==c)return!1;var d=b.lookup_group();if(null==d)return!1;for(var e=!1;null!=c&&null!=d;){if(c==d){e=c.ignore;break}c.depth<d.depth?d=d.group:c=c.group}return e},interactionType:function(a,b,c,d){var e;e=!1;for(var f=c.constraints.head;null!=f;){var g=f.elt;if(g.ignore&&g.pair_exists(c.id,d.id)){e=
!0;break}f=f.next}return!e&&!this.group_ignore(a,b)?(a.sensorEnabled||b.sensorEnabled)&&a.filter.shouldSense(b.filter)?2:(a.fluidEnabled||b.fluidEnabled)&&a.filter.shouldFlow(b.filter)&&!(0==c.imass&&0==d.imass&&0==c.iinertia&&0==d.iinertia)?0:a.filter.shouldCollide(b.filter)&&!(0==c.imass&&0==d.imass&&0==c.iinertia&&0==d.iinertia)?1:-1:-1},narrowPhase:function(a,b,c,d,e){var f=this,g=null,j=a.body,l=b.body,k=this.interactionType(a,b,j,l);if(-1!=k){var n,o;a.type>b.type?(n=b,o=a):a.type==b.type?a.id<
b.id?(n=a,o=b):(o=a,n=b):(n=a,o=b);var q=n==b;if(0==k){var r;if(null==d){for(var u=null,w=(j.arbiters.length<l.arbiters.length?j:l).arbiters.head;null!=w;){var y=w.elt;if(y.id==n.id&&y.di==o.id){u=y;break}w=w.next}r=u}else r=d;var z=null==r,t,B=!1;z?(null==hb.zpp_pool?t=new hb:(t=hb.zpp_pool,hb.zpp_pool=t.next,t.next=null),null):null==r.fluidarb?(r.cleared=!0,r.b1.arbiters.inlined_try_remove(r),r.b2.arbiters.inlined_try_remove(r),null!=r.pair&&(r.pair.arb=null,r.pair=null),r.active=!1,this.f_arbiters.modified=
!0,null==hb.zpp_pool?t=new hb:(t=hb.zpp_pool,hb.zpp_pool=t.next,t.next=null),null,B=z=t.intchange=!0):t=r.fluidarb;var F=i.id_InteractionType_FLUID;if(z||t.stamp!=this.stamp||e)if(t.stamp=this.stamp,s.flowCollide(n,o,t)){z?(t.b1=a.body,t.ws1=a,t.b2=b.body,t.ws2=b,t.id=n.id,t.di=o.id,t.b1.arbiters.inlined_add(t),t.b2.arbiters.inlined_add(t),t.active=!0,t.present=0,t.cleared=!1,t.sleeping=!1,t.fresh=!1,t.presentable=!1,t.nx=0,t.ny=1,t.dampx=0,t.dampy=0,t.adamp=0,this.f_arbiters.inlined_add(t),t.fresh=
!B):t.fresh=t.up_stamp<this.stamp-1||t.endGenerated==this.stamp&&e;t.up_stamp=t.stamp;if(t.fresh||0==(t.immState&i.id_ImmState_ALWAYS)){t.immState=i.id_ImmState_ACCEPT;var E=!1;this.inlined_MRCA_chains(t.ws1.id>t.ws2.id?t.ws2:t.ws1,t.ws1.id>t.ws2.id?t.ws1:t.ws2);for(var C=this.mrca1.head;null!=C;){for(var D=C.elt,G=this.mrca2.head;null!=G;){var H=G.elt,I=D.cbSet,K=H.cbSet;if(!I.manager.pair(I,K).empty_intersection()){var O=null,J=null;this.prelisteners.inlined_clear();I.manager.pair(I,K).forall(i.id_CbEvent_PRE,
function(a){return function(b){0!=(b.itype&F)&&(a[0]=f.prelisteners.inlined_insert(a[0],b),E=E||!b.pure)}}([null]));if(null!=this.prelisteners.head)if(O=ha.get(D,H),null==O&&(J=Ga.get(D,H),this.add_callbackset(J)),null==O||(O.FLUIDstamp!=this.stamp||e)&&0==(O.FLUIDstate&i.id_ImmState_ALWAYS)){null!=J&&(O=J);if(null!=O)for(var M=this.prelisteners.head;null!=M;)M.elt.itype==i.id_InteractionType_ANY&&(O.COLLISIONstamp=this.stamp,O.SENSORstamp=this.stamp),O.FLUIDstamp=this.stamp,M=M.next;t.mutable=!0;
null!=t.wrap_position&&(t.wrap_position.zpp_inner._immutable=!1);var R=t.active;t.active=!0;this.precb.zpp_inner.pre_arbiter=t;this.precb.zpp_inner.set=O;for(var N=this.prelisteners.head;null!=N;){var Q=N.elt;this.precb.zpp_inner.listener=Q;ha.int_callback(O,Q,this.precb.zpp_inner);this.precb.zpp_inner.pre_swapped=D!=this.precb.zpp_inner.int1;var S=Q.handlerp(this.precb);if(null!=S){var aa=t,ba=S,W;null==i.PreFlag_ACCEPT&&(i.internal=!0,i.PreFlag_ACCEPT=new Ja,i.internal=!1);if(ba==i.PreFlag_ACCEPT)W=
i.id_ImmState_ACCEPT|i.id_ImmState_ALWAYS;else{var ca=S,$;null==i.PreFlag_ACCEPT_ONCE&&(i.internal=!0,i.PreFlag_ACCEPT_ONCE=new Ja,i.internal=!1);if(ca==i.PreFlag_ACCEPT_ONCE)$=i.id_ImmState_ACCEPT;else{var ea=S;null==i.PreFlag_IGNORE&&(i.internal=!0,i.PreFlag_IGNORE=new Ja,i.internal=!1);$=ea==i.PreFlag_IGNORE?i.id_ImmState_IGNORE|i.id_ImmState_ALWAYS:i.id_ImmState_IGNORE}W=$}aa.immState=W}N=N.next}t.mutable=!1;null!=t.wrap_position&&(t.wrap_position.zpp_inner._immutable=!0);t.active=R;if(null!=
O)for(var X=this.prelisteners.head;null!=X;)X.elt.itype==i.id_InteractionType_ANY&&(O.COLLISIONstate=t.immState,O.SENSORstate=t.immState),O.FLUIDstate=t.immState,X=X.next}else null==O?0==(t.immState&i.id_ImmState_ALWAYS)&&(t.immState=i.id_ImmState_ACCEPT):t.immState=O.FLUIDstate}G=G.next}C=C.next}if(E&&0==(t.immState&i.id_ImmState_ALWAYS)){if(t.b1.type==i.id_BodyType_DYNAMIC){var T=t.b1;T.world||(T.component.waket=this.stamp+(this.midstep?0:1),T.type==i.id_BodyType_KINEMATIC&&(T.kinematicDelaySleep=
!0),T.component.sleeping&&this.really_wake(T,!1))}if(t.b1.type==i.id_BodyType_DYNAMIC){var U=t.b2;U.world||(U.component.waket=this.stamp+(this.midstep?0:1),U.type==i.id_BodyType_KINEMATIC&&(U.kinematicDelaySleep=!0),U.component.sleeping&&this.really_wake(U,!1))}}}if(0!=(t.immState&i.id_ImmState_ACCEPT)){if(t.b1.type==i.id_BodyType_DYNAMIC&&t.b1.component.sleeping){var Y=t.b1;Y.world||(Y.component.waket=this.stamp+(this.midstep?0:1),Y.type==i.id_BodyType_KINEMATIC&&(Y.kinematicDelaySleep=!0),Y.component.sleeping&&
this.really_wake(Y,!1))}if(t.b2.type==i.id_BodyType_DYNAMIC&&t.b2.component.sleeping){var Z=t.b2;Z.world||(Z.component.waket=this.stamp+(this.midstep?0:1),Z.type==i.id_BodyType_KINEMATIC&&(Z.kinematicDelaySleep=!0),Z.component.sleeping&&this.really_wake(Z,!1))}}t.sleeping&&(t.sleeping=!1,this.f_arbiters.inlined_add(t));g=t}else if(z){var ka=t;ka.next=hb.zpp_pool;hb.zpp_pool=ka;g=null}else g=t;else g=t}else if(1==k){var ga;ga=c?this.c_arbiters_true:this.c_arbiters_false;var L;if(null==d){for(var ma=
null,ia=(j.arbiters.length<l.arbiters.length?j:l).arbiters.head;null!=ia;){var ja=ia.elt;if(ja.id==n.id&&ja.di==o.id){ma=ja;break}ia=ia.next}L=ma}else L=d;var fa=null==L,p,ra=!1;fa?(null==kb.zpp_pool?p=new kb:(p=kb.zpp_pool,kb.zpp_pool=p.next,p.next=null),null,p.stat=c):null==L.colarb?(L.cleared=!0,L.b1.arbiters.inlined_try_remove(L),L.b2.arbiters.inlined_try_remove(L),null!=L.pair&&(L.pair.arb=null,L.pair=null),L.active=!1,this.f_arbiters.modified=!0,null==kb.zpp_pool?p=new kb:(p=kb.zpp_pool,kb.zpp_pool=
p.next,p.next=null),null,p.intchange=!0,p.stat=c,ra=fa=!0):(p=L.colarb,q=n!=p.s1,p.stat!=c&&(p.stat=c,p.sleeping||((c?this.c_arbiters_false:this.c_arbiters_true).remove(p),ga.add(p))));var Ba=i.id_InteractionType_COLLISION;if(fa||p.stamp!=this.stamp||e)if(p.stamp=this.stamp,s.contactCollide(n,o,p,q)){fa?(p.b1=a.body,p.ws1=a,p.b2=b.body,p.ws2=b,p.id=n.id,p.di=o.id,p.b1.arbiters.inlined_add(p),p.b2.arbiters.inlined_add(p),p.active=!0,p.present=0,p.cleared=!1,p.sleeping=!1,p.fresh=!1,p.presentable=!1,
p.s1=a,p.s2=b,p.userdef_restitution||(p.restitution=-Infinity>=p.s1.material.elasticity||-Infinity>=p.s2.material.elasticity?0:Infinity<=p.s1.material.elasticity||Infinity<=p.s2.material.elasticity?1:(p.s1.material.elasticity+p.s2.material.elasticity)/2,0>p.restitution&&(p.restitution=0),1<p.restitution&&(p.restitution=1)),p.userdef_dyn_fric||(p.dyn_fric=Math.sqrt(p.s1.material.dynamicFriction*p.s2.material.dynamicFriction)),p.userdef_stat_fric||(p.stat_fric=Math.sqrt(p.s1.material.staticFriction*
p.s2.material.staticFriction)),p.userdef_rfric||(p.rfric=Math.sqrt(p.s1.material.rollingFriction*p.s2.material.rollingFriction)),ga.inlined_add(p),p.fresh=!ra):p.fresh=p.up_stamp<this.stamp-1||p.endGenerated==this.stamp&&e;p.up_stamp=p.stamp;if(p.fresh||0==(p.immState&i.id_ImmState_ALWAYS)){p.immState=i.id_ImmState_ACCEPT;var ta=!1;this.inlined_MRCA_chains(p.ws1.id>p.ws2.id?p.ws2:p.ws1,p.ws1.id>p.ws2.id?p.ws1:p.ws2);for(var na=this.mrca1.head;null!=na;){for(var da=na.elt,oa=this.mrca2.head;null!=
oa;){var za=oa.elt,pa=da.cbSet,Ea=za.cbSet;if(!pa.manager.pair(pa,Ea).empty_intersection()){var Pa=null,qa=null;this.prelisteners.inlined_clear();pa.manager.pair(pa,Ea).forall(i.id_CbEvent_PRE,function(a){return function(b){0!=(b.itype&Ba)&&(a[0]=f.prelisteners.inlined_insert(a[0],b),ta=ta||!b.pure)}}([null]));if(null!=this.prelisteners.head)if(Pa=ha.get(da,za),null==Pa&&(qa=Ga.get(da,za),this.add_callbackset(qa)),null==Pa||(Pa.COLLISIONstamp!=this.stamp||e)&&0==(Pa.COLLISIONstate&i.id_ImmState_ALWAYS)){null!=
qa&&(Pa=qa);if(null!=Pa)for(var sa=this.prelisteners.head;null!=sa;)sa.elt.itype==i.id_InteractionType_ANY?(Pa.COLLISIONstamp=this.stamp,Pa.SENSORstamp=this.stamp,Pa.FLUIDstamp=this.stamp):Pa.COLLISIONstamp=this.stamp,sa=sa.next;p.mutable=!0;null!=p.wrap_normal&&(p.wrap_normal.zpp_inner._immutable=!1);null!=p.wrap_contacts&&(p.wrap_contacts.zpp_inner.immutable=!1);var Ma=p.active;p.active=!0;p.cleanupContacts();this.precb.zpp_inner.pre_arbiter=p;this.precb.zpp_inner.set=Pa;for(var ua=this.prelisteners.head;null!=
ua;){var Da=ua.elt;this.precb.zpp_inner.listener=Da;ha.int_callback(Pa,Da,this.precb.zpp_inner);this.precb.zpp_inner.pre_swapped=da!=this.precb.zpp_inner.int1;var Ca=Da.handlerp(this.precb);if(null!=Ca){var Sa=p,Va=Ca,Ka;null==i.PreFlag_ACCEPT&&(i.internal=!0,i.PreFlag_ACCEPT=new Ja,i.internal=!1);if(Va==i.PreFlag_ACCEPT)Ka=i.id_ImmState_ACCEPT|i.id_ImmState_ALWAYS;else{var Za=Ca,La;null==i.PreFlag_ACCEPT_ONCE&&(i.internal=!0,i.PreFlag_ACCEPT_ONCE=new Ja,i.internal=!1);if(Za==i.PreFlag_ACCEPT_ONCE)La=
i.id_ImmState_ACCEPT;else{var ab=Ca;null==i.PreFlag_IGNORE&&(i.internal=!0,i.PreFlag_IGNORE=new Ja,i.internal=!1);La=ab==i.PreFlag_IGNORE?i.id_ImmState_IGNORE|i.id_ImmState_ALWAYS:i.id_ImmState_IGNORE}Ka=La}Sa.immState=Ka}ua=ua.next}p.mutable=!1;null!=p.wrap_normal&&(p.wrap_normal.zpp_inner._immutable=!0);null!=p.wrap_contacts&&(p.wrap_contacts.zpp_inner.immutable=!0);p.active=Ma;if(null!=Pa)for(var Ia=this.prelisteners.head;null!=Ia;)Ia.elt.itype==i.id_InteractionType_ANY?(Pa.COLLISIONstate=p.immState,
Pa.SENSORstate=p.immState,Pa.FLUIDstate=p.immState):Pa.COLLISIONstate=p.immState,Ia=Ia.next}else null==Pa?0==(p.immState&i.id_ImmState_ALWAYS)&&(p.immState=i.id_ImmState_ACCEPT):p.immState=Pa.COLLISIONstate}oa=oa.next}na=na.next}if(ta&&0==(p.immState&i.id_ImmState_ALWAYS)){if(p.b1.type==i.id_BodyType_DYNAMIC){var va=p.b1;va.world||(va.component.waket=this.stamp+(this.midstep?0:1),va.type==i.id_BodyType_KINEMATIC&&(va.kinematicDelaySleep=!0),va.component.sleeping&&this.really_wake(va,!1))}if(p.b1.type==
i.id_BodyType_DYNAMIC){var wa=p.b2;wa.world||(wa.component.waket=this.stamp+(this.midstep?0:1),wa.type==i.id_BodyType_KINEMATIC&&(wa.kinematicDelaySleep=!0),wa.component.sleeping&&this.really_wake(wa,!1))}}}if(0!=(p.immState&i.id_ImmState_ACCEPT)){if(p.b1.type==i.id_BodyType_DYNAMIC&&p.b1.component.sleeping){var xa=p.b1;xa.world||(xa.component.waket=this.stamp+(this.midstep?0:1),xa.type==i.id_BodyType_KINEMATIC&&(xa.kinematicDelaySleep=!0),xa.component.sleeping&&this.really_wake(xa,!1))}if(p.b2.type==
i.id_BodyType_DYNAMIC&&p.b2.component.sleeping){var ya=p.b2;ya.world||(ya.component.waket=this.stamp+(this.midstep?0:1),ya.type==i.id_BodyType_KINEMATIC&&(ya.kinematicDelaySleep=!0),ya.component.sleeping&&this.really_wake(ya,!1))}}p.sleeping&&(p.sleeping=!1,ga.inlined_add(p));g=p}else if(fa){var la=p;la.userdef_dyn_fric=!1;la.userdef_stat_fric=!1;la.userdef_restitution=!1;la.userdef_rfric=!1;la.__ref_edge1=la.__ref_edge2=null;la.next=kb.zpp_pool;kb.zpp_pool=la;g=null}else g=p;else g=p}else{var V;
if(null==d){for(var $a=null,Na=(j.arbiters.length<l.arbiters.length?j:l).arbiters.head;null!=Na;){var Ra=Na.elt;if(Ra.id==n.id&&Ra.di==o.id){$a=Ra;break}Na=Na.next}V=$a}else V=d;var Ha=null==V,x,bb=!1;Ha?(null==Ya.zpp_pool?x=new Ya:(x=Ya.zpp_pool,Ya.zpp_pool=x.next,x.next=null),null):null==V.sensorarb?(V.cleared=!0,V.b1.arbiters.inlined_try_remove(V),V.b2.arbiters.inlined_try_remove(V),null!=V.pair&&(V.pair.arb=null,V.pair=null),V.active=!1,this.f_arbiters.modified=!0,null==Ya.zpp_pool?x=new Ya:(x=
Ya.zpp_pool,Ya.zpp_pool=x.next,x.next=null),null,bb=Ha=x.intchange=!0):x=V.sensorarb;var gb=i.id_InteractionType_SENSOR;if(Ha||x.stamp!=this.stamp||e)if(x.stamp=this.stamp,s.testCollide(n,o)){Ha?(x.b1=a.body,x.ws1=a,x.b2=b.body,x.ws2=b,x.id=n.id,x.di=o.id,x.b1.arbiters.inlined_add(x),x.b2.arbiters.inlined_add(x),x.active=!0,x.present=0,x.cleared=!1,x.sleeping=!1,x.fresh=!1,x.presentable=!1,this.s_arbiters.inlined_add(x),x.fresh=!bb):x.fresh=x.up_stamp<this.stamp-1||x.endGenerated==this.stamp&&e;x.up_stamp=
x.stamp;if(x.fresh||0==(x.immState&i.id_ImmState_ALWAYS)){x.immState=i.id_ImmState_ACCEPT;var Ua=!1;this.inlined_MRCA_chains(x.ws1.id>x.ws2.id?x.ws2:x.ws1,x.ws1.id>x.ws2.id?x.ws1:x.ws2);for(var Qa=this.mrca1.head;null!=Qa;){for(var Ta=Qa.elt,Wa=this.mrca2.head;null!=Wa;){var mb=Wa.elt,Xa=Ta.cbSet,ib=mb.cbSet;if(!Xa.manager.pair(Xa,ib).empty_intersection()){var Fa=null,cb=null;this.prelisteners.inlined_clear();Xa.manager.pair(Xa,ib).forall(i.id_CbEvent_PRE,function(a){return function(b){0!=(b.itype&
gb)&&(a[0]=f.prelisteners.inlined_insert(a[0],b),Ua=Ua||!b.pure)}}([null]));if(null!=this.prelisteners.head)if(Fa=ha.get(Ta,mb),null==Fa&&(cb=Ga.get(Ta,mb),this.add_callbackset(cb)),null==Fa||(Fa.SENSORstamp!=this.stamp||e)&&0==(Fa.SENSORstate&i.id_ImmState_ALWAYS)){null!=cb&&(Fa=cb);if(null!=Fa)for(var db=this.prelisteners.head;null!=db;)db.elt.itype==i.id_InteractionType_ANY?(Fa.COLLISIONstamp=this.stamp,Fa.SENSORstamp=this.stamp,Fa.FLUIDstamp=this.stamp):Fa.SENSORstamp=this.stamp,db=db.next;var nb=
x.active;x.active=!0;this.precb.zpp_inner.pre_arbiter=x;this.precb.zpp_inner.set=Fa;for(var fb=this.prelisteners.head;null!=fb;){var qb=fb.elt;this.precb.zpp_inner.listener=qb;ha.int_callback(Fa,qb,this.precb.zpp_inner);this.precb.zpp_inner.pre_swapped=Ta!=this.precb.zpp_inner.int1;var ob=qb.handlerp(this.precb);if(null!=ob){var Bb=x,Cb=ob,wb;null==i.PreFlag_ACCEPT&&(i.internal=!0,i.PreFlag_ACCEPT=new Ja,i.internal=!1);if(Cb==i.PreFlag_ACCEPT)wb=i.id_ImmState_ACCEPT|i.id_ImmState_ALWAYS;else{var Db=
ob,rb;null==i.PreFlag_ACCEPT_ONCE&&(i.internal=!0,i.PreFlag_ACCEPT_ONCE=new Ja,i.internal=!1);if(Db==i.PreFlag_ACCEPT_ONCE)rb=i.id_ImmState_ACCEPT;else{var ub=ob;null==i.PreFlag_IGNORE&&(i.internal=!0,i.PreFlag_IGNORE=new Ja,i.internal=!1);rb=ub==i.PreFlag_IGNORE?i.id_ImmState_IGNORE|i.id_ImmState_ALWAYS:i.id_ImmState_IGNORE}wb=rb}Bb.immState=wb}fb=fb.next}x.active=nb;if(null!=Fa)for(var pb=this.prelisteners.head;null!=pb;)pb.elt.itype==i.id_InteractionType_ANY?(Fa.COLLISIONstate=x.immState,Fa.SENSORstate=
x.immState,Fa.FLUIDstate=x.immState):Fa.SENSORstate=x.immState,pb=pb.next}else null==Fa?0==(x.immState&i.id_ImmState_ALWAYS)&&(x.immState=i.id_ImmState_ACCEPT):x.immState=Fa.SENSORstate}Wa=Wa.next}Qa=Qa.next}if(Ua&&0==(x.immState&i.id_ImmState_ALWAYS)){if(x.b1.type!=i.id_BodyType_STATIC){var Aa=x.b1;Aa.world||(Aa.component.waket=this.stamp+(this.midstep?0:1),Aa.type==i.id_BodyType_KINEMATIC&&(Aa.kinematicDelaySleep=!0),Aa.component.sleeping&&this.really_wake(Aa,!1))}if(x.b2.type!=i.id_BodyType_STATIC){var jb=
x.b2;jb.world||(jb.component.waket=this.stamp+(this.midstep?0:1),jb.type==i.id_BodyType_KINEMATIC&&(jb.kinematicDelaySleep=!0),jb.component.sleeping&&this.really_wake(jb,!1))}}}x.sleeping&&(x.sleeping=!1,this.s_arbiters.inlined_add(x));g=x}else if(Ha){var vb=x;vb.next=Ya.zpp_pool;Ya.zpp_pool=vb;g=null}else g=x;else g=x}}return g},MRCA_chains:function(a,b){this.inlined_MRCA_chains(a,b)},inlined_MRCA_chains:function(a,b){this.mrca1.inlined_clear();this.mrca2.inlined_clear();null!=a.cbSet&&this.mrca1.inlined_add(a);
null!=a.body.cbSet&&this.mrca1.inlined_add(a.body);null!=b.cbSet&&this.mrca2.inlined_add(b);null!=b.body.cbSet&&this.mrca2.inlined_add(b.body);for(var c=a.body.compound,d=b.body.compound;c!=d;)(null==c?0:c.depth)<(null==d?0:d.depth)?(null!=d.cbSet&&this.mrca2.inlined_add(d),d=d.compound):(null!=c.cbSet&&this.mrca1.inlined_add(c),c=c.compound)},__class__:Hf};var ic=function(){this.next=this.prev=this.shape=this.aabb=null};ic.__name__=!0;ic.prototype={__class__:ic};var Fe=function(a){this.list=null;
xc.call(this);this.space=a;this.is_sweep=!0;this.sweep=this};Fe.__name__=!0;Fe.__super__=xc;Fe.prototype=r(xc.prototype,{__insert:function(a){var b;null==ic.zpp_pool?b=new ic:(b=ic.zpp_pool,ic.zpp_pool=b.next,b.next=null);null;a.sweep=b;b.shape=a;b.aabb=a.aabb;b.next=this.list;null!=this.list&&(this.list.prev=b);this.list=b},__remove:function(a){var b=a.sweep;null==b.prev?this.list=b.next:b.prev.next=b.next;null!=b.next&&(b.next.prev=b.prev);a.sweep=null;b.prev=null;b.shape=null;b.aabb=null;b.next=
ic.zpp_pool;ic.zpp_pool=b},sync_broadphase_fast:function(){for(var a=this.list.next;null!=a;){var b=a.next,c=a.prev;if(!(a.aabb.minx>c.aabb.minx)){for(;null!=c.prev&&c.prev.aabb.minx>a.aabb.minx;)c=c.prev;var d=a.prev;d.next=a.next;null!=a.next&&(a.next.prev=d);null==c.prev?(a.prev=null,this.list=a,a.next=c,c.prev=a):(a.prev=c.prev,c.prev=a,a.prev.next=a,a.next=c)}a=b}},broadphase:function(a,b){if(null!=this.list){this.sync_broadphase_fast();for(var c=this.list;null!=c;){for(var d=c.next,e=c.shape,
f=e.body,g=c.aabb.maxx;null!=d&&!(d.aabb.minx>g);){var j=d.shape,l=j.body;if(l!=f&&!(f.type==i.id_BodyType_STATIC&&l.type==i.id_BodyType_STATIC)&&(!f.component.sleeping||!l.component.sleeping))e.aabb.intersectY(j.aabb)&&(b?a.narrowPhase(e,j,f.type!=i.id_BodyType_DYNAMIC||l.type!=i.id_BodyType_DYNAMIC,null,!1):a.continuousEvent(e,j,f.type!=i.id_BodyType_DYNAMIC||l.type!=i.id_BodyType_DYNAMIC,null,!1));d=d.next}c=c.next}}},__class__:Fe});var Of=function(){this.length=0;this.modified=this.pushmod=!1;
this.head=null};Of.__name__=!0;Of.prototype={inlined_add:function(a){var b;null==jc.zpp_pool?b=new jc:(b=jc.zpp_pool,jc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,
a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=jc.zpp_pool;jc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Of};var Mc=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Mc.__name__=!0;Mc.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==fb.zpp_pool?b=new fb:(b=fb.zpp_pool,fb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,
b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==fb.zpp_pool?c=new fb:(c=fb.zpp_pool,fb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==
a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=fb.zpp_pool;fb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Mc};var yc=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};yc.__name__=!0;yc.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;
null==Ma.zpp_pool?b=new Ma:(b=Ma.zpp_pool,Ma.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Ma.zpp_pool?c=new Ma:(c=Ma.zpp_pool,Ma.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=
this.head;this.head=a.next;a.elt=null;a.next=Ma.zpp_pool;Ma.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=
!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Ma.zpp_pool;Ma.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:yc};var Ge=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Ge.__name__=!0;Ge.prototype={remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);
d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Je.zpp_pool;Je.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Ge};var Pd=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Pd.__name__=!0;Pd.prototype=
{inlined_add:function(a){var b;null==$b.zpp_pool?b=new $b:(b=$b.zpp_pool,$b.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=$b.zpp_pool;$b.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();
return a},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=$b.zpp_pool;$b.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},inlined_has:function(a){var b;
b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},__class__:Pd};var If=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};If.__name__=!0;If.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==kc.zpp_pool?b=new kc:(b=kc.zpp_pool,kc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;
this.head=a.next;a.elt=null;a.next=kc.zpp_pool;kc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=
c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=kc.zpp_pool;kc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:If};var Pc=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Pc.__name__=!0;Pc.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==$a.zpp_pool?b=new $a:(b=$a.zpp_pool,$a.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;
this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==$a.zpp_pool?c=new $a:(c=$a.zpp_pool,$a.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=$a.zpp_pool;$a.zpp_pool=a;null==this.head&&(this.pushmod=
!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=
!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=$a.zpp_pool;$a.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},__class__:Pc};var je=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};je.__name__=!0;je.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Mb.zpp_pool?
b=new Mb:(b=Mb.zpp_pool,Mb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Mb.zpp_pool;Mb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},erase:function(a){return this.inlined_erase(a)},
inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Mb.zpp_pool;Mb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:je};var ve=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};ve.__name__=!0;ve.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==lc.zpp_pool?b=new lc:(b=lc.zpp_pool,
lc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=lc.zpp_pool;lc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},__class__:ve};var Nf=function(){this.length=0;this.modified=
this.pushmod=!1;this.head=null};Nf.__name__=!0;Nf.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==mc.zpp_pool?b=new mc:(b=mc.zpp_pool,mc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=mc.zpp_pool;mc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},
inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},__class__:Nf};var Qf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Qf.__name__=!0;Qf.prototype={inlined_add:function(a){var b;null==Na.zpp_pool?b=new Na:(b=Na.zpp_pool,Na.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Na.zpp_pool;Na.zpp_pool=
a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,
c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Na.zpp_pool;Na.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Qf};var Sf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Sf.__name__=!0;Sf.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Ra.zpp_pool?b=new Ra:(b=Ra.zpp_pool,Ra.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},
insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Ra.zpp_pool?c=new Ra:(c=Ra.zpp_pool,Ra.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Ra.zpp_pool;Ra.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},
inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Ra.zpp_pool;Ra.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=
!0},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Sf};var Tf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Tf.__name__=!0;Tf.prototype={inlined_add:function(a){var b;null==Nb.zpp_pool?b=new Nb:(b=Nb.zpp_pool,Nb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Nb.zpp_pool;
Nb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},__class__:Tf};var Wf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Wf.__name__=!0;Wf.prototype={inlined_add:function(a){var b;null==ac.zpp_pool?b=new ac:(b=ac.zpp_pool,ac.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;
return a},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=ac.zpp_pool;ac.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Wf};var Xf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Xf.__name__=!0;Xf.prototype={inlined_add:function(a){var b;null==qb.zpp_pool?b=new qb:(b=qb.zpp_pool,qb.zpp_pool=b.next,b.next=null);
null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=qb.zpp_pool;qb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Xf};var He=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};He.__name__=!0;He.prototype={add:function(a){return this.inlined_add(a)},
inlined_add:function(a){var b;null==zc.zpp_pool?b=new zc:(b=zc.zpp_pool,zc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,
a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=zc.zpp_pool;zc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:He};var Ie=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Ie.__name__=!0;Ie.prototype={remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,
this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Ke.zpp_pool;Ke.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Ie};var Vf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Vf.__name__=!0;Vf.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Ca.zpp_pool?
b=new Ca:(b=Ca.zpp_pool,Ca.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Ca.zpp_pool;Ca.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},erase:function(a){return this.inlined_erase(a)},
inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Ca.zpp_pool;Ca.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Vf};var Yf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Yf.__name__=!0;Yf.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Ob.zpp_pool?b=new Ob:(b=Ob.zpp_pool,
Ob.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Ob.zpp_pool?c=new Ob:(c=Ob.zpp_pool,Ob.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Yf};
var Z=function(){this.next=this.elt=null};Z.__name__=!0;Z.prototype={__class__:Z};var jc=function(){this.next=this.elt=null};jc.__name__=!0;jc.prototype={__class__:jc};var fb=function(){this.next=this.elt=null};fb.__name__=!0;fb.prototype={__class__:fb};var Ma=function(){this.next=this.elt=null};Ma.__name__=!0;Ma.prototype={__class__:Ma};var ec=function(){this.next=this.elt=null};ec.__name__=!0;ec.prototype={__class__:ec};var Je=function(){this.next=this.elt=null};Je.__name__=!0;Je.prototype={__class__:Je};
var qa=function(){this.next=this.elt=null};qa.__name__=!0;qa.prototype={__class__:qa};var Wb=function(){this.next=this.elt=null};Wb.__name__=!0;Wb.prototype={__class__:Wb};var fc=function(){this.next=this.elt=null};fc.__name__=!0;fc.prototype={__class__:fc};var Xa=function(){this.next=this.elt=null};Xa.__name__=!0;Xa.prototype={__class__:Xa};var $b=function(){this.next=this.elt=null};$b.__name__=!0;$b.prototype={__class__:$b};var Ib=function(){this.next=this.elt=null};Ib.__name__=!0;Ib.prototype=
{__class__:Ib};var kc=function(){this.next=this.elt=null};kc.__name__=!0;kc.prototype={__class__:kc};var $a=function(){this.next=this.elt=null};$a.__name__=!0;$a.prototype={__class__:$a};var Mb=function(){this.next=this.elt=null};Mb.__name__=!0;Mb.prototype={__class__:Mb};var lc=function(){this.next=this.elt=null};lc.__name__=!0;lc.prototype={__class__:lc};var mc=function(){this.next=this.elt=null};mc.__name__=!0;mc.prototype={__class__:mc};var Na=function(){this.next=this.elt=null};Na.__name__=!0;
Na.prototype={__class__:Na};var Ra=function(){this.next=this.elt=null};Ra.__name__=!0;Ra.prototype={__class__:Ra};var Za=function(){this.next=this.elt=null};Za.__name__=!0;Za.prototype={__class__:Za};var Nb=function(){this.next=this.elt=null};Nb.__name__=!0;Nb.prototype={__class__:Nb};var ac=function(){this.next=this.elt=null};ac.__name__=!0;ac.prototype={__class__:ac};var qb=function(){this.next=this.elt=null};qb.__name__=!0;qb.prototype={__class__:qb};var zc=function(){this.next=this.elt=null};
zc.__name__=!0;zc.prototype={__class__:zc};var Ke=function(){this.next=this.elt=null};Ke.__name__=!0;Ke.prototype={__class__:Ke};var Ca=function(){this.next=this.elt=null};Ca.__name__=!0;Ca.prototype={__class__:Ca};var Ob=function(){this.next=this.elt=null};Ob.__name__=!0;Ob.prototype={__class__:Ob};var Qc=function(){this.at_index=0;this.at_ite=null;this.zip_length=!1;this._length=0;this.inner=null;Wa.call(this);this.at_ite=null;this.at_index=0;this.zip_length=!0;this._length=0};Qc.__name__=!0;Qc.get=
function(a,b){null==b&&(b=!1);var c=new Qc;c.inner=a;c.zpp_inner.immutable=b;return c};Qc.__super__=Wa;Qc.prototype=r(Wa.prototype,{zpp_gl:function(){this.zpp_vm();if(this.zip_length){this._length=0;for(var a=this.inner.next;null!=a;)this._length++,a=a.next;this.zip_length=!1}return this._length},zpp_vm:function(){this.zpp_inner.validate();this.inner.modified&&(this.zip_length=!0,this._length=0,this.at_ite=null)},at:function(a){this.zpp_vm();if(0>a||a>=this.zpp_gl())throw new j("Error: Index out of bounds");
this.zpp_inner.reverse_flag&&(a=this.zpp_gl()-1-a);if(a<this.at_index||null==this.at_ite){this.at_index=0;for(this.at_ite=this.inner.next;;)break}for(;this.at_index!=a;){this.at_index++;for(this.at_ite=this.at_ite.next;;)break}return this.at_ite.wrapper()},push:function(a){if(this.zpp_inner.immutable)throw new j("Error: Vec2List is immutable");this.zpp_inner.modify_test();this.zpp_vm();if(a.zpp_inner._inuse)throw new j("Error: Vec2 is already in use");var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):
!0)this.zpp_inner.reverse_flag?this.inner.add(a.zpp_inner):this.inner.insert(this.inner.iterator_at(this.zpp_gl()-1),a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},__class__:Qc});var dc=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=
this.inner=null;this.inner=new Ic;this._invalidated=!0};dc.__name__=!0;dc.get=function(a,b){null==b&&(b=!1);var c=new uf;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};dc.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&
(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:dc};var pb=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new yc;this._invalidated=!0};
pb.__name__=!0;pb.get=function(a,b){null==b&&(b=!1);var c=new Af;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};pb.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},
invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:pb};var Vb=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Ge;this._invalidated=!0};Vb.__name__=!0;Vb.get=function(a,b){null==b&&(b=!1);var c=new Cf;c.zpp_inner.inner=
a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};Vb.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},
__class__:Vb};var Sb=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Ie;this._invalidated=!0};Sb.__name__=!0;Sb.get=function(a,b){null==b&&(b=!1);var c=new sf;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};Sb.prototype={valmod:function(){this.validate();
this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:Sb};var sc=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=
null;this.at_index=0;this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new wc;this._invalidated=!0};sc.__name__=!0;sc.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){null!=this._modifiable&&this._modifiable()},
validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:sc};var bd=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Yf;this._invalidated=
!0};bd.__name__=!0;bd.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:bd};var tc=function(){this.user_length=
0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Mc;this._invalidated=!0};tc.__name__=!0;tc.get=function(a,b){null==b&&(b=!1);var c=new Gf;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};tc.prototype={valmod:function(){this.validate();this.inner.modified&&
(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:tc};var Ub=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;
this.reverse_flag=!1;this._validate=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Pd;this._invalidated=!0};Ub.__name__=!0;Ub.get=function(a,b){null==b&&(b=!1);var c=new vf;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};Ub.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&
(this._invalidated=!1,null!=this._validate&&this._validate())},__class__:Ub};var Lc=function(){};Lc.__name__=!0;Lc.sqr=function(a){return a*a};var oa=function(){};oa.__name__=!0;var ba=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=this.next=this.parent=null};ba.__name__=!0;ba.prototype={clear_with:function(a){if(null!=this.parent){for(var b=this.parent;null!=b;)b=null!=b.prev?b.prev:null!=b.next?b.next:this.clear_node(b,a);this.parent=null}},clear_node:function(a,b){b(a.data);
var c=a.parent;null!=c&&(a==c.prev?c.prev=null:c.next=null,a.parent=null);a.data=null;a.lt=null;a.swapped=null;a.next=ba.zpp_pool;ba.zpp_pool=a;return c},__fix_dbl_red:function(a){for(;;){var b=a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,i,j,k;b==c.prev?(f=c,k=c.next,a==b.prev?(d=a,e=b,g=a.prev,i=a.next,j=b.next):(d=b,e=a,g=b.prev,i=a.prev,j=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,i=a.prev,j=a.next,k=b.next):(e=b,f=a,i=b.prev,j=a.prev,k=a.next));a=c.parent;null==a?this.parent=e:
a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=i;null!=i&&(i.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=f&&(f.parent=e);f.prev=j;null!=j&&(j.parent=f);f.next=k;null!=k&&(k.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},try_insert:function(a){var b=null,c=null;if(null==this.parent)null==ba.zpp_pool?b=new ba:(b=ba.zpp_pool,ba.zpp_pool=b.next,
b.next=null),null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==ba.zpp_pool?b=new ba:(b=ba.zpp_pool,ba.zpp_pool=b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==ba.zpp_pool?b=new ba:(b=ba.zpp_pool,ba.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return c;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));
return b},__class__:ba};var L=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=this.next=this.parent=null};L.__name__=!0;L.prototype={empty:function(){return null==this.parent},remove_node:function(a){if(null!=a.next&&null!=a.prev){for(var b=a.next;null!=b.prev;)b=b.prev;var c=a.data;a.data=b.data;b.data=c;null!=this.swapped&&this.swapped(a.data,b.data);a=b}b=null==a.prev?a.next:a.prev;if(1==a.colour)if(null!=a.prev||null!=a.next)b.colour=1;else if(null!=a.parent)for(c=a.parent;;){c.colour++;
c.prev.colour--;c.next.colour--;var d=c.prev;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}d=c.next;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}if(2==c.colour)if(null==c.parent)c.colour=
1;else{c=c.parent;continue}break}c=a.parent;null==c?this.parent=b:c.prev==a?c.prev=b:c.next=b;null!=b&&(b.parent=c);a.parent=a.prev=a.next=null;a.data=null;a.lt=null;a.swapped=null;a.next=L.zpp_pool;L.zpp_pool=a},__fix_neg_red:function(a){var b=a.parent;if(b.prev==a){var c=a.prev,d=a.next,e=d.prev,f=d.next;c.colour=0;a.colour=b.colour=1;a.next=e;null!=e&&(e.parent=a);a=b.data;b.data=d.data;d.data=a;null!=this.swapped&&this.swapped(b.data,d.data);d.prev=f;null!=f&&(f.parent=d);d.next=b.next;null!=
b.next&&(b.next.parent=d);b.next=d}else c=a.next,d=a.prev,e=d.next,f=d.prev,c.colour=0,a.colour=b.colour=1,a.prev=e,null!=e&&(e.parent=a),a=b.data,b.data=d.data,d.data=a,null!=this.swapped&&this.swapped(b.data,d.data),d.next=f,null!=f&&(f.parent=d),d.prev=b.prev,null!=b.prev&&(b.prev.parent=d),b.prev=d;null!=d&&(d.parent=b);b=c;null!=b.prev&&0==b.prev.colour?this.__fix_dbl_red(b.prev):null!=b.next&&0==b.next.colour&&this.__fix_dbl_red(b.next)},__fix_dbl_red:function(a){for(;;){var b=a.parent,c=b.parent;
if(null==c){b.colour=1;break}var d,e,f,g,i,j,k;b==c.prev?(f=c,k=c.next,a==b.prev?(d=a,e=b,g=a.prev,i=a.next,j=b.next):(d=b,e=a,g=b.prev,i=a.prev,j=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,i=a.prev,j=a.next,k=b.next):(e=b,f=a,i=b.prev,j=a.prev,k=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=i;null!=i&&(i.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=f&&(f.parent=e);f.prev=j;null!=j&&(j.parent=f);f.next=k;
null!=k&&(k.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},insert:function(a){var b;null==L.zpp_pool?b=new L:(b=L.zpp_pool,L.zpp_pool=b.next,b.next=null);null;b.data=a;if(null==this.parent)this.parent=b;else for(a=this.parent;;)if(this.lt(b.data,a.data))if(null==a.prev){a.prev=b;b.parent=a;break}else a=a.prev;else if(null==a.next){a.next=b;b.parent=a;break}else a=a.next;null==b.parent?b.colour=
1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:L};var Kb=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=this.next=this.parent=null};Kb.__name__=!0;Kb.prototype={remove_node:function(a){if(null!=a.next&&null!=a.prev){for(var b=a.next;null!=b.prev;)b=b.prev;var c=a.data;a.data=b.data;b.data=c;null!=this.swapped&&this.swapped(a.data,b.data);a=b}b=null==a.prev?a.next:a.prev;if(1==a.colour)if(null!=a.prev||null!=a.next)b.colour=1;else if(null!=a.parent)for(c=
a.parent;;){c.colour++;c.prev.colour--;c.next.colour--;var d=c.prev;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}d=c.next;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}if(2==c.colour)if(null==
c.parent)c.colour=1;else{c=c.parent;continue}break}c=a.parent;null==c?this.parent=b:c.prev==a?c.prev=b:c.next=b;null!=b&&(b.parent=c);a.parent=a.prev=a.next=null;a.data=null;a.lt=null;a.swapped=null;a.next=Kb.zpp_pool;Kb.zpp_pool=a},__fix_neg_red:function(a){var b=a.parent;if(b.prev==a){var c=a.prev,d=a.next,e=d.prev,f=d.next;c.colour=0;a.colour=b.colour=1;a.next=e;null!=e&&(e.parent=a);a=b.data;b.data=d.data;d.data=a;null!=this.swapped&&this.swapped(b.data,d.data);d.prev=f;null!=f&&(f.parent=d);
d.next=b.next;null!=b.next&&(b.next.parent=d);b.next=d}else c=a.next,d=a.prev,e=d.next,f=d.prev,c.colour=0,a.colour=b.colour=1,a.prev=e,null!=e&&(e.parent=a),a=b.data,b.data=d.data,d.data=a,null!=this.swapped&&this.swapped(b.data,d.data),d.next=f,null!=f&&(f.parent=d),d.prev=b.prev,null!=b.prev&&(b.prev.parent=d),b.prev=d;null!=d&&(d.parent=b);b=c;null!=b.prev&&0==b.prev.colour?this.__fix_dbl_red(b.prev):null!=b.next&&0==b.next.colour&&this.__fix_dbl_red(b.next)},__fix_dbl_red:function(a){for(;;){var b=
a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,i,j,k;b==c.prev?(f=c,k=c.next,a==b.prev?(d=a,e=b,g=a.prev,i=a.next,j=b.next):(d=b,e=a,g=b.prev,i=a.prev,j=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,i=a.prev,j=a.next,k=b.next):(e=b,f=a,i=b.prev,j=a.prev,k=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=i;null!=i&&(i.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=f&&(f.parent=e);f.prev=j;null!=j&&(j.parent=
f);f.next=k;null!=k&&(k.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},insert:function(a){var b;null==Kb.zpp_pool?b=new Kb:(b=Kb.zpp_pool,Kb.zpp_pool=b.next,b.next=null);null;b.data=a;if(null==this.parent)this.parent=b;else for(a=this.parent;;)if(this.lt(b.data,a.data))if(null==a.prev){a.prev=b;b.parent=a;break}else a=a.prev;else if(null==a.next){a.next=b;b.parent=a;break}else a=a.next;null==
b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:Kb};var Lb=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=this.next=this.parent=null};Lb.__name__=!0;Lb.prototype={empty:function(){return null==this.parent},find:function(a){for(var b=this.parent;null!=b&&b.data!=a;)b=this.lt(a,b.data)?b.prev:b.next;return b},find_weak:function(a){for(var b=this.parent;null!=b;)if(this.lt(a,b.data))b=b.prev;else if(this.lt(b.data,a))b=b.next;else break;
return b},remove:function(a){this.remove_node(this.find(a))},remove_node:function(a){if(null!=a.next&&null!=a.prev){for(var b=a.next;null!=b.prev;)b=b.prev;var c=a.data;a.data=b.data;b.data=c;null!=this.swapped&&this.swapped(a.data,b.data);a=b}b=null==a.prev?a.next:a.prev;if(1==a.colour)if(null!=a.prev||null!=a.next)b.colour=1;else if(null!=a.parent)for(c=a.parent;;){c.colour++;c.prev.colour--;c.next.colour--;var d=c.prev;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=
d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}d=c.next;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}if(2==c.colour)if(null==c.parent)c.colour=1;else{c=c.parent;continue}break}c=a.parent;null==c?this.parent=b:c.prev==a?c.prev=b:c.next=b;null!=b&&(b.parent=c);a.parent=
a.prev=a.next=null;a.data=null;a.lt=null;a.swapped=null;a.next=Lb.zpp_pool;Lb.zpp_pool=a},__fix_neg_red:function(a){var b=a.parent;if(b.prev==a){var c=a.prev,d=a.next,e=d.prev,f=d.next;c.colour=0;a.colour=b.colour=1;a.next=e;null!=e&&(e.parent=a);a=b.data;b.data=d.data;d.data=a;null!=this.swapped&&this.swapped(b.data,d.data);d.prev=f;null!=f&&(f.parent=d);d.next=b.next;null!=b.next&&(b.next.parent=d);b.next=d}else c=a.next,d=a.prev,e=d.next,f=d.prev,c.colour=0,a.colour=b.colour=1,a.prev=e,null!=e&&
(e.parent=a),a=b.data,b.data=d.data,d.data=a,null!=this.swapped&&this.swapped(b.data,d.data),d.next=f,null!=f&&(f.parent=d),d.prev=b.prev,null!=b.prev&&(b.prev.parent=d),b.prev=d;null!=d&&(d.parent=b);b=c;null!=b.prev&&0==b.prev.colour?this.__fix_dbl_red(b.prev):null!=b.next&&0==b.next.colour&&this.__fix_dbl_red(b.next)},__fix_dbl_red:function(a){for(;;){var b=a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,i,j,k;b==c.prev?(f=c,k=c.next,a==b.prev?(d=a,e=b,g=a.prev,i=a.next,j=b.next):
(d=b,e=a,g=b.prev,i=a.prev,j=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,i=a.prev,j=a.next,k=b.next):(e=b,f=a,i=b.prev,j=a.prev,k=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=i;null!=i&&(i.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=f&&(f.parent=e);f.prev=j;null!=j&&(j.parent=f);f.next=k;null!=k&&(k.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&
0==e.parent.colour){a=e;continue}break}},insert:function(a){var b;null==Lb.zpp_pool?b=new Lb:(b=Lb.zpp_pool,Lb.zpp_pool=b.next,b.next=null);null;b.data=a;if(null==this.parent)this.parent=b;else for(a=this.parent;;)if(this.lt(b.data,a.data))if(null==a.prev){a.prev=b;b.parent=a;break}else a=a.prev;else if(null==a.next){a.next=b;b.parent=a;break}else a=a.next;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:Lb};var uc,pg=0;String.prototype.__class__=
String;String.__name__=!0;Array.__name__=!0;Date.prototype.__class__=Date;Date.__name__=["Date"];var qg={__name__:["Int"]},rg={__name__:["Dynamic"]},kg=Number;kg.__name__=["Float"];var lg=Boolean;lg.__ename__=["Bool"];var sg={__name__:["Class"]},tg={},jg={},fg=Function("return typeof ArrayBuffer != 'undefined' ? ArrayBuffer : null")()||cb;null==fg.prototype.slice&&(fg.prototype.slice=cb.sliceImpl);var hf=Function("return typeof Uint8Array != 'undefined' ? Uint8Array : null")()||pc._new;Ec.instance=
new Ec;U.DISPATCHING_SENTINEL=new Tc(null,null);J.root=new ob;J.uncaughtError=new Q;J.hidden=new Ia(!1);J.volume=new ia(1);J._platform=Ec.instance;J._calledInit=!1;Da.__meta__={obj:{assets:[{bootstrap:[{bytes:78591,md5:"755a5d5fa47f87fc4c9b4068b10c693b",name:"background/atlas0.png"},{bytes:1804,md5:"e2ce40b6ccaec506adfea8f5cee56d75",name:"background/library.json"},{bytes:18784,md5:"e4b8ce148e8f97e2fd6d91c370ae2b3c",name:"bound.png"},{bytes:47756,md5:"c3cfb44f28644d3b4f4b33f4c15da5bf",name:"labelTitle.png"},
{bytes:95,md5:"67109a8f68f8f6ba8cd01b9f85db3a21",name:"particleMonster/atlas0.png"},{bytes:5753,md5:"57bafffba7e0d889936172ad1a9df0e5",name:"particleMonster/library.json"},{bytes:17897,md5:"59410f20c73e663faf5bcb4f17919870",name:"player.png"},{bytes:18474,md5:"8824113cbf9dd9e23688b0a2d2d62954",name:"square.png"}]}]}};Da._supportsCrossOrigin=function(){var a;a=0<=window.navigator.userAgent.indexOf("Linux; U; Android")?!1:null!=(new XMLHttpRequest).withCredentials;a||null;return a}();B._scratchPoint=
new Re;bb._sharedEvent=new Ue;xa._sharedEvent=new Ve;Sa._sharedEvent=new We;Sc.CANVAS_TEXTURES=(new Ac("(iPhone|iPod|iPad)","")).match(window.navigator.userAgent);I._mediaRefCount=0;I._detectBlobSupport=!0;C.VENDOR_PREFIXES=["webkit","moz","ms","o","khtml"];C.SHOULD_HIDE_MOBILE_BROWSER=window.top==window&&(new Ac("Mobile(/.*)? Safari","")).match(window.navigator.userAgent);S._detectSupport=!0;gb._scratchMatrix=new va;u.__toStr={}.toString;pc.BYTES_PER_ELEMENT=1;k.epsilon=1.0E-8;k.fluidAngularDragFriction=
2.5;k.fluidAngularDrag=100;k.fluidVacuumDrag=0.5;k.fluidLinearDrag=0.5;k.collisionSlop=0.2;k.collisionSlopCCD=0.5;k.distanceThresholdCCD=0.05;k.staticCCDLinearThreshold=0.05;k.staticCCDAngularThreshold=0.005;k.bulletCCDLinearThreshold=0.125;k.bulletCCDAngularThreshold=0.0125;k.dynamicSweepLinearThreshold=17;k.dynamicSweepAngularThreshold=0.6;k.angularCCDSlipScale=0.75;k.arbiterExpirationDelay=6;k.staticFrictionThreshold=2;k.elasticThreshold=20;k.sleepDelay=60;k.linearSleepThreshold=0.2;k.angularSleepThreshold=
0.4;k.contactBiasCoef=0.3;k.contactStaticBiasCoef=0.6;k.contactContinuousBiasCoef=0.4;k.contactContinuousStaticBiasCoef=0.5;k.illConditionedThreshold=2E8;Ka.zpp_internalAlloc=!1;Fb.zpp_internalAlloc=!1;db._Interactor=0;db._CbType=0;db._CbSet=0;N.internal=!1;ya.ANY_SHAPE=new Gc;ya.ANY_BODY=new Gc;ya.ANY_COMPOUND=new Gc;ya.ANY_CONSTRAINT=new Gc;i.internal=!1;i.id_ImmState_ACCEPT=1;i.id_ImmState_IGNORE=2;i.id_ImmState_ALWAYS=4;i.id_GravMassMode_DEFAULT=0;i.id_GravMassMode_FIXED=1;i.id_GravMassMode_SCALED=
2;i.id_InertiaMode_DEFAULT=0;i.id_MassMode_DEFAULT=0;i.id_BodyType_STATIC=1;i.id_BodyType_DYNAMIC=2;i.id_BodyType_KINEMATIC=3;i.id_ListenerType_BODY=0;i.id_ListenerType_CONSTRAINT=1;i.id_PreFlag_ACCEPT=1;i.id_ListenerType_INTERACTION=2;i.id_ListenerType_PRE=3;i.id_CbEvent_BEGIN=0;i.id_CbEvent_ONGOING=6;i.id_InteractionType_COLLISION=1;i.id_CbEvent_END=1;i.id_InteractionType_SENSOR=2;i.id_CbEvent_WAKE=2;i.id_InteractionType_FLUID=4;i.id_CbEvent_SLEEP=3;i.id_InteractionType_ANY=7;i.id_CbEvent_BREAK=
4;i.id_CbEvent_PRE=5;i.id_ShapeType_CIRCLE=0;i.id_ShapeType_POLYGON=1;ga.UCbSet=new Kc;ga.VCbSet=new Kc;ga.WCbSet=new Kc;ga.UCbType=new vc;ga.VCbType=new vc;ga.WCbType=new vc;D.internal=!1;D.COL=1;D.FLUID=4;D.SENSOR=2;Y.internal=!1;s.flowpoly=new wc;s.flowsegs=new wc;y.nextId=0;var ng;null==i.BodyType_STATIC&&(i.internal=!0,i.BodyType_STATIC=new ab,i.internal=!1);ng=i.BodyType_STATIC;var og;null==i.BodyType_DYNAMIC&&(i.internal=!0,i.BodyType_DYNAMIC=new ab,i.internal=!1);og=i.BodyType_DYNAMIC;null==
i.BodyType_KINEMATIC&&(i.internal=!0,i.BodyType_KINEMATIC=new ab,i.internal=!1);rb.types=[null,ng,og,i.BodyType_KINEMATIC];M.WAKE=1;M.PROPS=2;M.ANGDRAG=4;M.ARBITERS=8;R.internal=!1;ib.tmpaabb=new ra;dc.internal=!1;pb.internal=!1;Vb.internal=!1;Sb.internal=!1;sc.internal=!1;bd.internal=!1;tc.internal=!1;Ub.internal=!1;Ae.main()})();
